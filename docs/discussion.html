<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Remote Sensing of Foliar Nitrogen in Californian Almonds - 8&nbsp; Discussion</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./conclusion.html" rel="next">
<link href="./results-of-the-model-performances.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a href="https://damianoswald.com/index.html" class="navbar-brand navbar-brand-logo">
    <img src="./resources/iconDO.png" alt="" class="navbar-logo">
    </a>
  </div>
        <div class="quarto-navbar-tools ms-auto tools-wide">
    <a href="https://github.com/damian-oswald/master-thesis/" rel="" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
    <a href="./Remote-Sensing-of-Foliar-Nitrogen-in-Californian-Almonds.pdf" rel="" title="Download PDF" class="quarto-navigation-tool px-1" aria-label="Download PDF"><i class="bi bi-file-pdf"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
          <div id="quarto-search" class="" title="Search"></div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./discussion.html"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Discussion</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./background.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Background</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./vegetation-indices-based-methods.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Vegetation-indices-based methods</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./machine-learning-methods-for-hyperspectral-data-analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Machine learning methods for hyperspectral data analysis</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./radiative-transfer-models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Radiative transfer models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./describing-processing-and-inspecting-the-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Describing, processing and inspecting the data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./technical-description-of-the-modelling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Technical description of the modelling</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./results-of-the-model-performances.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Results of the model performances</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./discussion.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Discussion</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./conclusion.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Conclusion</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./appendix.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Appendix</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#different-modelling-approaches" id="toc-different-modelling-approaches" class="nav-link active" data-scroll-target="#different-modelling-approaches"><span class="header-section-number">8.1</span> Different modelling approaches</a></li>
  <li><a href="#how-radiative-transfer-models-might-be-improved" id="toc-how-radiative-transfer-models-might-be-improved" class="nav-link" data-scroll-target="#how-radiative-transfer-models-might-be-improved"><span class="header-section-number">8.2</span> How radiative transfer models might be improved</a></li>
  <li><a href="#general-possibilities-for-improvement" id="toc-general-possibilities-for-improvement" class="nav-link" data-scroll-target="#general-possibilities-for-improvement"><span class="header-section-number">8.3</span> General possibilities for improvement</a></li>
  <li><a href="#addressing-the-quality-and-properties-of-the-data" id="toc-addressing-the-quality-and-properties-of-the-data" class="nav-link" data-scroll-target="#addressing-the-quality-and-properties-of-the-data"><span class="header-section-number">8.4</span> Addressing the quality and properties of the data</a></li>
  <li><a href="#range-of-the-nitrogen-measurements" id="toc-range-of-the-nitrogen-measurements" class="nav-link" data-scroll-target="#range-of-the-nitrogen-measurements"><span class="header-section-number">8.5</span> Range of the nitrogen measurements</a></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/damian-oswald/master-thesis/blob/main/discussion.qmd" class="toc-action">View source</a></p><p><a href="https://github.com/damian-oswald/master-thesis/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="sec-discussion" class="quarto-section-identifier"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Discussion</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>In this chapter, I will examine the results of this thesis in a broader context, addressing both the advantages and disadvantages of the various modelling approaches. Additionally, potential improvements will be explored, with a particular emphasis on radiative transfer models, but also aspects from which other methods could profit. Finally, certain peculiarities of the dataset, specifically nitrogen measurements, will be discussed and compared to similar research in the scientific literature.</p>
<section id="different-modelling-approaches" class="level2" data-number="8.1">
<h2 data-number="8.1" class="anchored" data-anchor-id="different-modelling-approaches"><span class="header-section-number">8.1</span> Different modelling approaches</h2>
<p>In this thesis, I compared various approaches to modelling foliar nitrogen concentration in Californian almonds, including vegetation indices and other hand-crafted features, diverse machine learning algorithms, and physics-based radiative transfer models. This model intercomparison highlighted the remarkable capability of machine learning models to identify patterns in the data and generate impressive predictions compared to other methods. Linear models, in particular, performed exceptionally well when combined with linear dimensionality reduction, regularization, or prior feature selection. The underwhelming performance of decision-tree-based models, capable of capturing non-linear relationships, likely stems from the absence of strong non-linear relationships in the data, combined with a low signal-to-noise ratio — a situation where decision-tree-based models easily overfit the data.</p>
<p>However, these data characteristics are highly dependent on the specific dataset, such as the collection time, nitrogen measurement range, and almond cultivar. As a result, the performance of machine learning algorithms can be highly inconsistent. One dataset may favour lasso regularization, while another may be better suited for partial least squares or extreme gradient boosting. This issue underscores the primary challenge of machine learning models in this context: the lack of generalizability. A model trained in one setting often loses predictive power in another <span class="citation" data-cites="verrelst2019quantifying">(<a href="references.html#ref-verrelst2019quantifying" role="doc-biblioref">Verrelst et al. 2019</a>)</span>. Ideally, the training dataset should encompass all necessary variance, and the test set should reflect real-world deviations. However, acquiring such a dataset for agricultural practice would be extremely difficult.</p>
<p>In contrast, physics-based models promise to address this generalizability problem <span class="citation" data-cites="verrelst2019quantifying berger2020crop">(<a href="references.html#ref-verrelst2019quantifying" role="doc-biblioref">Verrelst et al. 2019</a>, <a href="references.html#ref-berger2020crop" role="doc-biblioref">Berger et al. 2020</a>)</span>. Identifying the correct functional form of a relationship enables models to reflect non-linear relationships without the need of giving the model more general flexibility. In this thesis, retrieved plant parameters, such as chlorophyll or carotenoid content, were linked to measured nitrogen concentrations. This connection only necessitates a handful of coefficients, contributing to the generalizability of physics-based models.</p>
<p>The radiative transfer model <span class="smallcaps">Prospect-Pro</span> can be viewed as a dimensionality reduction technique not completely unlike principal component analysis. However, compared to principal components, the latent variables identified by <span class="smallcaps">Prospect-Pro</span> have a physical meaning, mostly relating to the content of specific plant pigments responsible for observed reflectance (and transmittance). As a dimensionality reduction technique, <span class="smallcaps">Prospect-Pro</span> (and <span class="smallcaps">Less</span> by extension) simplifies modelling any plant trait of interest, not just crop nitrogen, representing the highest level of generalizability where the orchard, crop, and response of interest can all vary.</p>
<p>However, discovering the true physical relationship between variables is extremely labour-intensive and stands in a stark contrast to machine learning models, where data gathering is the most time-consuming aspect. However, once a functional form capturing the true relationship is found, physics-based models can enable even better predictions than machine learning models, as presented in <a href="results-of-the-model-performances.html#sec-ResultsAreaBased">section&nbsp;<span>7.1.1</span></a>. Moreover, the physics-based modelling process enhances the understanding of nature, a benefit not offered by machine learning models. In particular, complex machine learning models, such as neural networks, are often referred to as black box models <span class="citation" data-cites="zhu2017deep rudin2019stop">(<a href="references.html#ref-zhu2017deep" role="doc-biblioref">Zhu et al. 2017</a>, <a href="references.html#ref-rudin2019stop" role="doc-biblioref">Rudin 2019</a>)</span>. While they may deliver impressive results, understanding the relationships they have learned can be extremely challenging.</p>
<p>The fact that machine learning models do not require prior knowledge and rely solely on data for making predictions makes them highly useful when combined with radiative transfer models. Machine learning models excel at detecting patterns and correlations in high-dimensional spaces, serving as valuable indicators for potential flaws or shortcomings in physics-based models. For instance, the superior performance of some machine learning models in predicting mass-based nitrogen on a leaf-level suggests a knowledge gap. Without machine learning models, determining what model accuracy can realistically be expected would be much more challenging.</p>
<p>The limitations of machine learning models can also be applied to vegetation indices. However, this vegetation indices generally performed poorly, especially when only using single vegetation indices. A primary advantage of vegetation indices is their computational efficiency and ease of implementation. However, this stems from a time when computational efficiency was a greater concern than it is today, meaning it is no longer a significant limitation. The results of this thesis suggest that single vegetation indices can hardly compete with either machine learning models or physics-based models. Nevertheless, new vegetation indices continue to be constructed using heuristics such as genetic algorithms <span class="citation" data-cites="costa2020new">(<a href="references.html#ref-costa2020new" role="doc-biblioref">Costa et al. 2020</a>)</span>. In this approach, the authors essentially frame the problem in the same manner as a supervised machine learning problem, but they solve it in a computationally inefficient way. Similar to machine learning models, this solution may rely on fortuitous correlations and generally represents an inelegant approach given the widespread availability of machine learning algorithms.</p>
<p>It is crucial to repeatedly acknowledge that the distinction between manual feature selection, machine learning, and physics-based models is somewhat arbitrary and exhibits considerable overlap. For example, both vegetation indices and the parameters retrieved by radiative transfer models are still connected to nitrogen measurements via linear regression, which can be considered a machine learning model. This link function could also be any other model, as <span class="citation" data-cites="verrelst2019quantifying">Verrelst et al. (<a href="references.html#ref-verrelst2019quantifying" role="doc-biblioref">2019</a>)</span> speaks of model hybridization — machine learning and radiative transfer models are fused. Consequently, machine learning is undoubtedly an invaluable tool for physics-based modelling.</p>
</section>
<section id="how-radiative-transfer-models-might-be-improved" class="level2" data-number="8.2">
<h2 data-number="8.2" class="anchored" data-anchor-id="how-radiative-transfer-models-might-be-improved"><span class="header-section-number">8.2</span> How radiative transfer models might be improved</h2>
<p>The machine learning models demonstrated slightly better performance than the radiative transfer models in predicting foliar nitrogen concentration, both at the canopy and leaf levels. This indicates a knowledge gap in the radiative transfer models.</p>
<p>To enhance the radiative transfer models employed, several adjustments could be contemplated. For the <span class="smallcaps">Prospect</span> model family, the chlorophyll parameter could be divided into two separate estimates for chlorophyll a and b concentrations. This distinction is crucial not only for more accurate chlorophyll content estimation but also for a better explanation of the observed spectral signature. <span class="citation" data-cites="li2018factors">Li et al. (<a href="references.html#ref-li2018factors" role="doc-biblioref">2018</a>)</span> demonstrated significant differences in chlorophyll a to b ratios among deciduous trees, shrubs, herbs, and grasses. The chlorophyll a to b ratio is also time-dependent, suggesting that dynamic models providing prior information could be incorporated. Dynamic crop models could be implemented to account for the change of the chlorophyll a to b ratio over time. Additionally, such models could also account for the accumulation of carbon-based content over time, which dilutes leaf nitrogen and thus reduces its measured concentration, even though the absolute nitrogen content may remain constant.</p>
<p>In addition, prior information about leaf parameter distributions (instead of only box constraints) could be utilized for the inversion of the radiative transfer model, for instance, by adopting a Bayesian optimization method instead of a maximum likelihood estimation. While these approaches are considerably more computationally intensive, they offer the added benefit of uncertainty estimates for all parameters.</p>
<p>The implementation of a ray tracing model like <span class="smallcaps">Less</span>, as presented in this thesis, primarily serves as a proof-of-concept and offers numerous opportunities for improvement. For instance, trees could be generated rather than hand-crafted by utilizing models such as <span class="smallcaps">Helios</span> <span class="citation" data-cites="bailey2019helios">(<a href="references.html#ref-bailey2019helios" role="doc-biblioref">Bailey 2019</a>)</span>. This approach would enable the more precise integration of plant parameters, such as leaf area index, tree size and geometry, and leaf inclination distribution function, all of which influence the spectral signature of trees <span class="citation" data-cites="guyot1989factors bailey2017rapid">(<a href="references.html#ref-guyot1989factors" role="doc-biblioref">Guyot et al. 1989</a>, <a href="references.html#ref-bailey2017rapid" role="doc-biblioref">Bailey and Mahaffee 2017</a>)</span>. Some of these parameters can be quickly measured using terrestrial LiDAR scanning to support modelling, as proposed by <span class="citation" data-cites="bailey2017rapid">Bailey and Mahaffee (<a href="references.html#ref-bailey2017rapid" role="doc-biblioref">2017</a>)</span>. <span class="smallcaps">Less</span> simulates leaves as Lambertian planes, which reflect light equally in all directions — which constitutes a certain departure from reality. In fact, reflectance depends on the solar incidence angle and viewing angle, together referred to as the bidirectional reflectance distribution function. Therefore, a more realistic ray tracing model simulating canopy reflectance should incorporate this process as well. However, measuring the bidirectional reflectance distribution function presents challenges due to the need to evaluate every possible combination of viewing and incidence angles for each material modelled.</p>
<p>Finally, such comprehensive models would necessitate a large-scale sensitivity analysis to better understand the impact of parameters on the reflectance.</p>
</section>
<section id="general-possibilities-for-improvement" class="level2" data-number="8.3">
<h2 data-number="8.3" class="anchored" data-anchor-id="general-possibilities-for-improvement"><span class="header-section-number">8.3</span> General possibilities for improvement</h2>
<p>There are several avenues for improvement which could benefit both machine learning and radiative transfer modelling: the spectral range covered by the sensors could be expanded, spatial and temporal dimensions in the data could considered, and the pre-processing of the data could be improved.</p>
<p>Extending the spectral range of the hyperspectral camera may prove advantageous. The performance results of various models at the canopy level appear to be limited to a maximum of 25%. The canopy level data only spans from 400 to 900 nm in its spectral dimension. Consequently, models trained on data from the hyperspectral camera are confined to the direct relationship between nitrogen and chlorophyll, and any additional correlation with plant pigments absorbing in the visible light spectrum. Incorporating information from the short-wave-infrared region — which covers protein absorption bands — may significantly improve predictions <span class="citation" data-cites="camino2018improved">(<a href="references.html#ref-camino2018improved" role="doc-biblioref">Camino et al. 2018</a>)</span>. While the correlation matrix in <a href="describing-processing-and-inspecting-the-data.html#fig-exploratory">figure&nbsp;<span>5.5</span></a> indicates a weaker correlation between short-wave-infrared region reflectance and nitrogen compared to the visible light spectrum, it also reveals that the short-wave-infrared regions are almost entirely uncorrelated with visible light regions. Therefore, crop nitrogen can likely be better modelled when utilizing data from both relevant regions.</p>
<p>It is worth noting that although the spectral range covered seems important — particularly with respect to short-wave-infrared — a higher spectral resolution is likely unnecessary. The efficacy of many models requiring information from only a few bands suggests that a small fraction of the number of bands would be sufficient to adequately model crop nitrogen. For example, the best-performing model at the canopy level using the prior square feature selection algorithm only requires six bands for optimal performance (<a href="technical-description-of-the-modelling.html#tbl-hyperparameters">Table&nbsp;<span>6.2</span></a>). Thus, adding only a few bands in the short-wave-infrared region may significantly enhance model performance.</p>
<p>Incorporating spatial information could further improve predictions. One possible approach involves learning the relationship between the shape and size of almond trees and their nitrogen foliar concentration, and using this knowledge to generate a synthetic labelled dataset. This dataset could enable the training of a convolutional neural network to learn the inverse function from spatial data. For example, similar research conducted by <span class="citation" data-cites="jin2021combining">Jin et al. (<a href="references.html#ref-jin2021combining" role="doc-biblioref">2021</a>)</span> demonstrated the successful training of a convolutional neural network to estimate forest canopy cover from satellite images. The convolutional neural network was initially trained on data generated using the three-dimensional radiative transfer model <span class="smallcaps">Rapid</span> and subsequently transferred to real data. This approach was found to enhance accuracy in comparison to a similar model solely trained on real data.</p>
<p>In addition to enhancing spectral and spatial information, temporal information could be included. Satellite imagery might be particularly useful for this purpose, as it captures orchards at regular intervals and provides standardized data formats — especially in the context of future imaging spectroscopy satellite missions <span class="citation" data-cites="berger2020crop">(<a href="references.html#ref-berger2020crop" role="doc-biblioref">Berger et al. 2020</a>)</span>.</p>
<p>Some final improvements could result from refining the data pre-processing steps applied to the hyperspectral images as described in <a href="describing-processing-and-inspecting-the-data.html#sec-HSIprocessing">section&nbsp;<span>5.3</span></a>. For instance, using seam-carving for tree-cropping in a non-grid manner could result in more precise tree cropping and subsequently improve the prediction accuracy.</p>
</section>
<section id="addressing-the-quality-and-properties-of-the-data" class="level2" data-number="8.4">
<h2 data-number="8.4" class="anchored" data-anchor-id="addressing-the-quality-and-properties-of-the-data"><span class="header-section-number">8.4</span> Addressing the quality and properties of the data</h2>
<p>Thus far, the attention has been solely directed towards potential enhancements in modelling or expanding the spectral, spatial, or temporal range or resolution of the data. In contrast, the ground-truth data utilized throughout this thesis was — as its name suggests — assumed to be fixed and entirely accurate. This assumption does not truly represent the real-world situation, as the ground-truth data is likely to contain considerable noise. As a result, fitting models to such noisy data can be challenging and give a wrong impression of the model’s predictive power. After all, the notion that feeding low-quality data into a computational system leads to unfavourable outcomes has been recognized even before the emergence of modern computers.</p>
<blockquote class="blockquote">
<p><em>“On two occasions I have been asked [by members of Parliament], ‘Pray, Mr.&nbsp;Babbage, if you put into the machine wrong figures, will the right answers come out?’ … I am not able rightly to apprehend the kind of confusion of ideas that could provoke such a question.”</em></p>
<p>Charles Babbage</p>
</blockquote>
<p><span class="citation" data-cites="burke2021using">Burke et al. (<a href="references.html#ref-burke2021using" role="doc-biblioref">2021</a>)</span> examined the implications of employing unreliable ground-truth data in remote sensing applications. Utilizing noisy data for calibrating models is not inherently problematic, provided that the data is unbiased. Nevertheless, a discrepancy between the measured nitrogen concentration and the actual tree-wide foliar nitrogen concentration can result in a substantial underestimation of model performance. But where could such noise in the labels come from?</p>
<p>First, the nitrogen measurements might contain substantial noise arising from the sample preparation, equipment failures, and also human error <span class="citation" data-cites="saez2013overview">(<a href="references.html#ref-saez2013overview" role="doc-biblioref">Sáez-Plaza et al. 2013</a>)</span>. Thus, the nitrogen measurements themselves are not an absolute ground truth, even with respect to the leaves.</p>
<p>Second, there exists a considerable disconnect between the nitrogen concentration of the sampled leaves and that of the entire tree. Previous research has shown that there is a high within-tree variance of the foliar nitrogen concentration <span class="citation" data-cites="khalsa2018understanding">(<a href="references.html#ref-khalsa2018understanding" role="doc-biblioref">Khalsa and Brown 2018</a>)</span>. Moreover, the tree crown typically contains more nitrogen than the bottom leaves due to its higher photosynthetic activity. Leaves sampled from a different area than that observed by the drones can also contribute to the noise.</p>
<p>The inadequate representation of the true tree-wide nitrogen content is further emphasized by the band-wise correlation with the nitrogen measurements (<a href="describing-processing-and-inspecting-the-data.html#fig-exploratory">Figure&nbsp;<span>5.5</span></a>): although the band-wise correlation appears similar between the canopy and leaf-level data, the magnitude of the correlation is much greater at the leaf level (<span class="math inline">\(r = -0.48\)</span> and <span class="math inline">\(r = -0.32\)</span>, respectively). This strongly indicates a mismatch between leaf-level nitrogen measurements and the true tree-level foliar nitrogen concentration.</p>
<p>In summary, canopy-level reflectance data exhibits a weaker correlation with nitrogen concentration compared to leaf-level reflectance data, possibly due to the sampled leaves not accurately representing the true tree-wide nitrogen content. Consequently, the performance of canopy level models may be underestimated, with their actual performance likely being considerably better.</p>
</section>
<section id="range-of-the-nitrogen-measurements" class="level2" data-number="8.5">
<h2 data-number="8.5" class="anchored" data-anchor-id="range-of-the-nitrogen-measurements"><span class="header-section-number">8.5</span> Range of the nitrogen measurements</h2>
<p>The data utilized in this thesis was derived from a commercial almond orchard, which applied high nitrogen rates in line with recommendations by the Almond Board of California <span class="citation" data-cites="nitrogen2020">(<a href="references.html#ref-nitrogen2020" role="doc-biblioref">Brown et al. 2020</a>)</span>. As a result, the measured foliar nitrogen concentrations almost all fell within a healthy range, between 1.96 and 3.17%, suggesting adequate nitrogen supply for most trees (<a href="describing-processing-and-inspecting-the-data.html#fig-PairsPanel">Figure&nbsp;<span>5.6</span></a>). According to <span class="citation" data-cites="micke1996">Micke (<a href="references.html#ref-micke1996" role="doc-biblioref">1996</a>)</span>, the optimal foliar nitrogen concentration would range between 2.2 and 2.5%, meaning that only a few almond trees would benefit from additional fertilization, while many could be considered slightly over-fertilized.</p>
<p>It is essential to note that almonds are alternate bearing crops. In 2022, the Westfield almond orchard experienced a weak bearing year, resulting in higher foliar nitrogen concentrations compared to a strong yielding year due to less foliar nitrogen being mobilized for fruit production. Conversely, the Westwind 2021 orchard had lower nitrogen levels, leading to a higher number of nitrogen-deficient trees. This factor significantly contributes to the varying predictive power of the same model from year to year.</p>
<p>Two critical implications arise from these observations concerning model evaluation. Firstly, the R<sup>2</sup> metric, the most intuitive measure of model performance, is influenced by the response variable’s range, as this range is part of its mathematical definition (<a href="results-of-the-model-performances.html#eq-RegressionPerformanceMetrics">Equation&nbsp;<span>7.1</span></a>). This implies that a broader range of measured nitrogen concentration generally results in increased R<sup>2</sup> values and result in a heightened sense of accuracy. Secondly, crop nitrogen status becomes more predictable when leaf nitrogen concentration is low, and plants exhibit nitrogen deficiency. This is attributed to the visual cues of nitrogen deficiency, manifesting as reduced chlorophyll content and visible leaf yellowing <span class="citation" data-cites="hawkesford2012functions">(<a href="references.html#ref-hawkesford2012functions" role="doc-biblioref">Hawkesford et al. 2012</a>)</span>. In contrast, nitrogen over-abundance leads to chlorophyll saturation without clear visual cues, making remote sensing detection more challenging <span class="citation" data-cites="munoz2013review">(<a href="references.html#ref-munoz2013review" role="doc-biblioref">Muñoz-Huerta et al. 2013</a>)</span>.</p>
<p>Several remote sensing studies investigating nitrogen concentrations have been conducted in tandem with nitrogen trials, where the experimental design specifically foresees certain blocks to be fertilized much less than others, or even not to be fertilized at all. This approach generally creates a wider range of foliar nitrogen, particularly at the lower end, which does not accurately represent real farming conditions. Due to the previously stated reasons, this increase range of the nitrogen labels result in a heightened sense of model accuracy. For instance, <span class="citation" data-cites="wang2017non">Wang et al. (<a href="references.html#ref-wang2017non" role="doc-biblioref">2017</a>)</span> predicted foliar nitrogen concentration in pear leaves from an experiment with application rates ranging between 0 and 990 kg N ha<sup>-1</sup> using spectrophotometric measurements. The authors achieved excellent predictions on their test data (R<sup>2</sup> = 0.85) and concluded that their method would enable relatively inexpensive nitrogen monitoring in pear orchards. Similar conclusions based on modelling results using data from fertilization trials can be found throughout the scientific literature and for various crops <span class="citation" data-cites="zha2020improving perich2021proximal pancorbo2021simultaneous">(<a href="references.html#ref-zha2020improving" role="doc-biblioref">Zha et al. 2020</a>, <a href="references.html#ref-pancorbo2021simultaneous" role="doc-biblioref">Pancorbo et al. 2021</a>, <a href="references.html#ref-perich2021proximal" role="doc-biblioref">Perich et al. 2021</a>)</span>.</p>
<p>To ensure the development of remote sensing technologies applicable in commercial agriculture, it is important to test these technologies in settings that accurately reflect commercial farming conditions — especially when the conducted research promises to address the environmental problem of nitrogen leaching, rather than to detect plant stress from nitrogen deficiency. Consequently, further research focusing on remote sensing of crop nitrogen should focus on experimental settings that represent the reality of commercial farms.</p>


<div id="refs" class="references csl-bib-body hanging-indent" data-line-spacing="2" role="list" style="display: none">
<div id="ref-bailey2019helios" class="csl-entry" role="listitem">
Bailey, B. N. 2019. <a href="https://doi.org/10.3389/fpls.2019.01185">Helios: A scalable 3D plant and environmental biophysical modeling framework</a>. Frontiers in Plant Science 10:1185.
</div>
<div id="ref-bailey2017rapid" class="csl-entry" role="listitem">
Bailey, B. N., and W. F. Mahaffee. 2017. <a href="https://doi.org/10.1016/j.rse.2017.03.011">Rapid measurement of the three-dimensional distribution of leaf orientation and the leaf angle probability density function using terrestrial LiDAR scanning</a>. Remote Sensing of Environment 194:63–76.
</div>
<div id="ref-berger2020crop" class="csl-entry" role="listitem">
Berger, K., J. Verrelst, J.-B. Feret, Z. Wang, M. Wocher, M. Strathmann, M. Danner, W. Mauser, and T. Hank. 2020. <a href="https://doi.org/10.1016/j.rse.2020.111758">Crop nitrogen monitoring: Recent progress and principal developments in the context of imaging spectroscopy missions</a>. Remote Sensing of Environment 242:111758.
</div>
<div id="ref-nitrogen2020" class="csl-entry" role="listitem">
Brown, P. H., S. Saa, S. Muhammad, and S. D. Khalsa. 2020. Nitrogen best management practices. Almond Board of California, 1150 Ninth Street, Suite 1500, Modesto, CA 95354.
</div>
<div id="ref-burke2021using" class="csl-entry" role="listitem">
Burke, M., A. Driscoll, D. B. Lobell, and S. Ermon. 2021. <a href="https://doi.org/10.1126/science.abe8628">Using satellite imagery to understand and promote sustainable development</a>. Science 371:eabe8628.
</div>
<div id="ref-camino2018improved" class="csl-entry" role="listitem">
Camino, C., V. González-Dugo, P. Hernández, J. Sillero, and P. J. Zarco-Tejada. 2018. <a href="https://doi.org/10.1016/j.jag.2018.04.013">Improved nitrogen retrievals with airborne-derived fluorescence and plant traits quantified from VNIR-SWIR hyperspectral imagery in the context of precision agriculture</a>. International journal of applied earth observation and geoinformation 70:105–117.
</div>
<div id="ref-costa2020new" class="csl-entry" role="listitem">
Costa, L., L. Nunes, and Y. Ampatzidis. 2020. <a href="https://doi.org/10.1016/j.compag.2020.105334">A new visible band index (vNDVI) for estimating NDVI values on RGB images utilizing genetic algorithms</a>. Computers and Electronics in Agriculture 172:105334.
</div>
<div id="ref-guyot1989factors" class="csl-entry" role="listitem">
Guyot, G., D. Guyon, and J. Riom. 1989. <a href="https://doi.org/10.1080/10106048909354217">Factors affecting the spectral response of forest canopies: A review</a>. Geocarto International 4:3–18.
</div>
<div id="ref-hawkesford2012functions" class="csl-entry" role="listitem">
Hawkesford, M., W. Horst, T. Kichey, H. Lambers, J. Schjoerring, I. S. Møller, and P. White. 2012. <a href="https://doi.org/10.1016/B978-0-12-384905-2.00006-6">Functions of macronutrients</a>. Pages 135–189 Marschner’s mineral nutrition of higher plants. Elsevier.
</div>
<div id="ref-jin2021combining" class="csl-entry" role="listitem">
Jin, D., J. Qi, H. Huang, and L. Li. 2021. <a href="https://doi.org/10.1109/JSTARS.2021.3122509">Combining 3D radiative transfer model and convolutional neural network to accurately estimate forest canopy cover from very high-resolution satellite images</a>. IEEE Journal of Selected Topics in Applied Earth Observations and Remote Sensing 14:10953–10963.
</div>
<div id="ref-khalsa2018understanding" class="csl-entry" role="listitem">
Khalsa, S. D. S., and P. H. Brown. 2018. <a href="https://doi.org/10.17660/ActaHortic.2019.1253.28">Understanding nitrogen cycling in an irrigated deciduous permanent crop</a>. Pages 207–212 XXX international horticultural congress IHC2018: International symposium on water and nutrient relations and management of 1253.
</div>
<div id="ref-li2018factors" class="csl-entry" role="listitem">
Li, Y., N. He, J. Hou, L. Xu, C. Liu, J. Zhang, Q. Wang, X. Zhang, and X. Wu. 2018. <a href="https://doi.org/10.3389/fevo.2018.00064">Factors influencing leaf chlorophyll content in natural forests at the biome scale</a>. Frontiers in Ecology and Evolution 6:64.
</div>
<div id="ref-micke1996" class="csl-entry" role="listitem">
Micke, W. 1996. Almond production manual. Regents of the University of California.
</div>
<div id="ref-munoz2013review" class="csl-entry" role="listitem">
Muñoz-Huerta, R. F., R. G. Guevara-Gonzalez, L. M. Contreras-Medina, I. Torres-Pacheco, J. Prado-Olivarez, and R. V. Ocampo-Velazquez. 2013. <a href="https://doi.org/10.3390/s130810823">A review of methods for sensing the nitrogen status in plants: Advantages, disadvantages and recent advances</a>. sensors 13:10823–10843.
</div>
<div id="ref-pancorbo2021simultaneous" class="csl-entry" role="listitem">
Pancorbo, J., C. Camino, M. Alonso-Ayuso, M. Raya-Sereno, I. Gonzalez-Fernandez, J. L. Gabriel, P. J. Zarco-Tejada, and M. Quemada. 2021. <a href="https://doi.org/10.1016/j.eja.2021.126287">Simultaneous assessment of nitrogen and water status in winter wheat using hyperspectral and thermal sensors</a>. European Journal of Agronomy 127:126287.
</div>
<div id="ref-perich2021proximal" class="csl-entry" role="listitem">
Perich, G., P. Meyer, A. Wieser, and F. Liebisch. 2021. <a href="https://doi.org/10.1109/WHISPERS52202.2021.9484031">Proximal and drone based hyperspectral sensing for crop nitrogen status detection in historic field trials</a>. Pages 1–5 2021 11th workshop on hyperspectral imaging and signal processing: Evolution in remote sensing (WHISPERS). IEEE.
</div>
<div id="ref-rudin2019stop" class="csl-entry" role="listitem">
Rudin, C. 2019. <a href="https://doi.org/10.1038/s42256-019-0048-x">Stop explaining black box machine learning models for high stakes decisions and use interpretable models instead</a>. Nature machine intelligence 1:206–215.
</div>
<div id="ref-saez2013overview" class="csl-entry" role="listitem">
Sáez-Plaza, P., M. J. Navas, S. Wybraniec, T. Michałowski, and A. G. Asuero. 2013. <a href="https://doi.org/10.1080/10408347.2012.751787">An overview of the kjeldahl method of nitrogen determination. Part II. Sample preparation, working scale, instrumental finish, and quality control</a>. Critical Reviews in Analytical Chemistry 43:224–272.
</div>
<div id="ref-verrelst2019quantifying" class="csl-entry" role="listitem">
Verrelst, J., Z. Malenovskỳ, C. Van der Tol, G. Camps-Valls, J.-P. Gastellu-Etchegorry, P. Lewis, P. North, and J. Moreno. 2019. <a href="https://doi.org/10.1007/s10712-018-9478-y">Quantifying vegetation biophysical variables from imaging spectroscopy data: A review on retrieval methods</a>. Surveys in Geophysics 40:589–629.
</div>
<div id="ref-wang2017non" class="csl-entry" role="listitem">
Wang, J., C. Shen, N. Liu, X. Jin, X. Fan, C. Dong, and Y. Xu. 2017. <a href="https://doi.org/10.3390/s17030538">Non-destructive evaluation of the leaf nitrogen concentration by in-field visible/near-infrared spectroscopy in pear orchards</a>. Sensors 17:538.
</div>
<div id="ref-zha2020improving" class="csl-entry" role="listitem">
Zha, H., Y. Miao, T. Wang, Y. Li, J. Zhang, W. Sun, Z. Feng, and K. Kusnierek. 2020. <a href="https://doi.org/10.3390/rs12020215">Improving unmanned aerial vehicle remote sensing-based rice nitrogen nutrition index prediction with machine learning</a>. Remote Sensing 12:215.
</div>
<div id="ref-zhu2017deep" class="csl-entry" role="listitem">
Zhu, X. X., D. Tuia, L. Mou, G.-S. Xia, L. Zhang, F. Xu, and F. Fraundorfer. 2017. <a href="https://doi.org/10.1109/MGRS.2017.2762307">Deep learning in remote sensing: A comprehensive review and list of resources</a>. IEEE Geoscience and Remote Sensing Magazine 5:8–36.
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./results-of-the-model-performances.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Results of the model performances</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./conclusion.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Conclusion</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">© 2023, Damian Oswald</div>   
    <div class="nav-footer-center">Remote Sensing of Foliar Nitrogen in Californian Almonds (2023)</div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/Damian-Oswald">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/damian-oswald">
      <i class="bi bi-linkedin" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="mailto:damian.oswald@protonmail.com">
      <i class="bi bi-envelope-fill" role="img">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>



</body></html>