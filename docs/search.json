[
  {
    "objectID": "index.html#preface",
    "href": "index.html#preface",
    "title": "Remote Sensing of Foliar Nitrogen in Californian Almonds",
    "section": "Preface",
    "text": "Preface\nWelcome to this site! Here, you can find my master’s thesis which I wrote in Davis, California in 2022/23 to earn a master’s degree in agricultural science from the Swiss Federal Institute of Technology, Zürich (ETHZ).\nNote that the web version of this thesis differs slightly from the PDF version that I submitted at April 28, 2023 – mainly because the web version uses colored graphics, and because some minor content was rearranged for a better legibility and user experience.\nBoth the web version as well as the PDF document of this thesis were created with Quarto. Quarto is an amazing open-source scientific and technical publishing system that can be used to create reproducible books, simple articles, entire websites and much more. You can find the source code of the thesis on this GitHub repository.\nIf you want to know more about this work, don’t hesitate to reach out via email or on LinkedIn."
  },
  {
    "objectID": "index.html#abstract",
    "href": "index.html#abstract",
    "title": "Remote Sensing of Foliar Nitrogen in Californian Almonds",
    "section": "Abstract",
    "text": "Abstract\nNitrogen is a crucial plant nutrient, but both its under-availability and over-abundance can harm crop yields as well as the environment and reduce water supply quality. This is particularly important for almond orchards in California, where nitrogen is applied in large quantities due to the crop’s profitability. Remote sensing techniques show promise for quantifying foliar nitrogen concentration in crops, which can inform fertilization decisions and potentially reduce the risks of over-fertilization. In this thesis, I explore and test various remote sensing approaches for estimating the foliar nitrogen concentration in Californian almonds using spectroradiometric measurements at the leaf level and hyperspectral imaging at the canopy level. I evaluate numerous classical vegetation indices, various machine learning models, and two physics-informed radiative transfer models. Radiative transfer modelling, although less investigated in scientific literature, demonstrates potential as both a robust and generalizable technique, yielding results comparable to the best-performing machine learning models."
  },
  {
    "objectID": "index.html#acknowledgement",
    "href": "index.html#acknowledgement",
    "title": "Remote Sensing of Foliar Nitrogen in Californian Almonds",
    "section": "Acknowledgement",
    "text": "Acknowledgement\nFirst and foremost, I would like to express my gratitude to my project supervisors, Prof. Dr. Achim Walter and Prof. Dr. Alireza Pourreza, both for their guidance and for granting me the opportunity to write my master’s thesis at the University of California in Davis. I would also like to express my appreciation to all the members of the Digital Agriculture Laboratory for their unwavering support and camaraderie. A special acknowledgement goes to Momtanu Chakraborty, Yuto Kamiya, and Hamid Jafarbiglu for their invaluable assistance in addressing technical and scientific queries. Finally, I am eternally grateful to my parents, Susannah and Armin, without whom this journey would not have been possible, and to Alice, who always stood by my side."
  },
  {
    "objectID": "index.html#attribution",
    "href": "index.html#attribution",
    "title": "Remote Sensing of Foliar Nitrogen in Californian Almonds",
    "section": "Attribution",
    "text": "Attribution\nFor attribution, please cite this work as:\nOswald, Damian. Remote Sensing of Foliar Nitrogen in Californian Almonds. https://damian-oswald.github.io/master-thesis (2023).\nHere’s the BibTeX citation:\n@masterthesis{oswald2023nitrogen,\n  author = {Oswald, Damian},\n  title = {Remote Sensing of Foliar Nitrogen in Californian Almonds},\n  date = {2023-04-28},\n  url = {https://damian-oswald.github.io/master-thesis},\n  langid = {en}\n}"
  },
  {
    "objectID": "background.html#sec-almonds",
    "href": "background.html#sec-almonds",
    "title": "1  Background",
    "section": "1.1 Almond production in California",
    "text": "1.1 Almond production in California\nThe United States of America is by far the world’s largest producer of almonds (Prunus amygdalus Batsch) with a production share of roughly 80% (CDFA 2020). Almost all of this production takes place in the state of California, whose Mediterranean climate and well-developed water infrastructure make it possible to grow the crop commercially, even though almonds are not native to the state (Bjerga et al. 2018). Almond trees have an average life span of 20 to 25 years, whereby it typically takes three to four years for a tree to begin producing fruits. The almond trees in California begin blooming mid-February through March and harvest takes place in October before the wet season starts. The crops are alternate bearing, which means that strong harvests are succeeded by weaker ones in the following year (WIFSS 2016).\nOne could argue that the expansion of its almond industry is California’s biggest agricultural success story (Bruno et al. 2021). Over the last three decades, the production volume increased almost eight-fold: the state produced about 1.27 million tons of almonds on 408’000 ha in 2020 (USDA 2021). The majority of the growing sites stretch along the Central Valley, most notably the counties Fresno, Kern, Stanislaus, Merced, and Madera (Figure 1.1). The economic value of Californian almond production sums up to a staggering 5.62 billion U.S. dollars annually. Thus, almonds rank third place among California’s agricultural commodities, trailing only the dairy and grape industries (Bruno et al. 2021).\nThis immense production comes at a cost. California is a comparatively dry state, where agriculture uses around 40% of the total available water supply — although that percentage varies dramatically between wet and dry years (Mount and Hanak 2016). It is estimated that Californian almond orchards alone use approximately 10% of the state’s water supply (Holthaus 2015). The scarcity of water is only expected to increase due to reduced amount of snowpack in the Sierras, depleting groundwater levels and climate change — the California Department of Water Resources expects a 10% reduction in water supply by 2040 (DWR 2022). Although discerning strong trends from climate projections is difficult, a drying trend for the Sacramento River Basin during the 21st century is observed through different climate scenarios developed (DWR 2015). As a consequence to these environmental changes, almond yields are predicted to decrease in the coming decades (Pathak et al. 2018).\n\n\n\nFigure 1.1: Map of California (Mercator projection). The shading of the counties relates to their almond production relative to the total Californian almond production. The counties with the highest almond production are Fresno (1), Kern (2), Stanislaus (3), Merced (4), and Madera (5). The area encircled by the dashed line indicates the approximate location of the Californian Central Valley. The data used to produce this map was obtained from the U.S. Department of Agriculture (USDA 2021).\n\n\nThese trends are likely to increase the economic pressure on almond farmers and provide incentives to take up water-saving measures. While some older orchards in California may still be irrigated using flood irrigation, 85% of the orchards use low-volume irrigation, which is much preferable for water conservation (ABC 2020). In addition to that, some farmers already adopted the use of remote sensing for a more resourceful irrigation, either using water-stress-specific vegetation indices or thermal imaging (Ihuoma and Madramootoo 2017, ABC 2020, Ceres Imaging 2022, VineView 2022).\nAnother serious problem stemming from the intensive agriculture in California is nitrogen leaching due to over-fertilization. The subsequent excesses of nitrate in water resources have been found to contribute to environmental degradation in the state (Viers et al. 2012). For almond orchards, it is officially recommended to apply nitrogen in four rates: 20% of the total annual application at the end of the blooming stage, 30% during fruit growth, 30% during kernel fill and at last, 20% after the hull-split or after harvest (Brown et al. 2020). Thereby, it is not uncommon in intensive almond orchards to apply up to 300 kg nitrogen per hectare and year (Smart et al. 2014), although the Almond Board of California (ABC) states that the fertilization should consider both the almond tree’s age as well as the expected kernel yield (Brown et al. 2020). As such, recommendations for best management practices range between 130 and 285 kg nitrogen per hectare and year. Thus, under a new regulation of the Californian state to avoid environmental contamination, farmers are required to apply nitrogen fertilizations appropriately (Zhang et al. 2019)."
  },
  {
    "objectID": "background.html#sec-nitrogen",
    "href": "background.html#sec-nitrogen",
    "title": "1  Background",
    "section": "1.2 Challenges with balancing crop nitrogen",
    "text": "1.2 Challenges with balancing crop nitrogen\nNitrogen (\\(\\text{N}\\)) is a vital element for plant growth. It is essential for the plant’s metabolism and is found in proteins, nucleic acids, chlorophyll, co-enzymes, phytohormones, and secondary metabolites. Plants take up nitrogen in the form of ammonium or nitrate and convert it into amino acids, either in their roots or shoots. Once inside the plant, nitrogen is transported as nitrate or amino acids (Hawkesford et al. 2012). The use of synthetic nitrogen fertilizers has drastically increased since the green revolution and has been a major driver for higher food production (Vitousek et al. 1997). However, the recovery of nitrogen from these fertilizers by plants is rather low and rarely exceeds 50% of the fertilizer input (Raun et al. 1999). The proportional uptake by plants is usually even lower in the case of organic fertilizers when compared to mineral fertilizers (Webb et al. 2013).\nThe resulting loss of nitrogen from agricultural systems negatively impacts non-agricultural systems, such as terrestrial, ground, and freshwater ecosystems. Through leaching, nitrogen can move to other ecosystems in the form of nitrate (\\(\\text{NO}_3^-\\)) and cause eutrophication of surface water or contamination of drinking water (Kapoor and Viraraghavan 1997, Yang et al. 2008). Agricultural production also contributes heavily to the emission of gaseous nitrogen in the form of ammonia (\\(\\text{NH}_3\\)), molecular nitrogen (\\(\\text{N}_2\\)) or nitrogen oxide (\\(\\text{NO}_2\\)) and nitrous oxide (\\(\\text{N}_2 \\text O\\)), the latter two of which are greenhouse gases and thus accelerate climate change (Stark and Richards 2008). On the other hand, nitrogen deficiency negatively affects crop yields both in terms of quantity as well as quality. Therefore, there is also a substantial economic interest to continuously monitor the nitrogen status of crops during all growth stages (Baret et al. 2007, Hank et al. 2019).\nFoliar nitrogen concentrations vary a lot among plant species, phenological stages and environmental conditions, ranging between 0.2 to 6.4% of the leaf dry weight (Wright et al. 2004). The optimal nitrogen concentration in almond leaves lies between 2.2 and 2.5%—the exact value depends on the time and the targeted yield (Micke 1996). In C3 plant leaves, nitrogen is indispensable for photosynthesis, biosynthesis, carbon fixation and bioenergetics, since is a crucial element to both proteins and chlorophyll a and b (Figure 1.2). Chlorophyll is a key component in the light harvesting process of plants and its porphyrin core contains four nitrogen atoms, which act as a stabilizer of the central magnesium ion (Evans 1989). However, in C3 plants, chlorophyll a and b only bind 1.7% of the total leaf nitrogen (Chapin et al. 1987). Precise knowledge of the nitrogen concentration in plant leaves can be used for a more targeted fertilization and might even pave the way for variable rate fertilization (Guerrero et al. 2021). For example, one might consider the nitrogen nutrition index (NNI) introduced by Justes et al. (1994).\n\\[\\text {NNI} = \\frac{\\text {N}_\\%}{\\text {N}_\\text{crit.}} \\tag{1.1}\\]\nHere, N% is the measured nitrogen concentration and Ncrit. the critical nitrogen concentration. If NNI \\(\\geq\\) 1, the crop is sufficiently (or even excessively) provided with nitrogen. Vice versa NNI \\(&lt;\\) 1 implies a nitrogen deficiency. Unfortunately, the retrieval of information about the foliar nitrogen concentration via chemical analyses is generally labour and cost intensive and thus not fit for monitoring the nitrogen concentration in plants throughout their seasonal development (Berger et al. 2020). This calls for surrogate strategies of estimating the foliar nitrogen concentration — for example via remote sensing. Remote sensing of crop nitrogen for more adequate fertilization is in fact one of the core promises of precision agriculture and smart farming (Zhang et al. 2002, Walter et al. 2017, Sishodia et al. 2020).\n\n\n\n\nFigure 1.2: This figure shows the proportional functional allocation of nitrogen in an average C3 plant leaf. The percentages indicate what share of nitrogen is bound for a specific purpose. Adapted from Chapin et al. (1987)."
  },
  {
    "objectID": "background.html#sec-remotesensing",
    "href": "background.html#sec-remotesensing",
    "title": "1  Background",
    "section": "1.3 The role of remote sensing in precision agriculture",
    "text": "1.3 The role of remote sensing in precision agriculture\nAccording to Pierce and Nowak (1999), precision agriculture involves using various technologies and principles to address the spatial and temporal variability in all elements of agricultural production, with the ultimate goal of enhancing crop performance and maintaining environmental quality. As such, precision agriculture is a part of smart farming, which aims at the optimization of agricultural systems driven by digitally available information (Wolfert et al. 2017). A core driver of precision agriculture is the increasing availability of remotely sensed data as well as the means of analyzing this data (Sishodia et al. 2020). Remote sensing describes the process of acquiring information about properties of an object without physical contact to said object, i.e., the attempt to measure something from distance rather than in situ (Schowengerdt 2006). This type of data is typically measured by satellites, aircraft, or unmanned aerial vehicles (Sishodia et al. 2020).\nFor numerous agricultural applications, remote sensing focuses on measuring the electromagnetic radiation reflected or emitted from the Earth’s surface, primarily the reflection of sunlight in the visible and near-infrared spectrum (Jafarbiglu and Pourreza 2022). Sensors more effectively capture signals in the visible light spectrum between 380 and 750 nm wavelength because the electromagnetic radiation of the sun is the peaking there, whereas it tapers off in the ultraviolet and near- to short-wave-infrared regions (Figure 1.3, A).\nThe intensity of this electromagnetic radiation — its flux density — is typically measured in watts per square metre (W m−2, ISO 2022). If this radiation is received by a physical object, it is referred to as irradiance, if it is emitted by the object, it is called radiance. The spectral irradiance and radiance on the other hand are a measure of irradiance or radiance over a specific range of wavelengths (or frequencies) rather than across the entire electromagnetic spectrum, and thus typically measured in watts per square metre per nanometre (W m−2 nm−1, ISO 2022). The solar irradiance measured at a particular time and location depends on many parameters such as the solar incidence angle, the height above mean sea level, or the current atmospheric conditions (Blumthaler et al. 1997, Stickler and Kyle 2016). Because of that, remote sensing applications do not directly analyse the radiance — which is just as dependent on those parameters as the irradiance — but rather the so-called reflectance (\\(\\rho\\)). Reflectance is the share of electromagnetic radiation which is reflected by a body. Consequentially, the spectral reflectance is defined as the ratio between the spectral radiance \\(\\Phi_{\\text e, \\lambda} ^\\text r\\) and the spectral irradiance \\(\\Phi_{\\text e, \\lambda} ^\\text i\\) (ISO 2022).\n\\[\\rho_\\lambda = \\frac{\\Phi_{\\text e, \\lambda} ^\\text r}{\\Phi_{\\text e, \\lambda} ^\\text i} \\tag{1.2}\\]\nAt which exact wavelengths \\(\\lambda\\) this reflectance is calculated depends on the available data. Data from an ordinary digital camera usually covers three bands: red (620-740 nm), green (500-560 nm), and blue (450-490 nm), which is why it is referred to as RGB imagery (Bruno and Svoronos 2005). In contrast to that, multispectral images are a type of remotely sensed data that consist of more than three bands beyond just the visible spectrum. For agricultural purposes, multispectral imagery typically combines RGB imagery with bands in the near-infrared spectrum (Hagen and Kudenov 2013). Because the infrared spectrum will be quite important within the scope of this thesis, I will often refer to certain subgroups of that range: near-infrared (NIR, 750-1400 nm), short-wavelength-infrared (SWIR, 1400-3000 nm), mid-wavelength infrared (MWIR, 3-8 \\(\\mu\\)m), long-wavelength infrared (LWIR, 8-15 \\(\\mu\\)m) and far infrared (FIR, 15-1000 \\(\\mu\\)m, Byrnes 2009).\n\n\n\n\nFigure 1.3: This figure illustrates the spectral flux density of solar irradiance (A) in relation to the broader electromagnetic spectrum (B). A portion of the initial irradiance is absorbed by various gases or scattered by Rayleigh scattering, resulting in only a part of it reaching the Earth’s surface at sea level. The irradiance and radiance data at a given surface location (C) can be utilized to calculate the reflectance based on equation 1.2 (D). This reflectance enables the determination of various physical and biochemical properties of the surface. This figure was adapted from work by Rohde (2013) and created using data from the National Renewable Energy Laboratory (2022).\n\n\n\nWhen incorporating numerous additional spectral bands into the imaging process, it is referred to as hyperspectral imaging. Hyperspectral images (HSI) usually consist of hundreds of narrow, contiguous wavelength bands, which together with the spatial resolution form a hypercube \\(\\mathbf X \\in \\mathbb R^{w \\times l \\times d}\\) with the width \\(w\\), length \\(l\\) and the depth \\(d\\) (that is the number of spectral bands). The high spectral resolution is the main advantage of hyperspectral imaging, it is what allows for the detailed analysis of the chemical and physical properties of the imaged surface (Bioucas-Dias et al. 2013). This high spectral resolution however stands in a trade-off relationship with the spatial resolution, which is why hyperspectral imaging usually yields a lower spatial resolution than multispectral imaging (Yokoya and Iwasaki 2013). Sometimes, the continuous information about an object’s reflectance found solely in the spectral dimension of hyperspectral images is also referred to as its spectral signature. A very important property of the spectral dimension of hyperspectral images is the strong autocorrelation among spectral bands, which is expressed in extremely non-diagonal covariance matrices (Camps-Valls et al. 2011).\nIn order to to capture hyperspectral images, specialized hyperspectral cameras are used. They typically consist of a spectrograph, which separates the incoming light into its individual wavelength bands, and of an array of detectors that measure the intensity of the light in each band (El Masry and Sun 2010). The spectrograph and detectors are combined into a single, integrated unit, which is mounted on the carrying platform. These sensors work well in the visible spectrum, but the quality starts to drop in the near-infrared region and especially in the short-wave-infrared region (after 900 nm wavelength, see figure 1.3).\nThere are several reasons for this. One reason is that the near-infrared and short-wavelength infrared regions are typically characterized by lower levels of radiance compared to the visible light spectrum, which can make it difficult to obtain high-quality, noise-free data. In addition, the short-wavelength infrared region is often affected by atmospheric absorption of different gases, especially water vapour, which can cause the signal strength to vary significantly depending on the atmospheric conditions (Figure 1.3 A). This noise is sometimes removed using atmospheric correction algorithms (Gao et al. 2009). A third challenge in the short-wavelength infrared region is the need for specialized detectors that are sensitive to the wavelengths of light in this region. These detectors are typically made of alloys such as indium gallium arsenide or mercury cadmium telluride, which are more expensive and less sensitive than the detectors used in the visible and near-infrared regions (Ciani et al. 2020, Dyson 2021).\nDue to these reasons, hyperspectral imaging of sufficient quality is often limited to the visible- and near-infrared spectrum. Acquiring exact spectral information in the short-wave-infrared spectrum is mostly reserved to spectroradiometric measurements, although this starts to change with the advancement of hyperspectral sensors (Weber et al. 2016)."
  },
  {
    "objectID": "background.html#sec-nitrogenRS",
    "href": "background.html#sec-nitrogenRS",
    "title": "1  Background",
    "section": "1.4 Remote sensing of nitrogen",
    "text": "1.4 Remote sensing of nitrogen\nThe first attempt to directly model crop nitrogen based on spectrophotometrically measured reflectance data has been made by Thomas and Oerther (1972), who worked on sweet potatoes. The authors stated:\n\n“The regression equation at the 550 nm wavelength suggests that near the 4% nitrogen level a 1% change in reflectance would change the predicted nitrogen content by 0.2%.”\n\nIn other words, they proposed a simple linear regression model (on logarithmically transformed variables) to quickly estimate the nitrogen concentration — solely based on the reflectance at 550 nm wavelength. Back then, this relationship had to be found by calculating all band-wise correlations and simply choosing a suitable band for the regression. Ever since, much more advanced methods of modelling crop nitrogen have been developed. There are many ways to divide the modelling approaches into groups. For example, Verrelst et al. (2019) proposed grouping the methods in parametric, non-parametric, physics-based and hybrid methods. Berger et al. (2020) followed up on that division, but further distinguished between linear and non-linear methods — which they equate to the terms chemometrics and machine learning.\nHowever, the terms parametric and non-parametric as used by Berger et al. (2020) collide with pre-occupied definitions in the field of machine learning. Furthermore, the formal definition of machine learning also applies to many of the other groups proposed by the authors. Therefore, I will use the following simplified classification throughout this thesis:\n\nHand-crafted features\nMachine learning\nRadiative transfer models\n\nThe primary distinction between the first two methods lies in how the bands which are used to make predictions are selected. Hand-crafted features describe all methods which select a subset of bands or a mathematical combination thereof (as in the case of vegetation indices) which is made prior to the fitting of the regression model. Thereby, the band selection happens according to a certain imposed logic, or according to what is already used in the scientific literature. In contrast to that, the models classified as machine learning have access to the entire data, i.e., all available bands. The model automatically learns which bands or combinations of bands are the most important for accurately predicting crop nitrogen without prior information or manual feature engineering. Radiative transfer models, conversely, are primarily designed to simulate the detailed physical processes governing the transport of light and its interaction with a leaf or canopy. As a result, these models incorporate a substantial amount of prior knowledge. At this point, it is important to acknowledge that ultimately, these classifications possess a degree of arbitrariness and exhibit considerable overlap in their respective methodologies.\nAll three listed methods have been explored in the scientific literature, but not in comparable detail. Berger et al. (2020) found that 78 out of 125 evaluated studies that aimed to predict crop nitrogen via remote sensing relied on vegetation indices. Out of these, only a few studies have highlighted the limitations of indices-based approaches, such as their limited transferability to different sites. The studies mostly relied on the empirical relationship of certain vegetation indices to the chlorophyll content of crops, which in turn is related to nitrogen (Peñuelas et al. 1994, Baret et al. 2007). The application of machine learning for crop nitrogen estimation was also investigated by numerous studies, where the most often applied model was the partial least squares regression model. Radiative transfer models on the other hand have only been used in three studies for modelling crop nitrogen (Berger et al. 2020).\nCrop nitrogen or nitrogen content are both ambiguous terms, although very commonly used in the scientific literature. Ever since Thomas and Oerther (1972) pioneered remote sensing of nitrogen, the focus lied on two different measurements: mass- and area-based nitrogen (Wright et al. 2004). Mass-based nitrogen (N%) is the nitrogen concentration in the leaves, typically relative to the leaf dry weight. Area-based nitrogen (Narea) describes how much nitrogen is present in the biomass over a certain area. The two measures are linked together by the leaf mass per area (LMA), which is a widely used morphological trait that indicates good plant growth and functioning (de la Riva et al. 2016).\n\\[\\text N_{\\text{area}} = \\text{LMA} \\times \\text N_{\\%} \\tag{1.3}\\]\nThe majority of the contemporary studies focus on multi- or hyperspectral data. However, there is still some ongoing research about the usage of broadly available and low cost RGB imagery for predicting nitrogen content in crops, although with no great success (Schirrmann et al. 2016, Zheng et al. 2018, Fu et al. 2020).\nWithin the visible light spectrum, three types of plant pigments mainly determine the absorption process and thus the leaf colour: chlorophylls, carotenoids, and anthocyanins. Chlorophylls include chlorophyll a and b with their respective absorption bands, while carotenoids (e.g., \\(\\beta\\)-carotene and xanthophyll) and anthocyanins include numerous compounds (Féret et al. 2008). Out of these pigments, only chlorophyll is directly connected to nitrogen. It accounts for roughly 1.7% of total leaf nitrogen, which explains the rather loose Pearson correlation (\\(\\rho = 0.65 \\pm 0.15\\)) between the chlorophyll and the nitrogen concentration in leaves (Kokaly et al. 2009, Homolová et al. 2013). It remains to be noted that the Pearson correlation might not be the best metric to compare nitrogen and chlorophyll, as Padilla et al. (2018) have found a second order polynomial model to slightly improve the model fit.\nFully relying on chlorophyll for the remote sensing of crop nitrogen is highly limited and can even be misleading. First, the prediction will always be limited to the correlation between the two traits. Also, the relationship between chlorophyll and nitrogen changes over time, as nitrogen is reallocated from the vegetative organs to reproductive structures during the reproductive stage (Ohyama 2010). Finally, a lack of chlorophyll cannot certainly be ascribed to a nitrogen deficiency but also any other chlorosis-causing nutrient deficiency (Bloem et al. 2005, Asner and Martin 2009).\nDue to these reasons, leaf protein content would be a more stable proxy for the foliar nitrogen concentration (Berger et al. 2020). The majority of plant nitrogen is bound to protein (Figure 1.2), thus there is less room for decoupling between the two traits (Kokaly et al. 2009)."
  },
  {
    "objectID": "background.html#sec-aims",
    "href": "background.html#sec-aims",
    "title": "1  Background",
    "section": "1.5 Aims and structure of this thesis",
    "text": "1.5 Aims and structure of this thesis\nIn this master’s thesis, I pursue two primary objectives: First, I aim to gain a comprehensive understanding of the various methods for modelling crop nitrogen, as outlined in the previous section. Second, I search for a model capable of effectively mapping the spectral signature of almond canopies or leaves with their respective nitrogen concentrations, while maintaining generalizability across diverse temporal variations, including different times of the year, distinct years, and varied geographical locations.\nWith these goals in mind, the thesis is structured as follows: The first part delves into each of the approaches previously introduced. Chapter 2 examines remote sensing of nitrogen using vegetation indices. Chapter 3 is dedicated to selected machine learning algorithms suitable for hyperspectral data analysis. Chapter 4 investigates physics-based radiative transfer models, beginning at the leaf level and progressing to the canopy level.\nPlease note that this thesis does not include a systematic literature review and, as such, does not claim to be complete with respect of the modelling methods regarded. For instance, the radiative transfer models discussed in chapter 4 represent merely a small subset of the available models. Instead, the primary objective is to understand the underlying principles as well as the distinctions among the three techniques.\nThis thesis resulted in a collaboration with the Digital Agriculture Laboratory at the University of California, Davis, which is led by Dr. Alireza Pourreza. The lab’s members collected data from a Californian almond orchard prior to my involvement; however, the data was highly unstructured. Consequently, a portion of this thesis’ workload involved cleaning and pre-processing the data, which is described in detail in chapter 5.\nThe modelling stage is documented in chapter 6, and the model performance results are presented in chapter 7. An in-depth discussion regarding the model’s generalizability and other relevant topics can be found in chapter 8, with concluding remarks in chapter 9.\n\n\n\n\nABC. 2020. Growing good – almond sustainability. Almond Board of California, 1150 Ninth Street, Suite 1500, Modesto, CA95354.\n\n\nAsner, G. P., and R. E. Martin. 2009. Airborne spectranomics: Mapping canopy chemical and taxonomic diversity in tropical forests. Frontiers in Ecology and the Environment 7:269–276.\n\n\nBaret, F., V. Houlès, and M. Guerif. 2007. Quantification of plant stress using remote sensing observations and crop models: The case of nitrogen management. Journal of experimental botany 58:869–880.\n\n\nBerger, K., J. Verrelst, J.-B. Feret, Z. Wang, M. Wocher, M. Strathmann, M. Danner, W. Mauser, and T. Hank. 2020. Crop nitrogen monitoring: Recent progress and principal developments in the context of imaging spectroscopy missions. Remote Sensing of Environment 242:111758.\n\n\nBioucas-Dias, J. M., A. Plaza, G. Camps-Valls, P. Scheunders, N. Nasrabadi, and J. Chanussot. 2013. Hyperspectral remote sensing data analysis and future challenges. IEEE Geoscience and remote sensing magazine 1:6–36.\n\n\nBjerga, A., D. Cohen, and C. Hoffman. 2018. California almonds are back after four years of brutal drought. Bloomberg.\n\n\nBloem, E., S. Haneklaus, and E. Schnug. 2005. Influence of nitrogen and sulfur fertilization on the alliin content of onions and garlic. Journal of Plant Nutrition 27:1827–1839.\n\n\nBlumthaler, M., W. Ambach, and R. Ellinger. 1997. Increase in solar UV radiation with altitude. Journal of photochemistry and Photobiology B: Biology 39:130–134.\n\n\nBrown, P. H., S. Saa, S. Muhammad, and S. D. Khalsa. 2020. Nitrogen best management practices. Almond Board of California, 1150 Ninth Street, Suite 1500, Modesto, CA 95354.\n\n\nBruno, E. M., B. Goodrich, and R. J. Sexton. 2021. The outlook for california’s almond market. Calif. Almond Acreage Rep 24:9–11.\n\n\nBruno, T. J., and P. D. Svoronos. 2005. CRC handbook of fundamental spectroscopic correlation charts. CRC Press.\n\n\nByrnes, J. 2009. Unexploded ordnance detection and mitigation. Springer Science & Business Media.\n\n\nCamps-Valls, G., D. Tuia, L. Gómez-Chova, S. Jiménez, and J. Malo. 2011. Remote sensing image processing. Synthesis Lectures on Image, Video, and Multimedia Processing 5:1–192.\n\n\nCDFA. 2020. California agriculture exports 2019-2020. California Department of Food and Argiculture, 1220 N Street, Sacramento, CA 95812.\n\n\nCeres Imaging. 2022. Water stress index. Webpage.\n\n\nChapin, F. S., A. J. Bloom, C. B. Field, and R. H. Waring. 1987. Plant responses to multiple environmental factors. Bioscience 37:49–57.\n\n\nCiani, A. J., C. H. Grein, W. L. Sarney, S. P. Svensson, D. V. Donetski, and G. L. Belenky. 2020. A comparison of indium arsenide antimonide and mercury cadmium telluride as long wavelength infrared detector materials. Journal of Applied Physics 128:075704.\n\n\nde la Riva, E. G., M. Olmo, H. Poorter, J. L. Ubera, and R. Villar. 2016. Leaf mass per area (LMA) and its relationship with leaf structure and anatomy in 34 mediterranean woody species along a water availability gradient. PloS one 11:e0148788.\n\n\nDWR. 2015. California climate science and data for water resources management. California Department of Water Resources, 715 P Street Sacramento, CA 95814.\n\n\nDWR. 2022. California’s water supply strategy – adapting to a hotter, drier future. California Department of Water Resources, 715 P Street, Sacramento, CA 95814.\n\n\nDyson, M. 2021. Competing short-wavelength infra-red sensing technologies. Blog post.\n\n\nEl Masry, G., and D.-W. Sun. 2010. Principles of hyperspectral imaging technology. Pages 3–43 Hyperspectral imaging for food quality analysis and control. Elsevier.\n\n\nEvans, J. R. 1989. Photosynthesis and nitrogen relationships in leaves of C3 plants. Oecologia 78:9–19.\n\n\nFéret, J.-B., C. François, G. P. Asner, A. A. Gitelson, R. E. Martin, L. P. Bidel, S. L. Ustin, G. Le Maire, and S. Jacquemoud. 2008. PROSPECT-4 and 5: Advances in the leaf optical properties model separating photosynthetic pigments. Remote Sensing of Environment 112:3030–3043.\n\n\nFu, Y., G. Yang, Z. Li, X. Song, Z. Li, X. Xu, P. Wang, and C. Zhao. 2020. Winter wheat nitrogen status estimation using UAV-based RGB imagery and gaussian processes regression. Remote Sensing 12:3778.\n\n\nGao, B.-C., M. J. Montes, C. O. Davis, and A. F. Goetz. 2009. Atmospheric correction algorithms for hyperspectral remote sensing data of land and ocean. Remote Sensing of Environment 113:S17–S24.\n\n\nGuerrero, A., S. De Neve, and A. M. Mouazen. 2021. Current sensor technologies for in situ and on-line measurement of soil nitrogen for variable rate fertilization: A review. Advances in Agronomy 168:1–38.\n\n\nHagen, N. A., and M. W. Kudenov. 2013. Review of snapshot spectral imaging technologies. Optical Engineering 52:090901.\n\n\nHank, T. B., K. Berger, H. Bach, J. G. Clevers, A. Gitelson, P. Zarco-Tejada, and W. Mauser. 2019. Spaceborne imaging spectroscopy for sustainable agriculture: Contributions and challenges. Surveys in Geophysics 40:515–551.\n\n\nHawkesford, M., W. Horst, T. Kichey, H. Lambers, J. Schjoerring, I. S. Møller, and P. White. 2012. Functions of macronutrients. Pages 135–189 Marschner’s mineral nutrition of higher plants. Elsevier.\n\n\nHolthaus, E. 2015. 10 percent of california’s water goes to almond farming. That’s nuts.’. Slate Magazine.\n\n\nHomolová, L., Z. Malenovskỳ, J. G. Clevers, G. Garcı́a-Santos, and M. E. Schaepman. 2013. Review of optical-based remote sensing for plant trait mapping. Ecological Complexity 15:1–16.\n\n\nIhuoma, S. O., and C. A. Madramootoo. 2017. Recent advances in crop water stress detection. Computers and Electronics in Agriculture 141:267–275.\n\n\nISO. 2022. Thermal insulation — heat transfer by radiation — vocabulary. Standard, International Organization for Standardization, Geneva, CH.\n\n\nJafarbiglu, H., and A. Pourreza. 2022. A comprehensive review of remote sensing platforms, sensors, and applications in nut crops. Computers and Electronics in Agriculture 197:106844.\n\n\nJustes, E., B. Mary, J.-M. Meynard, J.-M. Machet, and L. Thelier-Huché. 1994. Determination of a critical nitrogen dilution curve for winter wheat crops. Annals of botany 74:397–407.\n\n\nKapoor, A., and T. Viraraghavan. 1997. Nitrate removal from drinking water. Journal of environmental engineering 123:371–380.\n\n\nKokaly, R. F., G. P. Asner, S. V. Ollinger, M. E. Martin, and C. A. Wessman. 2009. Characterizing canopy biochemistry from imaging spectroscopy and its application to ecosystem studies. Remote Sensing of Environment 113:S78–S91.\n\n\nMicke, W. 1996. Almond production manual. Regents of the University of California.\n\n\nMount, J., and E. Hanak. 2016. Water use in california. Public Policy Institute of California, San Francisco, California 2.\n\n\nNational Renewable Energy Laboratory. 2022. 2000 ASTM standard extraterrestrial spectrum reference e-490-00. Webpage.\n\n\nOhyama, T. 2010. Nitrogen as a major essential element of plants. Nitrogen assimilation in plants 37:2–17.\n\n\nPadilla, F. M., R. de Souza, M. T. Peña-Fleitas, M. Gallardo, C. Gimenez, and R. B. Thompson. 2018. Different responses of various chlorophyll meters to increasing nitrogen supply in sweet pepper. Frontiers in plant science 9:1752.\n\n\nPathak, T. B., M. L. Maskey, J. A. Dahlberg, F. Kearns, K. M. Bali, and D. Zaccaria. 2018. Climate change trends and impacts on california agriculture: A detailed review. Agronomy 8:25.\n\n\nPeñuelas, J., J. Gamon, A. Fredeen, J. Merino, and C. Field. 1994. Reflectance indices associated with physiological changes in nitrogen-and water-limited sunflower leaves. Remote Sensing of Environment 48:135–146.\n\n\nPierce, F. J., and P. Nowak. 1999. Aspects of precision agriculture. Advances in Agronomy 67:1–85.\n\n\nRaun, W. R., G. Johnson, and R. Westerman. 1999. Fertilizer nitrogen recovery in long-term continuous winter wheat. Soil Science Society of America Journal 63:645–650.\n\n\nRohde, R. A. 2013. Spectrum of solar radiation. Webpage.\n\n\nSchirrmann, M., A. Giebel, F. Gleiniger, M. Pflanz, J. Lentschke, and K.-H. Dammer. 2016. Monitoring agronomic parameters of winter wheat crops with low-cost UAV imagery. Remote Sensing 8:706.\n\n\nSchowengerdt, R. A. 2006. Remote sensing: Models and methods for image processing. Elsevier.\n\n\nSishodia, R. P., R. L. Ray, and S. K. Singh. 2020. Applications of remote sensing in precision agriculture: A review. Remote Sensing 12:3136.\n\n\nSmart, D., D. Schellenberg, S. Saa Silva, S. Muhammad, B. Sanden, and P. Brown. 2014. Nitrogen use efficiency of california almond orchards using advanced farming practices. Page 487 EGU general assembly conference abstracts.\n\n\nStark, C. H., and K. G. Richards. 2008. The continuing challenge of agricultural nitrogen loss to the environment in the context of global change and advancing research. Dynamic Soil, Dynamic Plant 2:1–12.\n\n\nStickler, G., and L. Kyle. 2016. Educational brief – solar radiation and the earth system. National Aeronautics and Space Administration.\n\n\nThomas, J. R., and G. F. Oerther. 1972. Estimating nitrogen content of sweet pepper leaves by reflectance measurements. Agronomy journal 64:11–13.\n\n\nUSDA. 2021. California almond acreage report. United States Department of Agriculture, Pacific Region, P.O. Box 1258, Sacramento, CA 95812.\n\n\nVerrelst, J., Z. Malenovskỳ, C. Van der Tol, G. Camps-Valls, J.-P. Gastellu-Etchegorry, P. Lewis, P. North, and J. Moreno. 2019. Quantifying vegetation biophysical variables from imaging spectroscopy data: A review on retrieval methods. Surveys in Geophysics 40:589–629.\n\n\nViers, J. H., D. Liptzin, T. S. Rosenstock, V. B. Jensen, A. D. Hollander, A. McNally, A. M. King, G. Kourakos, E. M. Lopez, N. D. L. Mora, A. FryjoffHung, H. C. Kristin N. Dzurella, S. Laybourne, C. McKenney, J. Darby, J. F. Quinn, and T. Harter. 2012. Assessing nitrate in california’s drinking water with a focus on tulare lake basin and salinas valley groundwater. Center for Watershed Sciences, University of California, Davis.\n\n\nVineView. 2022. Water index. Webpage.\n\n\nVitousek, P. M., J. D. Aber, R. W. Howarth, G. E. Likens, P. A. Matson, D. W. Schindler, W. H. Schlesinger, and D. G. Tilman. 1997. Human alteration of the global nitrogen cycle: Sources and consequences. Ecological applications 7:737–750.\n\n\nWalter, A., R. Finger, R. Huber, and N. Buchmann. 2017. Smart farming is key to developing sustainable agriculture. Proceedings of the National Academy of Sciences 114:6148–6150.\n\n\nWebb, J., P. Sørensen, G. Velthof, B. Amon, M. Pinto, L. Rodhe, E. Salomon, N. Hutchings, P. Burczyk, and J. Reid. 2013. An assessment of the variation of manure nitrogen efficiency throughout europe and an appraisal of means to increase manure-n efficiency. Advances in Agronomy 119:371–442.\n\n\nWeber, A., M. Benecke, J. Wendler, A. Sieck, D. Hübner, H. Figgemeier, and R. Breiter. 2016. Extended SWIR imaging sensors for hyperspectral imaging applications. Pages 42–56 Image sensing technologies: Materials, devices, systems, and applications III. SPIE.\n\n\nWIFSS. 2016. Almonds. Western Institute for Food Safety and Security, 1477 Drew Ave, Davis, CA 95618.\n\n\nWolfert, S., L. Ge, C. Verdouw, and M.-J. Bogaardt. 2017. Big data in smart farming–a review. Agricultural Systems 153:69–80.\n\n\nWright, I. J., P. B. Reich, M. Westoby, D. D. Ackerly, Z. Baruch, F. Bongers, J. Cavender-Bares, T. Chapin, J. H. Cornelissen, M. Diemer, and others. 2004. The worldwide leaf economics spectrum. Nature 428:821–827.\n\n\nYang, X., X. Wu, H. Hao, and Z. He. 2008. Mechanisms and assessment of water eutrophication. Journal of zhejiang university Science B 9:197–209.\n\n\nYokoya, N., and A. Iwasaki. 2013. Hyperspectral and multispectral data fusion mission on hyperspectral imager suite (HISUI). Pages 4086–4089 2013 IEEE international geoscience and remote sensing symposium-IGARSS. IEEE.\n\n\nZhang, N., M. Wang, and N. Wang. 2002. Precision agriculture—a worldwide overview. Computers and electronics in agriculture 36:113–132.\n\n\nZhang, Z., Y. Jin, B. Chen, and P. Brown. 2019. California almond yield prediction at the orchard level with a machine learning approach. Frontiers in plant science 10:809.\n\n\nZheng, H., T. Cheng, D. Li, X. Zhou, X. Yao, Y. Tian, W. Cao, and Y. Zhu. 2018. Evaluation of RGB, color-infrared and multispectral images acquired from unmanned aerial systems for the estimation of nitrogen accumulation in rice. Remote Sensing 10:824."
  },
  {
    "objectID": "vegetation-indices-based-methods.html#evolution-of-vegetation-indices-and-their-limitations",
    "href": "vegetation-indices-based-methods.html#evolution-of-vegetation-indices-and-their-limitations",
    "title": "2  Vegetation-indices-based methods",
    "section": "2.1 Evolution of vegetation indices and their limitations",
    "text": "2.1 Evolution of vegetation indices and their limitations\nHistorically, one of the very first vegetation indices developed was the simple ratio index (RVI). It was proposed by Jordan (1969).\n\\[\\text{RVI} = \\frac{\\rho_\\text{R}}{\\rho_\\text{NIR}} \\tag{2.1}\\]\nIn this and the following equations, \\(\\rho_\\text{R}\\) stands for the red band reflectance, whereas \\(\\rho_\\text{NIR}\\) stands for the near-infrared band reflectance. Not too soon after introduction of the RVI, Rouse Jr et al. (1973) proposed the normalized difference vegetation index (NDVI), which until today remains the most widely used vegetation index (Xue and Su 2017).\n\\[\\text{NDVI} = \\frac{\\rho_\\text{NIR}-\\rho_\\text{R}}{\\rho_\\text{NIR}+\\rho_\\text{R}} \\tag{2.2}\\]\nCompared to the RVI, the NDVI is normalized between the values of −1 and +1. It is quite sensitive to green vegetation, even in sparsely covered areas. However, the NDVI is also influenced by soil colour, brightness, and shadows cast by canopy and clouds, which are undesirable traits for a vegetation index, as it should ideally be affected solely by the presence of vegetation (Xue and Su 2017). Consequently, numerous vegetation indices have been developed subsequent to the NDVI, aiming to address its limitations and incorporate atmospheric corrections (Kaufman and Tanre 1992, Ren-hua et al. 1996) or adjustments for soil colour and brightness (Richardson and Wiegand 1977, Huete 1988, Baret et al. 1993, Qi et al. 1994). A recent review by Xue and Su (2017) examined over one hundred vegetation indices, with many specifically targeting the shortcomings of the NDVI. The authors discovered that, in various specific scenarios — considering factors such as a particular crop, soil type, and atmospheric conditions — certain vegetation indices demonstrated superior performance over others.\nEarly development of vegetation indices primarily relied on bands frequently captured by multispectral cameras, such as red, red edge, and near-infrared wavelengths (Chlingaryan et al. 2018). Blue bands were rarely employed, as blue light is more susceptible to atmospheric scattering, which can introduce greater uncertainty in measurements — an aspect of particular significance in satellite-based remote sensing applications. However, the advent of hyperspectral imaging has ushered in the creation of vegetation indices tailored to very specific narrow bands, expanding the capabilities of these tools — but at the same time massively increasing the risk of over-fitting (Thenkabail et al. 2013).\nIn the end, relationships between vegetation indices and the trait of interest are purely empirical in nature. Typically, data on the plant trait is collected, and various vegetation indices are tested to determine the ones that correlate well with it. This approach can be critiqued as being somewhat unscientific, as it relies more on coincidentally found correlations than on fundamental principles or theories.\nAtzberger et al. (2011) explicitly outlines five disadvantages associated with using vegetation indices-based methods for crop nitrogen estimation. The first disadvantage is the inverse problem, wherein high-dimensional data is reduced to a single value, which could potentially be derived from varying forms of reflectance. The second drawback involves the partial exploitation of multi- or hyperspectral data, as only a limited number of spectral bands are utilized. This issue is especially relevant to narrow-band vegetation indices, which may also be affected by measurement noise. The third challenge concerns the lack of transferability in the calibration of vegetation indices to specific sensors, as it does not extend to instruments with different characteristics. The fourth issue relates to overfitting, implying that vegetation index-based nitrogen models may be tailored too specifically to the dataset used for model calibration. This can lead to sensitivity regarding crop type, growth stage, underlying soil type, sun-sensor constellation, as well as time and date. Finally, the fifth drawback highlights the need to collect in situ reference data for model establishment, which demands manpower, instrument availability, and therefore imposes a high financial burden on the development.\nDespite this criticism, new vegetation indices keep being proposed in the scientific literature. Some of the drawbacks of vegetation indices are addressed by the usage of radiative transfer models: Synthetic data sets are generated, where new vegetation indices aim to correlate with the parameter used to generate the respective data sets (Hunt Jr et al. 2013). For example, the radiative transfer model Prosail has been used to design new vegetation indices (Cheng et al. 2014, Jin et al. 2014). This search for new vegetation indices is sometimes even implemented algorithmically, for example by the adoption of = algorithms (Costa et al. 2020)."
  },
  {
    "objectID": "vegetation-indices-based-methods.html#sec-nitrogenVI",
    "href": "vegetation-indices-based-methods.html#sec-nitrogenVI",
    "title": "2  Vegetation-indices-based methods",
    "section": "2.2 Nitrogen monitoring with vegetation indices",
    "text": "2.2 Nitrogen monitoring with vegetation indices\nVegetation indices represent the most prevalent method for remote detection of crop nitrogen content (Berger et al. 2020). Numerous indices have been intentionally designed to estimate crop nitrogen, while others have simply been found to correlate with it (Herrmann et al. 2010). These indices mostly capitalize on the correlation between crop nitrogen and chlorophyll content (Baret et al. 2007). For instance, the transformed chlorophyll absorption in reflectance index (TCARI) has demonstrated a strong correlation with chlorophyll (Cui and Zhou 2017). Some of the most notable vegetation indices employed for crop nitrogen detection can be found in table 2.1.\n\n\n\nTable 2.1: Overview of various vegetation indices that were used to estimate foliar nitrogen concentrations. \\(\\rho_\\lambda\\) for the reflectance at a specific wavelength \\(\\lambda\\) (\\(\\rho_{530}\\) = green band, \\(\\rho_{685}\\) = red band, \\(\\rho_{720}\\) = red edge, \\(\\rho_{790}\\) = near-infrared). This table was adapted from Herrmann et al. (2010) and Tian et al. (2011).\n\n\n\n\n\n\n\nIndex\nFormula\nAuthor\n\n\n\n\nNormalised Difference Vegetation Index (NDVI)\n\\[\\frac{\\rho_{\\text{790}}-\\rho_{\\text{685}}}{\\rho_{\\text{790}}+\\rho_{\\text{685}}}\\]\nRouse Jr et al. (1973)\n\n\nNormalized Difference Red Edge (NDRE)\n\\[\\frac{\\rho_{790} - \\rho_{720}}{\\rho_{790} + \\rho_{720}}\\]\nBarnes et al. (2000)\n\n\nModified Chlorophyll Absorption in Reflectance Index (MCARI)\n\\[\\frac{\\rho_{700}}{\\rho_{670}} \\left[ 0.8 \\cdot \\rho_{700} - \\rho_{670} - 0.2 \\cdot \\rho_{550} \\right]\\]\nDaughtry et al. (2000)\n\n\nTransformed Chlorophyll Absorption in Reflectance Index (TCARI)\n\\[3 \\left[ \\rho_{700} - \\rho_{670} - \\frac{0.2\\cdot\\rho_{700}}{\\rho_{670}} \\left(\\rho_{700} - \\rho_{550} \\right) \\right]\\]\nHaboudane et al. (2002)\n\n\nGreen Chlorophyll Index (GCI)\n\\[\\frac{\\rho_{\\text{790}}}{\\rho_{530}}-1\\]\nGitelson et al. (2003)\n\n\nRed Edge Chlorophyll Index (RECI)\n\\[\\frac{\\rho_{\\text{790}}}{\\rho_{\\text{720}}}-1\\]\nGitelson et al. (2003)\n\n\nGreen Normalised Difference Vegetation Index (GNDVI)\n\\[\\frac{\\rho_{\\text{790}}-\\rho_{530}}{\\rho_{\\text{790}}+\\rho_{530}}\\]\nGitelson et al. (1996)\n\n\nEnhanced Vegetation Index (EVI)\n\\[\\frac{\\frac{5}{2}(\\rho_{\\text{790}} - \\rho_{\\text{720}})}{\\rho_{\\text{790}} + 6 \\ \\rho_{\\text{720}} + \\frac{15}{2} \\rho_{\\text{470}} + 1}\\]\nHuete et al. (2002)\n\n\nWide Dynamic Range Vegetation Index (WDRVI)\n\\[\\frac{\\alpha \\rho_{\\text{790}}-\\rho_{\\text{720}}}{\\alpha \\rho_{\\text{790}}+\\rho_{\\text{720}}}\\]\nGitelson (2004)\n\n\nNormalized Difference Nitrogen Index (NDNI)\n\\[\\frac{\\log_{10} \\rho_{1510}^{-1} - \\log_{10} \\rho_{1680}^{-1}}{\\log_{10} \\rho_{1510}^{-1} + \\log_{10} \\rho_{1680}^{-1}}\\]\nSerrano et al. (2002)\n\n\nR434\n\\[\\frac{\\rho_{\\text{434}}}{\\rho_{\\text{496}} - \\rho_{\\text{401}}}\\]\nTian et al. (2011)\n\n\n\n\n\nBut how exactly is a regression model employing vegetation indices constructed? The utilization of vegetation indices on multi- or hyperspectral data results in a dimensionality reduction of the original data. While the initial data possesses multiple dimensions, vegetation indices are one-dimensional. Ideally, a vegetation index employed for crop nitrogen monitoring correlates more strongly with crop nitrogen than any individual band. However, the index itself lacks a unit and, as a consequence, cannot be used directly to estimate crop nitrogen. Therefore, any vegetation index must be linked to the trait of interest \\(y\\) through a connecting function \\(f\\) — a so-called link function.\n\\[f: g(\\mathbf x) \\rightarrow y \\tag{2.3}\\]\nIn this case, \\(g(\\mathbf x)\\) represents the vegetation index applied to the spectral data. Typically, a simple linear regression is employed to identify the linking function \\(f\\). Nevertheless, \\(f\\) could represent any function and might even accept multiple vegetation indices as inputs. For instance, Johnson et al. (2016) found that a multiple linear regression model yielded better predictions based on multiple vegetation indices than relying on a single vegetation index at a time.\nThe linking function \\(f\\) could even take the form of a more flexible machine learning model able to represent intricate interactions, such as a random forest or support vector machines (Sonobe et al. 2018). This practice, however, raises the question of the necessity for vegetation indices in the first place. Machine learning models can be applied directly to the data, enabling the direct selection of relevant features. One could, so to say, “cut out the middleman”. This effectively eliminates several of the issues addressed by Atzberger et al. (2011). Hence, the application of machine learning algorithms to hyperspectral data in order to estimate crop nitrogen will be the focus of the next chapter.\n\n\n\n\nAtzberger, C., K. Richter, F. Vuolo, R. Darvishzadeh, and M. Schlerf. 2011. Why confining to vegetation indices? Exploiting the potential of improved spectral observations using radiative transfer models. Pages 263–278 Remote sensing for agriculture, ecosystems, and hydrology XIII. SPIE.\n\n\nBaret, F., V. Houlès, and M. Guerif. 2007. Quantification of plant stress using remote sensing observations and crop models: The case of nitrogen management. Journal of experimental botany 58:869–880.\n\n\nBaret, F., S. Jacquemoud, and J. Hanocq. 1993. The soil line concept in remote sensing. Remote Sensing Reviews 7:65–82.\n\n\nBarnes, E., T. Clarke, S. Richards, P. Colaizzi, J. Haberland, M. Kostrzewski, P. Waller, C. Choi, E. Riley, T. Thompson, and others. 2000. Coincident detection of crop water stress, nitrogen status and canopy density using ground based multispectral data. Page 6 Proceedings of the fifth international conference on precision agriculture, bloomington, MN, USA.\n\n\nBerger, K., J. Verrelst, J.-B. Feret, Z. Wang, M. Wocher, M. Strathmann, M. Danner, W. Mauser, and T. Hank. 2020. Crop nitrogen monitoring: Recent progress and principal developments in the context of imaging spectroscopy missions. Remote Sensing of Environment 242:111758.\n\n\nCheng, X., G. Yang, X. Xu, T. Chen, Z. Li, H. Feng, D. Wang, and others. 2014. Estimating canopy water content in wheat based on new vegetation water index. Spectroscopy and Spectral Analysis 34:3391–3396.\n\n\nChlingaryan, A., S. Sukkarieh, and B. Whelan. 2018. Machine learning approaches for crop yield prediction and nitrogen status estimation in precision agriculture: A review. Computers and Electronics in Agriculture 151:61–69.\n\n\nCosta, L., L. Nunes, and Y. Ampatzidis. 2020. A new visible band index (vNDVI) for estimating NDVI values on RGB images utilizing genetic algorithms. Computers and Electronics in Agriculture 172:105334.\n\n\nCui, S., and K. Zhou. 2017. A comparison of the predictive potential of various vegetation indices for leaf chlorophyll content. Earth Science Informatics 10:169–181.\n\n\nDaughtry, C. S., C. Walthall, M. Kim, E. B. De Colstoun, and J. McMurtrey Iii. 2000. Estimating corn leaf chlorophyll concentration from leaf and canopy reflectance. Remote Sensing of Environment 74:229–239.\n\n\nGitelson, A. A. 2004. Wide dynamic range vegetation index for remote quantification of biophysical characteristics of vegetation. Journal of Plant Physiology 161:165–173.\n\n\nGitelson, A. A., Y. Gritz, and M. N. Merzlyak. 2003. Relationships between leaf chlorophyll content and spectral reflectance and algorithms for non-destructive chlorophyll assessment in higher plant leaves. Journal of Plant Physiology 160:271–282.\n\n\nGitelson, A. A., Y. J. Kaufman, and M. N. Merzlyak. 1996. Use of a green channel in remote sensing of global vegetation from EOS-MODIS. Remote Sensing of Environment 58:289–298.\n\n\nHaboudane, D., J. R. Miller, N. Tremblay, P. J. Zarco-Tejada, and L. Dextraze. 2002. Integrated narrow-band vegetation indices for prediction of crop chlorophyll content for application to precision agriculture. Remote Sensing of Environment 81:416–426.\n\n\nHerrmann, I., A. Karnieli, D. Bonfil, Y. Cohen, and V. Alchanatis. 2010. SWIR-based spectral indices for assessing nitrogen content in potato fields. International Journal of Remote Sensing 31:5127–5143.\n\n\nHuete, A. R. 1988. A soil-adjusted vegetation index (SAVI). Remote Sensing of Environment 25:295–309.\n\n\nHuete, A., K. Didan, T. Miura, E. P. Rodriguez, X. Gao, and L. G. Ferreira. 2002. Overview of the radiometric and biophysical performance of the MODIS vegetation indices. Remote Sensing of Environment 83:195–213.\n\n\nHunt Jr, E. R., P. C. Doraiswamy, J. E. McMurtrey, C. S. Daughtry, E. M. Perry, and B. Akhmedov. 2013. A visible band index for remote sensing leaf chlorophyll content at the canopy scale. International journal of applied earth observation and geoinformation 21:103–112.\n\n\nJackson, R. D., S. Idso, R. Reginato, and P. Pinter Jr. 1981. Canopy temperature as a crop water stress indicator. Water resources research 17:1133–1138.\n\n\nJin, X., Z. Li, H. Feng, X. Xu, and G. Yang. 2014. Newly combined spectral indices to improve estimation of total leaf chlorophyll content in cotton. IEEE Journal of Selected Topics in Applied Earth Observations and Remote Sensing 7:4589–4600.\n\n\nJohnson, M. D., W. W. Hsieh, A. J. Cannon, A. Davidson, and F. Bédard. 2016. Crop yield forecasting on the canadian prairies by remotely sensed vegetation indices and machine learning methods. Agricultural and forest meteorology 218:74–84.\n\n\nJordan, C. F. 1969. Derivation of leaf-area index from quality of light on the forest floor. Ecology 50:663–666.\n\n\nKaufman, Y. J., and D. Tanre. 1992. Atmospherically resistant vegetation index (ARVI) for EOS-MODIS. IEEE Transactions on Geoscience and Remote Sensing 30:261–270.\n\n\nQi, J., A. Chehbouni, A. R. Huete, Y. H. Kerr, and S. Sorooshian. 1994. A modified soil adjusted vegetation index. Remote Sensing of Environment 48:119–126.\n\n\nRen-hua, Z., N. Rao, and K. Liao. 1996. Approach for a vegetation index resistant to atmospheric effect. Journal of Integrative Plant Biology 38.\n\n\nRichardson, A. J., and C. Wiegand. 1977. Distinguishing vegetation from soil background information. Photogrammetric engineering and remote sensing 43:1541–1552.\n\n\nRouse Jr, J. W., R. H. Haas, J. Schell, and D. Deering. 1973. Monitoring the vernal advancement and retrogradation (green wave effect) of natural vegetation. Texas A&M University Remote Sensing Center.\n\n\nSerrano, L., J. Penuelas, and S. L. Ustin. 2002. Remote sensing of nitrogen and lignin in mediterranean vegetation from AVIRIS data: Decomposing biochemical from structural signals. Remote sensing of Environment 81:355–364.\n\n\nSishodia, R. P., R. L. Ray, and S. K. Singh. 2020. Applications of remote sensing in precision agriculture: A review. Remote Sensing 12:3136.\n\n\nSonobe, R., Y. Yamaya, H. Tani, X. Wang, N. Kobayashi, and K. Mochizuki. 2018. Crop classification from sentinel-2-derived vegetation indices using ensemble learning. Journal of Applied Remote Sensing 12:026019–026019.\n\n\nThenkabail, P. S., I. Mariotto, M. K. Gumma, E. M. Middleton, D. R. Landis, and K. F. Huemmrich. 2013. Selection of hyperspectral narrowbands (HNBs) and composition of hyperspectral twoband vegetation indices (HVIs) for biophysical characterization and discrimination of crop types using field reflectance and hyperion/EO-1 data. IEEE Journal of Selected Topics in Applied Earth Observations and Remote Sensing 6:427–439.\n\n\nTian, Y., X. Yao, J. Yang, W. Cao, D. Hannaway, and Y. Zhu. 2011. Assessing newly developed and published vegetation indices for estimating rice leaf nitrogen concentration with ground-and space-based hyperspectral reflectance. Field Crops Research 120:299–310.\n\n\nXue, J., and B. Su. 2017. Significant remote sensing vegetation indices: A review of developments and applications. Journal of sensors 2017:1–17.\n\n\nZheng, G., and M. Moskal. 2009. Retrieving leaf area index (LAI) using remote sensing: Theories, methods and sensors. Sensors 9:2719–2745."
  },
  {
    "objectID": "machine-learning-methods-for-hyperspectral-data-analysis.html#sec-stepwise",
    "href": "machine-learning-methods-for-hyperspectral-data-analysis.html#sec-stepwise",
    "title": "3  Machine learning methods for hyperspectral data analysis",
    "section": "3.1 Ordinary least squares and stepwise selection",
    "text": "3.1 Ordinary least squares and stepwise selection\nThe simplest and also probably most prevalently used machine learning model is the linear regression model (Yan and Su 2009). In its univariate form, it can be represented as follows.\n\\[\\mathbf y = \\mathbf X \\boldsymbol \\beta + \\boldsymbol \\varepsilon \\tag{3.1}\\]\nHere, \\(\\mathbf y\\) represents the labels, \\(\\mathbf X\\) denotes the design matrix comprising all predictors, \\(\\boldsymbol \\beta\\) signifies the coefficients, and \\(\\boldsymbol \\varepsilon\\) corresponds to the model’s errors. The customary approach for estimating the coefficients \\({\\boldsymbol \\beta}\\) in equation 3.1 employs the analytical solution using the ordinary least squares estimator.\n\\[\\hat {\\boldsymbol \\beta} = (\\mathbf X^\\top\\mathbf X)^{-1} \\mathbf X^\\top \\mathbf y \\tag{3.2}\\]\nThis method was (allegedly) introduced independently by Legendre (1806) in Nouvelles méthodes pour la détermination des orbites des comètes (new methods for the determination of comet orbits) and Gauss (1809) in Theoria Motus Corporum Coelestium (theory of the motion of the heavenly bodies), eventually being formalized at a later date by Markov (1912). However, it is worth noting that Markov did not contribute any novel proof (Plackett 1949, Yan and Su 2009).\nIn what is now known as the Gauss-Markov theorem, Markov asserts that the ordinary least squares estimator is the best linear unbiased estimator under the specific conditions that the error’s expectation is zero (\\(\\mathbb E(\\varepsilon_i) = 0\\)), the error exhibits equal variance (\\(\\text{Var}(\\varepsilon_i) = \\sigma^2\\)), and all distinct error terms are uncorrelated (\\(\\text{Cov}(\\varepsilon_i, \\varepsilon_j) = 0\\)).\nUnprocessed hyperspectral reflectance data frequently violates the assumptions of the Gauss-Markov theorem — particularly the third assumption regarding uncorrelated errors. While equal variance can be achieved through z-score normalization (a technique described in more detail in section 5.4), and the expectation of zero error might be satisfied if the response is investigated on a small enough scale, the assumption of uncorrelated error terms cannot be fulfilled while retaining all available variables or information about all bands. The crux of the problem lies in so-called multicollinearity: the reflectance of neighbouring spectral bands is typically very strongly correlated. Consequently, the reflectance at one band can be predicted linearly from others with a very high precision (Chlingaryan et al. 2018). Because of multicollinearity, minor changes in the data or model specification can have a disproportional effect on parameter estimates (Ravikanth et al. 2017).\nOrdinary least squares also encounter difficulties in hyperspectral data analysis due to the small n, large p problem. In many agricultural applications of hyperspectral data, there is often a limit to the number of samples taken, since the acquisition of observations can be both costly and labour-intensive (Ravikanth et al. 2017). When the design matrix \\(\\mathbf X\\) has fewer rows (observations, \\(n\\)) than columns (parameters, \\(p\\)), the inversion of \\(\\mathbf X^\\top\\mathbf X\\) in equation 3.2 becomes impossible.\nIf one wanted to strictly stick to linear regression using ordinary least squares, a potential workaround evading the small n, large p problem would be the application of a prior feature selection strategy to tackle multicollinearity (remember, vegetation indices as discussed in the chapter before essentially constituted such a feature selection method). Provided that there are more observations than parameters to estimate, feature selection methods like stepwise selection can also further create a subset of variables for the linear regression model such that it is no longer over-specified. These methods minimize a so-called information criterion. This metric balances both the model’s likelihood and penalizes over-parametrization simultaneously. The Akaike information criterion (AIC), introduced by Akaike (1998), serves as one such criterion for comparing the fit of various regression models. It can be calculated as follows.\n\\[\\text{AIC} = k(p - \\ln \\hat {L}) \\tag{3.3}\\]\nIn this equation, \\(p\\) represents the number of parameters, \\(k\\) is a scalar, and \\(\\ln \\hat {L}\\) denotes the estimated log-likelihood of the model. A true AIC is obtained when \\(k=2\\), while \\(k=\\ln(n)\\) (where \\(n\\) is the number of observations) is sometimes called the Bayesian information criterion (BIC) or Schwarz information criterion (SIC). Through stepwise selection, variables are iteratively added to and removed from the model so as to minimize the information criterion.\nA practical application of this approach can be seen in the research conducted by Castaldi et al. (2016). The authors focused on predicting wheat grain nitrogen uptake from satellite data. To identify a suitable subset of spectral bands, they executed a stepwise selection process on the variables of a multiple linear regression model.\nHowever, the application of stepwise selection to hyperspectral data has faced substantial criticism (Bolster et al. 1996, Grossman et al. 1996). The key issue is that its performance markedly declines as the number of utilized bands increases. When dealing with a too large number of variables, stepwise selection begins to select a seemingly random subset of bands for linear regression, which subsequently results in overfitting (Hastie et al. 2017). In situations where a linear regression model incorporating more than a handful of bands is sought, regularization of the model may prove to be a more suitable solution."
  },
  {
    "objectID": "machine-learning-methods-for-hyperspectral-data-analysis.html#sec-regularization",
    "href": "machine-learning-methods-for-hyperspectral-data-analysis.html#sec-regularization",
    "title": "3  Machine learning methods for hyperspectral data analysis",
    "section": "3.2 Regularization",
    "text": "3.2 Regularization\nRegularization is a technique extensively employed in machine learning in order to avoid overfitting and enhance the generalization of models. Applicable to linear models as well as more intricate ones, such as neural networks or decision-tree-based models, regularization operates by adding a penalty term to the original, unregularized cost function \\(J\\), which in turn penalizes the magnitude of the estimated coefficient. Consequently, larger coefficient estimates lead to a greater penalty (James et al. 2013). This process forces the regression model to strike a balance between small (or few) coefficients and an effective explanation of the data. In that sense, regularization can be understood as Occam’s Razor2 applied to machine learning models, favouring simpler models over their more complex counterparts — even if the more complex ones could better explain the data. The underlying reasoning for this approach is that, when given enough flexibility, models inherently tend to over-explain the data. As a countermeasure, regularization restricts some of that flexibility, promoting a more balanced model.2 Occam’s razor is a philosophical principle that suggests that, among competing hypotheses, the simplest one with the fewest assumptions is preferable or more likely to be true (Van den Berg 2018).\nThe penalty term is typically based on various vector norms of the model coefficients, such as the \\(\\ell^1\\)-norm (referred to as lasso regularization) or the \\(\\ell^2\\)-norm (known as ridge regularization). The cost function \\(J\\) for both lasso and ridge regression can be expressed in a single equation as follows.\n\\[J(\\boldsymbol \\beta, \\mathbf X, \\mathbf y) =\n\\| \\mathbf {y -X\\boldsymbol\\beta} \\|_2^2 +\n\\lambda \\left[ \\frac{1}{2}(1-\\alpha)\\| \\boldsymbol \\beta \\|_2^2 + \\alpha \\| \\boldsymbol \\beta \\| \\right] \\tag{3.4}\\]\nHere, \\(\\| \\cdot \\|\\) represents the absolute value norm or the \\(\\ell^1\\)-norm, while \\(\\| \\cdot \\|_2\\) denotes the Euclidean norm or the \\(\\ell^2\\)-norm. It is worth noting that the first term in equation 3.4 (\\(\\| \\mathbf {y -X\\boldsymbol\\beta} \\|_2^2\\)) is simply the standard cost function for linear least squares regression, as it equates to the sum of squared errors. The second half constitutes the penalty term that regularizes the coefficients. The parameter \\(\\lambda\\) determines the magnitude of the penalty, as it is multiplied by a mixture of norms of the coefficient vector \\(\\boldsymbol \\beta\\). If one exclusively selects \\(\\alpha = 0\\), that results in ridge regression, since only the \\(\\ell^2\\)-norm is employed. Conversely, choosing \\(\\alpha = 1\\) relies solely on the \\(\\ell^1\\)-norm, resulting in lasso regression. Any value between \\(0 &lt; \\alpha &lt; 1\\) yields a combination of the two, referred to as the elastic net (Zou and Hastie 2005, James et al. 2013). Consequently, we can regard \\(\\lambda \\in [0, \\infty)\\) as a parameter controlling the penalty’s magnitude and \\(\\alpha \\in [0,1]\\) as a parameter directing the type of regularization applied.\nIn general, regularization aids in mitigating multicollinearity issues, consequently reducing the variance of coefficient estimates. Ridge regression, based on the Euclidean norm, progressively decreases the penalty on coefficient estimates as they approach zero. This means, that for ridge regression, the variables in the model will always exert an effect, albeit a tiny one in the case of useless variables.\nLasso regression on the other hand, initially introduced by Tibshirani (1996), begins to induce sparsity in the data matrix as \\(\\lambda\\) increases (James et al. 2013). This property means that lasso regression leads to a selection of variables that effectively explain the response. Unlike stepwise selection, lasso regression does not suffer from a high number of simultaneously used variables (Hastie et al. 2017). Lasso regression emerges as a particularly appealing tool for hyperspectral data analysis, as it facilitates the selection of a limited number of bands that best explain the response variable (Takayama and Iwasaki 2016).\nThe number of selected bands can be effectively controlled via \\(\\lambda\\). Lasso regression has already been employed for spectral band selection in spectroradiometric leaf-level data, specifically in the context of foliar nitrogen prediction in vineyards (Omidi et al. 2020)."
  },
  {
    "objectID": "machine-learning-methods-for-hyperspectral-data-analysis.html#sec-dimensionalityreduction",
    "href": "machine-learning-methods-for-hyperspectral-data-analysis.html#sec-dimensionalityreduction",
    "title": "3  Machine learning methods for hyperspectral data analysis",
    "section": "3.3 Dimensionality reduction regression",
    "text": "3.3 Dimensionality reduction regression\nThus far, the focus has been on regression methods that address multicollinearity and the small \\(n\\), large \\(p\\) problem by selecting features, penalizing coefficients, or both, as in the case of lasso regression. An alternative approach to tackling these issues involves formulating the regression after applying a dimensionality reduction technique. Principal component regression (PCR) and partial least squares regression (PLSR) stand out as the two most prominent methods for achieving this. Partial least squares, originally introduced by Wold et al. (1984), is particularly prevalent in chemometrics, even though it was initially introduction as an econometric tool for addressing multicollinearity (Geladi and Kowalski 1986, Mehmood and Ahmed 2016).\nThe two related methods can be mathematically expressed in a similar manner. Any design matrix \\(\\mathbf X\\) containing the original data can be represented by its score matrix \\(\\mathbf T\\).\n\\[\\mathbf T = \\mathbf{XW} \\tag{3.5}\\]\nHere, \\(\\mathbf W\\) is a \\(p \\times p\\) rotation matrix of weights. In the case of principal component analysis (PCA), the columns of \\(\\mathbf W\\) are the eigenvectors of \\(\\text{Cov}(\\mathbf X)\\). The full matrix \\(\\mathbf T\\) is thus a linear re-combination of \\(\\mathbf X\\), but it conveniently contains maximal information in its first column, with the remaining information successively distributed in subsequent columns. The constructed variables in the score matrix, called principal components, are completely uncorrelated with each other. These principal components, also referred to as latent variables, are not directly measured but are constructed from the observed variables.\nThe lack of multicollinearity among the latent variables in the score matrix makes them better suited for ordinary least squares regression than the observed data. The more collinear the original data, the fewer principal components are needed to capture the essence of the data. This effectively eliminates the small \\(n\\), large \\(p\\) problem. After performing linear dimensionality reduction on \\(\\mathbf X\\), linear regression can be applied to a limited number of variables in the score matrix \\(\\mathbf T\\) to avoid overfitting issues typically associated with stepwise selection (Grossman et al. 1996, Hansen and Schjoerring 2003). Both principal component and partial least squares regression can thus be formulated as follows.\n\\[\\mathbf y = \\mathbf T_{[1,l]} \\: \\boldsymbol \\beta + \\boldsymbol \\varepsilon \\tag{3.6}\\]\nHere, \\(l\\) is the number of variables from \\(\\mathbf T\\) used for the regression, and the rest is analogous to equation 3.1. The difference between principal component and partial least square regression lies in how the score matrix \\(\\mathbf T\\) and the rotation matrix \\(\\mathbf W\\) are estimated. In principal component regression, a principal component analysis is performed without considering the response \\(\\mathbf y\\), but instead maximizing the variance in the columns of the score matrix \\(\\mathbf T\\) successively. However, this strategy could theoretically find principal components which explain maximal variance in the data, but do not in fact correlate with the labels (Geladi and Kowalski 1986).\nPartial least squares regression, introduced by Wold et al. (1984), addresses this issue by informing the estimation of the rotation matrix with both the labels and the data at the same time, thus maximizing the predictive power of the latent variables. Specifically, partial least squares estimate \\(\\mathbf W\\) to maximize the covariance between \\(\\mathbf y\\) and \\(\\mathbf T\\):\n\\[\\mathbf W = \\arg \\max_{\\mathbf W} \\left\\{ \\text{Cov} \\left( \\mathbf y, \\mathbf {XW} \\right) \\right\\} \\qquad\\text{s.t. } \\mathbf W ^\\top \\mathbf W = \\mathbf I \\tag{3.7}\\]\nIn this equation, \\(\\mathbf I\\) represents the identity matrix (Bennett and Embrechts 2003). Note that equation 3.7 describes the maximization task for univariate partial least squares, applicable to cases with a single response variable, although the model can also be applied to multivariate cases, where a rotation matrix is found to maximize the covariance of the principal components with respect to multiple responses simultaneously.\nIn summary, principal component regression maximizes the variance of the principal components with respect to \\(\\mathbf X\\) and subsequently performs a regression on \\(\\mathbf y\\). In contrast, partial least squares regression maximizes the covariance between the components \\(\\mathbf T\\) and the independent variable \\(\\mathbf y\\). Therefore, if the primary goal is to make predictions using linear regression analysis, partial least squares regression is generally a better alternative compared to principal component regression (Inoue et al. 2012, Liu et al. 2022).\nDue to these properties, partial least squares regression is an excellent method for predicting a response based on hyperspectral data. It is also the most widely tested model for predicting crop nitrogen (Berger et al. 2020). For instance, partial least squares were successfully used by Wang et al. (2017) to predict nitrogen in leaves from pear trees, with a validation R2 value of 0.85.\nHowever, there are two major weaknesses to the partial least squares approach when it comes to hyperspectral data that must be considered. First, the regression method utilizes the entire spectrum of the original variables to construct the latent variables. While this can provide some insights into which bands are more explanatory for the response, it is not as straightforward as other methods for selecting a minimum number of relevant bands that can adequately explain the response. Band selection via partial least squares requires additional analysis of the model (Mehmood and Ahmed 2016). Second, partial least squares regression is inherently linear in nature. As a result, despite its powerful capabilities in modelling linear relationships, it may fail to capture complex, non-linear relationships present in the data — relationships that are known to exist between the foliar nitrogen concentration and the leaf’s reflectance.\nWhen the underlying structure of the data is strongly non-linear, principal component and partial least squares regression may not produce satisfactory results. In such cases, their kernelized counterparts can be explored, which allow for non-linear dimensionality reduction before the regression stage (Rosipal and Krämer 2006). Alternatively, other machine learning techniques, such as decision-tree-based models, Gaussian process regression, support vector regression, or artificial neural networks, might be more appropriate for modelling intrinsically non-linear relationships."
  },
  {
    "objectID": "machine-learning-methods-for-hyperspectral-data-analysis.html#sec-decisiontrees",
    "href": "machine-learning-methods-for-hyperspectral-data-analysis.html#sec-decisiontrees",
    "title": "3  Machine learning methods for hyperspectral data analysis",
    "section": "3.4 Decision-tree-based learning",
    "text": "3.4 Decision-tree-based learning\nDecision-tree-based methods are vastly different from the machine learning algorithms examined thus far. A decision tree can be constructed by recursively partitioning the data into subsets based on the values of individual features, and then establishing individual rules for the created subsets. The paths in these trees are called branches, and the terminal nodes are called leaves (James et al. 2013). Decision trees can be employed for both classification and regression; however, since the focus of this thesis is the prediction of foliar nitrogen concentration, the discussion will centre on regression trees. Decision-tree-based learning has been widely utilized in various applications, including remote sensing applications for nitrogen detection (Chlingaryan et al. 2018).\nWhen used individually, decision trees often either overfit the data or fail to effectively approximate the underlying function. However, their power is significantly enhanced when employed in ensemble learning, which combines multiple trees to improve performance. Two popular ensemble methods include bagging, where trees are trained on randomly selected subsets of the data, and boosting, where trees are iteratively trained to correct the errors of their predecessors (James et al. 2013).\nOne of the most prevalent bagging methods is random forests, a model introduced by Breiman (2001). Each tree within a random forest is trained on only a subset of the observations and a limited number of variables, which allows less informative variables to influence the outcome as well. Predictions made by a random forest are simply the mean of all individual predictions of decision trees (James et al. 2013). Random forests have been employed by Jin et al. (2020) due to their exceptional capability of handling non-linear relationships in order to determine which variables are essential for yield determination in Californian almonds.\nAs an alternative to bagging and random forests, the technique of boosting combines multiple weak learners, which are decision trees that perform only slightly better than random guessing, into a robust model capable of making accurate predictions (James et al. 2013). The key aspect of this approach is that weak learners are fitted sequentially, with new trees attempting to reduce the error of their predecessors. Consequently, subsequent learners focus on the aspects that previous learners failed to capture. The final model is a weighted sum of the individual weak learners, with the weights determined by each learner’s relative performance. One of the latest examples of boosting is the extreme gradient boosting (XGBoost) framework, introduced by Chen and Guestrin (2016). This particular algorithm has proven particularly useful for predicting the foliar nitrogen concentration of grapevines in California (Moghimi et al. 2020).\nA third variation of ensemble learning with decision trees are cubist trees, which incorporate linear regression models as node rules. This adds flexibility to the model, making the response a linear function at any point — unlike the prior two models, which are essentially limited to always be step functions.\nIn general, decision-tree-based learning can be particularly effective when applied to hyperspectral data, as the trees can manage numerous dimensions and automatically select the most relevant bands at each node. They can adeptly handle non-linear relationships, a capability that some previously discussed methods lack. Additionally, their hierarchical structure is easy to understand and interpret, reflecting the decision-making process in a clear and comprehensible manner. This advantage enables drawing conclusions about the importance of specific variables for prediction, making decision-tree-based learning useful for spectral band selection, especially in classification tasks (Omidi et al. 2020).\nDecision-tree-based methods have the notable drawback in that they tend to be considerably slower during the inference stage compared to other models. Remember that when making predictions with an ensemble method, all the trained models need to calculate the result, which can contribute to a longer computation time compared to other models. This disadvantage becomes especially apparent when predictions must be for every pixel in a hyperspectral image which may potentially require billions of predictions. Additionally, in regression, decision-tree-based learning may suffer from the fact that they generate inherently non-smooth functions. If smooth non-linear functions are required, methods such as support vector regression, Gaussian process regression or even artificial neural networks might be more suitable alternatives."
  },
  {
    "objectID": "machine-learning-methods-for-hyperspectral-data-analysis.html#sec-deeplearning",
    "href": "machine-learning-methods-for-hyperspectral-data-analysis.html#sec-deeplearning",
    "title": "3  Machine learning methods for hyperspectral data analysis",
    "section": "3.5 Deep learning",
    "text": "3.5 Deep learning\nMuch of today’s remarkable advances in the field of machine learning are largely based on a group of models called artificial neural networks. These models power the most advanced artificial intelligence systems, which effortlessly outperform humans in chess, Go, or video games (Silver et al. 2017, Vinyals et al. 2019, Noda 2023). Artificial neural networks are also applied in various scientific domains, such as chaos control in fusion reactors (Degrave et al. 2022) or for highly accurate protein structure prediction (Jumper et al. 2021). In addition, artificial neural networks have made a significant impact in recent years in the form of generative artificial intelligence that can produce images, audio, or text (Rombach et al. 2021, OpenAI 2023). Some researchers even believe that the largest neural networks exhibit sparks of artificial general intelligence — that is artificial intelligence with human-like understanding and adaptability (Bubeck et al. 2023).\nArtificial neural networks are a type of machine learning algorithm that is loosely inspired by the structure and function of the human brain. The concept of artificial neural networks pre-dates many of the other models discussed so far: the so-called perceptron was formally introduced by Rosenblatt (1958), with similar ideas dating as far back as to McCulloch and Pitts (1943). Neural networks consist of multiple layers of interconnected nodes, known as neurons. Each neuron essentially functions as a generalized linear model. These neurons are organized into input, output, and hidden layers. The stacking of multiple hidden layers was referred to as deep neural networks, which gave rise to the term deep learning — basically referring to the usage of neural networks in order to solve a task.\nDespite their numerous benefits, neural networks have some significant drawbacks: they only tend to excel in domains with large sample sizes, extremely non-linear functions, and very high-dimensional data. While the last of these characteristics applies to hyperspectral data, the first two are rarely satisfied in this context. A suitable application of neural networks in hyperspectral data analysis would therefore be one where ample data is available, such as in the case of synthetic data from simulations. Hence, artificial neural networks are commonly applied to approximate the inverse of radiative transfer models (Verger et al. 2011).\nMoreover, training artificial neural networks is more challenging due to the large number of tuning parameters that must be set adequately (Chlingaryan et al. 2018). And more than any of the previously discussed machine learning models, artificial neural networks exemplify a common issue with all data-driven methods: while they may excel at recognizing patterns and making predictions, they do not necessarily enhance human understanding of processes. This is why Berger et al. (2020) advocates for further exploration of physics-based models, particularly those modelling radiative transfer.\n\n\n\n\nAkaike, H. 1998. Information theory and an extension of the maximum likelihood principle. Selected papers of Hirotugu Akaike:199–213.\n\n\nBennett, K., and M. Embrechts. 2003. An optimization perspective on kernel partial least squares regression. Nato Science Series sub series III computer and systems sciences 190:227–250.\n\n\nBerger, K., J. Verrelst, J.-B. Feret, Z. Wang, M. Wocher, M. Strathmann, M. Danner, W. Mauser, and T. Hank. 2020. Crop nitrogen monitoring: Recent progress and principal developments in the context of imaging spectroscopy missions. Remote Sensing of Environment 242:111758.\n\n\nBolster, K. L., M. E. Martin, and J. D. Aber. 1996. Determination of carbon fraction and nitrogen concentration in tree foliage by near infrared reflectances: A comparison of statistical methods. Canadian journal of forest research 26:590–600.\n\n\nBreiman, L. 2001. Random forests. Machine Learning 45:5–32.\n\n\nBubeck, S., V. Chandrasekaran, R. Eldan, J. Gehrke, E. Horvitz, E. Kamar, P. Lee, Y. T. Lee, Y. Li, S. Lundberg, and others. 2023. Sparks of artificial general intelligence: Early experiments with gpt-4. arXiv preprint arXiv:2303.12712.\n\n\nCastaldi, F., A. Castrignanò, and R. Casa. 2016. A data fusion and spatial data analysis approach for the estimation of wheat grain nitrogen uptake from satellite data. International Journal of Remote Sensing 37:4317–4336.\n\n\nChen, T., and C. Guestrin. 2016. XGBoost: A scalable tree boosting system. Pages 785–794 Proceedings of the 22nd acm sigkdd international conference on knowledge discovery and data mining.\n\n\nChlingaryan, A., S. Sukkarieh, and B. Whelan. 2018. Machine learning approaches for crop yield prediction and nitrogen status estimation in precision agriculture: A review. Computers and Electronics in Agriculture 151:61–69.\n\n\nDegrave, J., F. Felici, J. Buchli, M. Neunert, B. Tracey, F. Carpanese, T. Ewalds, R. Hafner, A. Abdolmaleki, D. de Las Casas, and others. 2022. Magnetic control of tokamak plasmas through deep reinforcement learning. Nature 602:414–419.\n\n\nFridman, L. 2019. Deep learning basics. Lecture.\n\n\nGauss, C. F. 1809. Theoria motus corporum coelestium in sectionibus conicis solem ambientium auctore carolo friderico gauss. Sumtibus Frid. Perthes et IH Besser.\n\n\nGeladi, P., and B. R. Kowalski. 1986. Partial least-squares regression: A tutorial. Analytica chimica acta 185:1–17.\n\n\nGewali, U. B., S. T. Monteiro, and E. Saber. 2018. Machine learning based hyperspectral image analysis: A survey. arXiv.\n\n\nGrossman, Y., S. Ustin, S. Jacquemoud, E. Sanderson, G. Schmuck, and J. Verdebout. 1996. Critique of stepwise multiple linear regression for the extraction of leaf biochemistry information from leaf reflectance data. Remote Sensing of Environment 56:182–193.\n\n\nHansen, P., and J. Schjoerring. 2003. Reflectance measurement of canopy biomass and nitrogen status in wheat crops using normalized difference vegetation indices and partial least squares regression. Remote Sensing of Environment 86:542–553.\n\n\nHastie, T., R. Tibshirani, and R. J. Tibshirani. 2017. Extended comparisons of best subset selection, forward stepwise selection, and the lasso. arXiv preprint arXiv:1707.08692.\n\n\nInoue, Y., E. Sakaiya, Y. Zhu, and W. Takahashi. 2012. Diagnostic mapping of canopy nitrogen content in rice based on hyperspectral measurements. Remote Sensing of Environment 126:210–221.\n\n\nJames, G., D. Witten, T. Hastie, and R. Tibshirani. 2013. An introduction to statistical learning. Springer.\n\n\nJin, Y., B. Chen, B. D. Lampinen, and P. H. Brown. 2020. Advancing agricultural production with machine learning analytics: Yield determinants for california’s almond orchards. Frontiers in Plant Science 11:290.\n\n\nJordan, M. I., and T. M. Mitchell. 2015. Machine learning: Trends, perspectives, and prospects. Science 349:255–260.\n\n\nJumper, J., R. Evans, A. Pritzel, T. Green, M. Figurnov, O. Ronneberger, K. Tunyasuvunakool, R. Bates, A. Žı́dek, A. Potapenko, and others. 2021. Highly accurate protein structure prediction with AlphaFold. Nature 596:583–589.\n\n\nLegendre, A. M. 1806. Nouvelles méthodes pour la détermination des orbites des comètes; par AM legendre... chez Firmin Didot, libraire pour lew mathematiques, la marine, l ….\n\n\nLiu, C., X. Zhang, T. T. Nguyen, J. Liu, T. Wu, E. Lee, and X. M. Tu. 2022. Partial least squares regression and principal component analysis: Similarity and differences between two popular variable reduction approaches. General Psychiatry 35.\n\n\nMarkov, A. A. 1912. Wahrscheinlichkeitsrechnung. BG Teubner.\n\n\nMcCulloch, W. S., and W. Pitts. 1943. A logical calculus of the ideas immanent in nervous activity. The bulletin of mathematical biophysics 5:115–133.\n\n\nMehmood, T., and B. Ahmed. 2016. The diversity in the applications of partial least squares: An overview. Journal of Chemometrics 30:4–17.\n\n\nMoghimi, A., A. Pourreza, G. Zuniga-Ramirez, L. E. Williams, and M. W. Fidelibus. 2020. A novel machine learning approach to estimate grapevine leaf nitrogen concentration using aerial multispectral imagery. Remote Sensing 12:3515.\n\n\nNoda, T. R. A. M. C. A. J. K. A. G. L. A. Y. N. A. M. I. A. H. 2023. Stockfish. https://github.com/official-stockfish/Stockfish; GitHub.\n\n\nOmidi, R., A. Moghimi, A. Pourreza, M. El-Hadedy, and A. S. Eddin. 2020. Ensemble hyperspectral band selection for detecting nitrogen status in grape leaves. IEEE.\n\n\nOpenAI. 2023. GPT-4 technical report. OpenAI.\n\n\nPlackett, R. L. 1949. A historical note on the method of least squares. Biometrika 36:458–460.\n\n\nRavikanth, L., D. S. Jayas, N. D. White, P. G. Fields, and D.-W. Sun. 2017. Extraction of spectral information from hyperspectral data and application of hyperspectral imaging for food and agricultural products. Food and bioprocess technology 10:1–33.\n\n\nRombach, R., A. Blattmann, D. Lorenz, P. Esser, and B. Ommer. 2021. High-resolution image synthesis with latent diffusion models.\n\n\nRosenblatt, F. 1958. The perceptron: A probabilistic model for information storage and organization in the brain. Psychological review 65:386.\n\n\nRosipal, R., and N. Krämer. 2006. Overview and recent advances in partial least squares. Pages 34–51 Subspace, latent structure and feature selection: Statistical and optimization perspectives workshop, SLSFS 2005, bohinj, slovenia, february 23-25, 2005, revised selected papers. Springer.\n\n\nSamuel, A. L. 1959. Machine learning. The Technology Review 62:42–45.\n\n\nSilver, D., J. Schrittwieser, K. Simonyan, I. Antonoglou, A. Huang, A. Guez, T. Hubert, L. Baker, M. Lai, A. Bolton, and others. 2017. Mastering the game of go without human knowledge. Nature 550:354–359.\n\n\nTakayama, T., and A. Iwasaki. 2016. Optimal wavelength selection on hyperspectral data with fused lasso for biomass estimation of tropical rainforests. ISPRS Annals of Photogrammetry, Remote Sensing & Spatial Information Sciences 3.\n\n\nTibshirani, R. 1996. Regression shrinkage and selection via the lasso. Journal of the Royal Statistical Society. Series B (Methodological) 58:267–288.\n\n\nVan den Berg, H. 2018. Occam’s razor: From ockham’s via moderna to modern data science. Science progress 101:261–272.\n\n\nVerger, A., F. Baret, and F. Camacho. 2011. Optimal modalities for radiative transfer-neural network estimation of canopy biophysical characteristics: Evaluation over an agricultural area with CHRIS/PROBA observations. Remote Sensing of Environment 115:415–426.\n\n\nVinyals, O., I. Babuschkin, W. M. Czarnecki, M. Mathieu, A. Dudzik, J. Chung, D. H. Choi, R. Powell, T. Ewalds, P. Georgiev, and others. 2019. Grandmaster level in StarCraft II using multi-agent reinforcement learning. Nature 575:350–354.\n\n\nWang, J., C. Shen, N. Liu, X. Jin, X. Fan, C. Dong, and Y. Xu. 2017. Non-destructive evaluation of the leaf nitrogen concentration by in-field visible/near-infrared spectroscopy in pear orchards. Sensors 17:538.\n\n\nWold, S., A. Ruhe, H. Wold, and W. Dunn Iii. 1984. The collinearity problem in linear regression. The partial least squares (PLS) approach to generalized inverses. SIAM Journal on Scientific and Statistical Computing 5:735–743.\n\n\nYan, X., and X. Su. 2009. Linear regression analysis: Theory and computing. world scientific.\n\n\nZou, H., and T. Hastie. 2005. Regularization and variable selection via the elastic net. Journal of the royal statistical society: series B (statistical methodology) 67:301–320."
  },
  {
    "objectID": "radiative-transfer-models.html#leaf-level-radiative-transfer-models",
    "href": "radiative-transfer-models.html#leaf-level-radiative-transfer-models",
    "title": "4  Radiative transfer models",
    "section": "4.1 Leaf-level radiative transfer models",
    "text": "4.1 Leaf-level radiative transfer models\nOne of the most prevalent radiative transfer models is Prospect (leaf optical properties spectra), initially introduced by Jacquemoud and Baret (1990). Drawing upon the plate model by Allen et al. (1969), it simulates both reflectance and transmittance of a plant leaf across wavelengths ranging from 400 to 2500 nm. The first version of the Prospect model featured only three input variables: leaf structure (\\(N\\)), leaf chlorophyll content (\\(c_{a+b}\\)), and leaf water content (\\(c_w\\)). Based on that, the model returns the expected reflectance (\\(\\boldsymbol \\rho\\)) and transmittance (\\(\\boldsymbol \\tau\\)) for each simulated wavelength (\\(\\lambda\\)).\n\\[f: [N, c_{a+b}, c_w] \\in \\mathbb R^{3} \\rightarrow [\\boldsymbol \\rho, \\boldsymbol \\tau] \\in \\mathbb R^{2\\times 2101} \\tag{4.1}\\]\nOver the past four decades, the initial Prospect model has undergone several updates to encompass leaf mass, tannins, anthocyanins, and carotenoids (Fourty et al. 1996, Jacquemoud et al. 1996, Baret and Fourty 1997, Fourty and Baret 1998). For a long period, protein and other non-protein carbon-based compounds were consolidated into a single variable due to the challenge of disentangling them (Jacquemoud et al. 2000).\nIn a notable development, the newest iteration of the Prospect model, Prospect-Pro, Féret et al. (2021) successfully disentangled these components by splitting the earlier used variable of leaf mass into protein content and other carbon-based content, which include cellulose, lignin, hemicellulose, starch, and sugars. Prospect-Pro was calibrated and validated using the leaf optical properties experiment (Lopex) dataset, which comprises measurements from over fifty plant species collected in northern Italy (Hosgood et al. 1995). This model incorporates seven distinct classes of absorbing compounds, collectively referred to as vector \\(\\mathbf c\\).\n\\[f: [N, \\mathbf c, \\alpha] \\in \\mathbb R^{9} \\rightarrow [\\boldsymbol \\rho, \\boldsymbol \\tau] \\in \\mathbb R^{2\\times 2101} \\tag{4.2}\\]\nProspect-Pro also enables the adjustment of the solid angle \\(\\alpha\\) for incident light on the leaf surface, initially determined to be \\(\\alpha = 60^\\circ\\) by Jacquemoud and Baret (1990) using a limited dataset. Subsequently, Féret et al. (2008) discovered that \\(\\alpha = 40^\\circ\\) was a more accurate value. An overview of the parameters used in Prospect-Pro can be found in table 4.1.\n\n\nTable 4.1: Input variables of the Prospect-Pro model as documented by Féret and de Boissieu (2022a). The rows 2 - 7 show the elements of the constituents vector \\(\\mathbf c\\).\n\n\n\n\n\n\n\n\nAbbreviation\n\nParameter\nUnit\n\n\n\n\n\\(N\\)\nN\nLeaf mesophyll structure parameter\n\n\n\n\n\n\n\\(\\mathbf c\\)\nCHL\nCAR\nANT\nBROWN\nEWT\nPROT\nCBC\nChlorophyll content\nCarotenoid content\nAnthocyanin content\nTannin content\nEquivalent water thickness\nProtein content\n(Non-protein) carbon-based constituent content\n\\(\\mu \\text{g cm}^{-2}\\)\n\\(\\mu \\text{g cm}^{-2}\\)\n\\(\\mu \\text{g cm}^{-2}\\)\n\\(-\\)\n\\(\\text{g cm}^{-2}\\)\n\\(\\text{g cm}^{-2}\\)\n\\(\\text{g cm}^{-2}\\)\n\n\n\\(\\alpha\\)\nalpha\nSolid angle for incident light at surface of leaf\n\\(^{\\circ}\\)\n\n\n\n\nThe Prospect calculations rely on well-established laws of physics, with the Fresnel equations serving as the foundation. These equations describe the reflection and transmission of electromagnetic radiation between distinct optical media (Fresnel 1821). Both \\(s\\) and \\(p\\) polarizations are included in the equations, which necessitate a refractive index \\(n\\) — assumed to be \\(n &gt; 1\\) for the leaf and \\(n = 1\\) for air — and an angle of incidence \\(\\theta\\).\n\\[t_s = \\frac{4\\sqrt{1-\\sin^2 \\theta} \\sqrt{n^2-\\sin^2 \\theta}}{\\left(\\sqrt{1-\\sin^2 \\theta} + \\sqrt{n^2-\\sin^2 \\theta}\\right)^2}\n\\quad\nt_p = \\frac{4n^2\\sqrt{1-\\sin^2 \\theta} \\sqrt{n^2-\\sin^2 \\theta}}{\\left(n^2\\sqrt{1-\\sin^2 \\theta} + \\sqrt{n^2-\\sin^2 \\theta}\\right)^2}\n\\tag{4.3}\\]\nAs the focus lies on the transmissivity for diffuse light originating from all angles \\(\\theta\\) between 0 and \\(\\frac{\\pi}{2}\\), it is necessary to integrate across all possible angles to obtain the average transmissivity \\(\\overline{T}\\).\n\\[\\overline{T} = \\frac{\\int_0^{2\\pi} d\\varphi \\int_0^{\\alpha} t(\\theta,n) \\cos \\theta \\sin\\theta d \\theta}{\\int_0^{2\\pi} d\\varphi \\int_0^{\\alpha}  \\cos \\theta \\sin\\theta d \\theta} \\tag{4.4}\\]\nThe integration for the special case where the maximum incidence angle \\(\\alpha\\) equals \\(\\frac{\\pi}{2}\\) was performed by Stern (1964). Subsequently, Allen (1973) conducted the integration of the average transmissivity \\(\\overline{T}\\) for a generalized angle of incidence \\(\\alpha\\). This approach is currently employed in the Prospect-Pro computation (Féret and de Boissieu 2022a). The expression for average transmissivity is rather complex, as to be seen in equation 4.5. A visual representation of how the average transmissivity varies as a function of the refractive index \\(n\\) and the angular range \\(\\alpha\\) can be found in figure 4.3, displayed at the bottom.\n\n\n\nFigure 4.2: The Prospect model simplifies a leaf’s structure by representing it as a flat plane, rather than accounting for its complex three-dimensional form, which consists of various components and a textured surface (A, created using content by Wheeler (2011)). In the sketch inspired by Jacquemoud (1992) (B), the different angles incorporated in equation 4.4 are illustrated: the general angles for azimuth (\\(\\varphi\\)) and zenith (\\(\\theta\\)) as well as the angle of maximum incident (\\(\\alpha\\)). In addition to that, the arrows indicate the reflectance (\\(\\rho\\)) and transmittance (\\(\\tau\\)).\n\n\n\\[\n\\begin{aligned}\nT_s(\\alpha, n) =\n\\frac{1}{96}\\frac{(n^2-1)^4}{\\left[\\sqrt{\\left(\\sin^2 \\alpha -\\frac{1}{2} (n^2 + 1)\\right)^2 -\\frac{1}{4} (n^2 - 1)^2} - \\sin^2 \\alpha +\\frac{1}{2}  (n^2 + 1)\\right]^3} -\n\\\\\\\n\\frac{1}{4}\\frac{n^4 - 2n^2 +1}{\\sqrt{\\left(\\sin^2 \\alpha -\\frac{1}{2} (n^2 + 1)\\right)^2 -\\frac{1}{4} (n^2 - 1)^2} - \\sin^2 \\alpha + \\frac{1}{2} (n^2 + 1)} -\n\\\\\\\n\\frac{1}{2} \\left( \\sqrt{\\left(\\sin^2 \\alpha -\\frac{1}{2} (n^2 + 1)\\right)^2 -\\frac{1}{4} (n^2 - 1)^2} - \\sin^2 \\alpha + \\frac{1}{2} (n^2 + 1) \\right) +\n\\\\\\\n\\frac{1}{12} \\frac{(n^2 - 1)^4}{(n + 1)^6} + \\frac{1}{2} \\frac{(n^2-1)^2}{(n+1)^2} + \\frac{1}{4} (n^2+2n+1)\n\\end{aligned}\n\\]\n\\[\n\\begin{aligned}\nT_p(\\alpha, n) =\n\\frac{-2 n^2}{(n^2 + 1)^2} \\left[ \\sqrt{\\left(\\sin^2 \\alpha - \\frac{1}{2} (n^2 + 1)\\right)^2 - \\frac{1}{4} (n^2 - 1)^2} - \\sin^2 \\alpha + \\frac{1}{2} (n^2 + 1) - \\frac{1}{2} (n + 1)^2 \\right] -\n\\\\\\\n\\frac{2  n^2  (n^2 + 1)}{(n^2-1)^2}  \\cdot \\ln \\left[ \\sqrt{\\left(\\sin^2 \\alpha - \\frac{1}{2} (n^2 + 1)\\right)^2 - \\frac{1}{4} (n^2 - 1)^2} -\n\\frac{\\sin^2 \\alpha - \\frac{1}{2}(n^2 + 1)}{(n+1)^2}\n\\right] +\n\\\\\\\n\\frac{1}{2} n^2 \\left\\{ \\left[ \\sqrt{\\left(\\sin^2 \\alpha - \\frac{1}{2} (n^2 + 1)\\right)^2 - \\frac{1}{4} (n^2 - 1)^2} - \\sin^2\\alpha - \\frac{1}{2} (n^2 + 1)\\right]^{-1} - \\frac{2}{(n + 1)^2} \\right\\} +\n\\\\\n\\frac{16n^4 (n^4 + 1)}{(n^2+1)^3(n^2-1)^2} \\cdot \\ln \\left[\\frac{\n2 (n^2 + 1)  \\left(\\sqrt{\\left(\\sin^2 \\alpha - \\frac{1}{2} (n^2 + 1)\\right)^2} - \\sin^2 \\alpha + \\frac{1}{2}  (n^2 + 1)\\right)\n- (n^2 - 1)^2}{(n^2 + 1)(n + 1)^2  - (n^2-1)^2} \\right] +\n\\\\\\\n\\frac{16 n^6}{(n^2 + 1)^3} \\left[\n{2 (n^2 + 1)  \\left(\\sqrt{\\left(\\sin^2 \\alpha - \\frac{1}{2} (n^2 + 1)\\right)^2} - \\sin^2 \\alpha + \\frac{1}{2}  (n^2 + 1)\\right)\n- (n^2 - 1)^2} \\right]^{-1} -\n\\\\\\\n\\frac{16n^6}{(n^2 + 1)^3\\left( (n^2 + 1)   (n + 1)^2 - (n^2 - 1)^2 \\right)}\n\\end{aligned}\n\\]\n\\[\n\\overline{T}(\\alpha, n) = \\frac{T_s(\\alpha, n) + T_p(\\alpha, n)}{2 \\cdot \\sin^2 \\alpha}\n\\tag{4.5}\\]\nIn the Prospect-Pro model, reflectance and transmittance depend on multiple variables, as well as numerous fixed, empirically estimated parameters. These parameters encompass the refractive index (\\(n\\)) and specific absorption coefficients (\\(s\\)), which all are individually fitted for each absorbing compound in \\(\\mathbf c\\) across a diverse range of plant species. Additionally, these parameters are estimated for every wavelength \\(\\lambda\\) between 400 and 2500 nm. As a result, Prospect-Pro relies on a total of 8 × 2101 = 16’808 empirically estimated internal parameters. With these parameters in hand, the overall absorption coefficient can be computed as follows.\n\\[k_\\lambda = \\frac{1}{N} \\sum_i c_i s_{i,\\lambda} \\tag{4.6}\\]\nHere, \\(c_i\\) represents the content of the \\(i\\)th constituent in the vector \\(\\mathbf c\\) (as detailed in table 4.1), and \\(s_i\\) denotes the specific absorption coefficient of the \\(i\\)th constituent and the \\(\\lambda\\)th wavelength. Although the computation of reflectance and transmittance is not linear with respect to \\(k\\), it is still possible to discern the bandwidths in which a particular compound’s presence would have an impact based on the specific absorption coefficients \\(s\\) displayed in figure 4.3.\n\n\n\nFigure 4.3: Top: This figure shows the refractive index (n) and the eight specific absorption coefficients (\\(s\\)) for different constituents of the Prospect-Pro model as functions of the wavelength \\(\\lambda\\). This encompasses the parameters chlorophyll content (CHL), carotenoid content (CAR), anthocyanin content (ANT), brown pigment content (BROWN), equivalent water thickness (EWT), leaf mass per area (LMA), protein content (PROT), and (non-protein) carbon-based constituents content (CBC). Bottom: The average transmissivity \\(\\overline{T}\\) of a plane dielectric surface for different values of the refractive index \\(n\\) over the angular range \\(\\alpha\\). Adapted from Jacquemoud and Baret (1990).\n\n\nUtilizing the overall absorption coefficient \\(k\\), the transmission for isotropic light \\(\\varphi\\) can be calculated for each wavelength \\(\\lambda\\) with \\(k = k_\\lambda\\) using the upper incomplete gamma function in accordance with the Beer-Lambert law (Lambert 1760, Beer 1852).\n\\[\\varphi = (1 - k) \\cdot e^{-k} + k^2 \\cdot \\Gamma(k) = \\\\\n(1 - k) \\cdot e^{-k} + k^2 \\cdot \\int_k^\\infty \\frac{e^{-t}}{t} dt \\tag{4.7}\\]\nIn the case of Prospect-Pro, the upper incomplete Gamma function \\(\\Gamma(k)\\) is simplified and computed according to Goulet (2016). Using this information, the final equations for transmittance \\(\\tau\\) and reflectance \\(\\rho\\) can be expressed (Equation 4.9). Due to space limitations, the substituting terms \\(A, B, C, D, E, F\\), and \\(G\\) are employed (Equation 4.8).\n\\[\\begin{aligned}\nA = \\frac{ \\varphi \\: \\overline T(90, n)} { n^2\\left[1 - \\varphi^2 \\: \\left(1 - n^{-2} \\: \\overline T(90, n) \\right)^2\\right] }\n\\qquad\nB = \\overline T(90, n) \\: A\n\\\\[15pt]\nC = 1 - \\overline T(90, n) + \\varphi \\: B \\: \\left(1 - \\frac{\\overline T(90, n)}{n^2}\\right)\n\\\\[15pt]\nD = \\sqrt{(1 + C + B) \\: (1 + C - B) \\: (1 - C + B) \\: (1 - C - B)}\n\\qquad\nE = \\frac{1 + C^2 - B^2 + D}{2\\,C}\n\\\\[15pt]\nF = \\frac{1 - C^2 + B^2 + D}{2\\,B}\n\\qquad\nG = F^{N-1}\n\\qquad\nH = \\frac{E \\, (G^2 - 1)}{E^2 \\, G^2 - 1}\n\\end{aligned} \\tag{4.8}\\]\n\\[\\rho = 1 - \\overline T(\\alpha, n) \\left[ 1 + \\varphi \\, A \\left(1 - \\frac{\\overline T(90, n)}{n^2}  \\right) + \\frac{A \\, H \\, B}{1 - H \\, C}  \\right]\n\\quad\n\\tau =  \\frac{\\overline T(\\alpha, n) \\, A \\, G \\, (E^2 - 1)}{(E^2 \\, G^2 - 1) \\, (1 - H \\, C)} \\tag{4.9}\\]\nThe impact of distinct compounds on absorption is demonstrated in figure 4.4. This figure vividly portrays the absorption of electromagnetic radiation by proteins in the short-wave-infrared spectrum, specifically within the range of 1500 to 2500 nm wavelength. In contrast to carbon-based compounds, proteins exhibit no absorption in the near-infrared or visible light spectra.\n\n\n\nFigure 4.4: This figure illustrates the output of the Prospect-Pro model. Every plot shows an overlay of 20 model runs where only one variable is changing ceteris paribus. The three variables illustrated are chlorophyll content (A: CHL \\(\\in [10,70]\\; \\mu\\text{g} \\: \\text{cm}^{-2}\\)), (non-protein) carbon-based content (B: CBC \\(\\in [0,0.02] \\; \\text{g} \\: \\text{cm}^{-2}\\)), and protein content (C: PROT \\(\\in [0,0.02] \\; \\text{g} \\: \\text{cm}^{-2}\\))."
  },
  {
    "objectID": "radiative-transfer-models.html#canopy-level-radiative-transfer-models",
    "href": "radiative-transfer-models.html#canopy-level-radiative-transfer-models",
    "title": "4  Radiative transfer models",
    "section": "4.2 Canopy-level radiative transfer models",
    "text": "4.2 Canopy-level radiative transfer models\nThe Prospect model is specifically designed to simulate the reflectance and transmittance of an individual leaf. However, simulating the reflectance of an entire canopy proves to be far more intricate. Canopy reflectance is affected by numerous factors such as leaf inclination, solar irradiance angle, viewing angle of the canopy, and the interference of soil reflectance as well as atmospheric effects. To effectively account for these diverse variables, substantial extensions are necessary, which ultimately results in a significantly more complex simulation process. Consequently, this section outlines several approaches for utilizing the Prospect model at the canopy level.\n\nOne-dimensional canopy reflectance models\nThe radiative transfer model Sail (scattering by arbitrary inclined leaves) was one of the earliest models to simulate the bidirectional reflectance of a canopy. Sail makes reflectance a function of both solar incident and viewing angles (Verhoef 1984, 1985). As implied by its name, Sail represents the canopy through the simulation of numerous randomly inclined leaves situated above the soil. These leaves are assumed to be uniformly distributed in space but inclined according to a specific leaf inclination angle distribution function.\nThe most recent iteration of the Sail model is known as 4Sail. While it simulates the same process as the original version, 4Sail is more numerically robust and optimized for enhanced speed (Verhoef et al. 2007). The parameters used in the Sail model can be found in table 4.2.\n\n\nTable 4.2: Input variables of the 4Sail model as documented by Féret and de Boissieu (2022b).\n\n\n\n\n\n\n\n\nParameter\nUnit\n\n\n\n\nlai\nq\n\\(\\rho_{\\text{soil}}\\)\n\\(\\alpha_{\\text{soil}}\\)\nskyl\n\\(\\theta_{\\text{s}}\\)\n\\(\\theta_{\\text{v}}\\)\nrAA\nLeaf area index\nHot spot parameter\nSoil reflectance\nSoil brightness factor\nFraction of diffuse illumination\nSun zenith angle\nViewing (observer) zenith angle\nRelative azimuth angle between sun and sensor\n\\(\\text{m}^2 \\; \\text{m}^{-2}\\)\n\\(\\text{m} \\; \\text{m}^{-1}\\)\n\\(\\%\\)\n\n\n\\(^\\circ\\)\n\\(^\\circ\\)\n\\(^\\circ\\)\n\n\n\n\nIn order to achieve accurate modelling with the Sail model, specifying the reflectance and transmittance of leaves is crucial. These values can either be measured directly and integrated into the model or derived from the Prospect model’s predictions. The coupling of these models was first accomplished by Baret et al. (1992) following the development of the initial Prospect model. This combined model is known as Prosail, and its latest implementation unifies 4Sail and Prospect-Pro (Jacquemoud et al. 2009). Prosail provides an effective means of extending plant pigment retrieval techniques from leaf-level analysis to canopy-level assessment, thereby enriching the scope of vegetation studies.\nThe Prosail model simplifies light transport through a canopy into a one-dimensional process, in which light can travel either downwards or upwards. The canopy is assumed to consist of a homogeneous distribution of leaves. This simplification imposes certain limitations on the applicability of Prosail and similar one-dimensional radiative transfer models (Bailey et al. 2020). Although the assumption proves reasonably effective for modelling canopies that can be approximated as a homogeneous mass, such as grass, wheat, or soybeans, it may not be well-suited for more heterogeneous canopies. As a result, the Prosail model is not the most suitable choice for examining crops with intricate canopy structures such as almond trees — alternative models should be considered and explored for these specific applications.\n\n\nRay tracing\nIn order to simulate the impact of a specific three-dimensional canopy structure on the reflectance, a technique called ray tracing is required. Ray tracing is a method for modelling light transport and is widely employed in rendering algorithms to create realistic digital images. It is not the only rendering algorithm, nor is it the fastest, but it tends to deliver the most realistic results (Peddie 2019).\nThe underlying reason for this is that ray tracing truthfully replicates the behaviour of light, offering a highly accurate simulation of its interactions within various environments. Within an environment containing various objects of interest, single rays of light are simulated, each assigned a specified (spectral) reflectance and transmittance. Each ray of light is represented by a direction and an energy level provided for every simulated spectral band. When a ray of light encounters an object, its direction changes according to a bidirectional reflectance distribution function (BRDF), and its energy level is reduced by multiplying it with the object’s surface reflectance. The ray of light is continuously losing energy, as an object’s reflectance is always \\(\\leq 1\\). Ultimately, the ray either exits the modelled environment or strikes the simulated sensor, contributing to the values of simulated pixels.\nForward path tracing is a technique in which ray tracing originates at the light source and may conclude at the simulated camera. The primary drawback of this approach is that most light rays leave the modelled environment without impacting the simulated image at all. Hence, a more computationally efficient strategy begins at the sensor position, sending light rays into the scene while calculating the appropriate spectral intensity for each individual ray. This process is known as backwards path tracing (Jianbo 2022).\nRay tracing has advanced significantly over the last few decades, particularly due to the improvement efforts of the video game and computer animation industries. The implementation of many tricks such as backwards path tracing has constantly improved the performance of ray tracing algorithms. However, research has primarily focused on methods for increasing algorithm speed (Wyman and Panteleev 2021, Lin et al. 2022). Accurate simulation of optical processes has been of lesser importance, as long as the resulting images appear visually pleasing to humans. Consequently, many ray tracing algorithms developed for computer graphics cannot be directly applied to simulating canopy reflectance (Jianbo 2022).\n\n\nThree-dimensional canopy reflectance models\nSpecialized programs are necessary to carry out the ray tracing calculations required for scientific applications. One such program is the Less{.smallcaps} model, specifically designed for simulating forest canopy reflectance. Less (large-scale emulation system for forest simulation) was developed by Qi et al. (2017) in 2017 and has been continuously maintained and updated in subsequent years (Qi et al. 2019, 2022, 2023). The model employs a backward path tracing method to generate large-scale spectral images, ranging from the visible to the thermal infrared spectral domain (Jianbo 2022).\nAccess to Less is provided through a freely available graphical user interface (GUI), which facilitates the arrangement of three-dimensional objects within a scene and allows for pre-rendering inspection. Each component in the modelled scene, such as leaves, stems, or soil, can be assigned specific optical properties — both reflectance and transmittance — that influence ray tracing. However, all simulated surfaces are assumed to be Lambertian, or perfectly matte, meaning that no bidirectional reflectance distribution function can be implemented for leaves in Less (Qi et al. 2017).\nNevertheless, Less enables the configuration of numerous parameters, including zenith and azimuth angles for both sensor view and solar irradiance, sensor height, cloudiness type, and the desired quality of the produced image.\nIt is worth noting that Less is not the only model capable of rendering a three-dimensional canopy for scientific purposes. Another example is the ray tracing model Dart (discrete anisotropic radiative transfer), introduced by Malenovskỳ et al. (2013)."
  },
  {
    "objectID": "radiative-transfer-models.html#the-inversion-problem",
    "href": "radiative-transfer-models.html#the-inversion-problem",
    "title": "4  Radiative transfer models",
    "section": "4.3 The inversion problem",
    "text": "4.3 The inversion problem\nThus far, the discussion has centred on radiative transfer models as a method for simulating leaf or canopy reflectance and transmittance, assuming that parameters such as chlorophyll, anthocyanin, or carotenoid content are already known. This is referred to as the forward mode of a radiative transfer model. In some cases, the forward mode of a model might be useful in and by itself, most notably for generating synthetic data. Such data can be used for the intercomparison of other models, to conduct a sensitivity analysis, or even to find new vegetation indices (Cheng et al. 2014, Jin et al. 2014).\nHowever, in many cases, reflectance information is already available, and the objective shifts to identifying the set of parameters that, given a specific model, best explain the observed data. This is referred to as the backward mode of a radiative transfer model. The goal is to discover the inverse function \\(f^{-1}\\) of the actual model \\(f\\). \\[\nf: x \\to y \\qquad \\qquad f^{-1}: y\\to x\n\\tag{4.10}\\] Upon successful model inversion, the output of the model becomes its input and vice versa. Unfortunately, inverting radiative transfer models such as Prospect is considered mathematically ill-posed and cannot be accomplished algebraically by simply re-writing the equations (Daun 2017). Consequently, alternative methods must be employed to achieve the model inversion. Specifically, the inversion of a radiative transfer model can be achieved through mathematical optimization, look-up tables, or machine learning techniques.\n\nMathematical optimization\nThe conventional approach to inverting Prospect-Pro involves mathematical optimization, specifically sequential quadratic programming (Borchers 2022, Féret and de Boissieu 2022a). This iterative optimization algorithm seeks to identify the parameters \\(\\boldsymbol \\theta\\) for the model \\(f\\) in order to minimize a cost function \\(J\\). Typically, the mean squared error is employed as the cost function, which represents the sum of the squared difference between the model’s predictions (\\(f(\\boldsymbol {\\theta})_\\lambda\\)) and the observed reflectance and transmittance data. \\[\n\\boldsymbol {\\hat \\theta}\n= \\arg \\min_{\\boldsymbol {\\theta}} J(\\boldsymbol \\theta, \\boldsymbol \\rho) =\n\\arg \\min_{\\boldsymbol {\\theta}} \\sum_{\\lambda=1}^{n} \\left( f(\\boldsymbol {\\theta})_\\lambda - \\rho_\\lambda \\right)^2\n\\tag{4.11}\\] Note that the formula in equation 4.11 only relates to reflectance but works analogous for transmittance as well. The optimization algorithm operates by iteratively running the model, numerically approximating the gradient (\\(\\nabla_J\\)) and the Hessian (\\(\\mathbf H_J\\)) of the cost function \\(J\\), and utilizing this information to adjust the parameters. This iteration is stopped when the gradient becomes sufficiently small (\\(\\nabla_J \\approx \\mathbf 0\\)). Inverting the Prospect-Pro model necessitates approximately 132 model runs on average1 to achieve a tolerance level of 10−6.1 This statement highlights that the average number of model evaluations required for inverting the Prospect-Pro model on the almond dataset was 132. While this number may vary for different datasets, the differences are not expected to be extreme, remaining within the same order of magnitude.\nAs an alternative to the maximum likelihood estimation effectively executed via the minimization task in equation 4.11, a Bayesian framework could be employed to identify the model’s parameters (Daun 2017). This method requires information on the prior distribution of the parameter to compute the posterior probability distribution. Although it is computationally more demanding than the maximum likelihood estimation, it offers the advantage of producing credibility intervals for the parameters based on their joint distribution. For instance, Zhang et al. (2005) and more recently Shiklomanov et al. (2021) employed a Bayesian calibration method to invert the Prosail-2 and Prospect-5 models, respectively. Both teams utilized a Markov Chain Monte Carlo (MCMC) algorithm to achieve this inversion.\nThere are three primary drawbacks associated with employing mathematical optimization as an inversion technique for radiative transfer models. The first drawback concerns the feasibility of the approach, which diminishes as the computational cost for a single evaluation of the model becomes too large. This typically occurs when the radiative transfer model grows increasingly complex and computationally demanding, thereby reducing the efficacy of mathematical optimization as an inversion method. The second disadvantage emerges when handling a substantial number of observations that necessitate individual parameter retrieval. In these instances, mathematical optimization loses its effectiveness, as the information obtained from inverting the model for one observation cannot be utilized for another. The final concern involves the risk of becoming trapped in a local minimum, contingent upon the selection of initial parameters. If these limitations prove to be insurmountable, it is prudent to explore alternative solutions such as look-up tables or machine learning techniques, which might offer greater efficiency and effectiveness in addressing such challenges. Consequently, for the inversion of more intricate models like Less, mathematical optimization is not the most suitable approach.\n\n\nLook-up tables\nLook-up tables serve as a particularly valuable model inversion technique when the model in question is computationally expensive, yet its results can be cached easily (Selan 2005). Typically implemented as a fixed-size array, a look-up table consists of elements, each of which corresponds to a specific set of parameters. In the case of Prospect-Pro, these elements represent the combined reflectance and transmittance data. This structure enables relatively rapid data access; however, it also necessitates pre-calculation and storage of the entire look-up table, encompassing all possible parameter combinations (Berger et al. 2018).\nThe primary disadvantage of look-up tables is the potentially extensive time required for pre-calculating all elements, as well as the necessity of accessing the entire table — which may represent an exceptionally large data structure — for making predictions. It is important to highlight that the data within look-up tables often displays a high degree of collinearity. As a result, a machine learning model can be trained on the look-up table, significantly reducing its size, and thus facilitating the distribution of the inverted model and also the inference process (Verrelst et al. 2016).\n\n\nModel inversion via machine learning\nInverting models through machine learning can be achieved by first generating a synthetic data set using the radiative transfer model, and then training a machine learning model on that synthetic data set. In this regard, artificial neural networks have gained particular prominence. As the number of observations rises, neural networks tend to outperform other machine learning models. Given the synthetic nature of the data, there is virtually no constraint on the number of observations (Kimes et al. 2000, Verger et al. 2011). Moreover, artificial neural networks offer the advantage of producing relatively quick predictions during the inference stage once they are trained. For instance, the canopy level radiative transfer model Prosail has been successfully inverted for crop trait retrieval using neural networks (Verger et al. 2011), but also using random forest regression (Doktor et al. 2014).\nVerrelst et al. (2015) refer to machine learning models that approximate the inverse of a radiative transfer model as emulators. The authors argue that the most significant advantages of emulators are their ability to interpolate effectively in regions where the radiative transfer model has not been executed and their rapid prediction capabilities compared to methods like look-up tables.\n\n\n\n\nAllen, W. A. 1973. Transmission of isotropic light across a dielectric surface in two and three dimensions. JOSA 63:664–666.\n\n\nAllen, W. A., H. W. Gausman, A. J. Richardson, and J. R. Thomas. 1969. Interaction of isotropic light with a compact plant leaf. JOSA 59:1376–1379.\n\n\nAllen, W. A., H. Gausman, and A. Richardson. 1973. Willstätter-stoll theory of leaf reflectance evaluated by ray tracing. Applied Optics 12:2448–2453.\n\n\nBailey, B. N., M. A. Ponce de León, and E. S. Krayenhoff. 2020. One-dimensional models of radiation transfer in heterogeneous canopies: A review, re-evaluation, and improved model. Geoscientific Model Development 13:4789–4808.\n\n\nBaret, F., and T. Fourty. 1997. Estimation of leaf water content and specific leaf weight from reflectance and transmittance measurements. Agronomie 17:455–464.\n\n\nBaret, F., S. Jacquemoud, G. Guyot, and C. Leprieur. 1992. Modeled analysis of the biophysical nature of spectral shifts and comparison with information content of broad bands. Remote Sensing of Environment 41:133–142.\n\n\nBeer, A. 1852. Bestimmung der absorption des rothen lichts in farbigen flussigkeiten. Ann. Physik 162:78–88.\n\n\nBerger, K., C. Atzberger, M. Danner, G. D’Urso, W. Mauser, F. Vuolo, and T. Hank. 2018. Evaluation of the PROSAIL model capabilities for future hyperspectral model environments: A review study. Remote Sensing 10:85.\n\n\nBorchers, H. W. 2022. Pracma: Practical numerical math functions.\n\n\nCheng, X., G. Yang, X. Xu, T. Chen, Z. Li, H. Feng, D. Wang, and others. 2014. Estimating canopy water content in wheat based on new vegetation water index. Spectroscopy and Spectral Analysis 34:3391–3396.\n\n\nDaun, K. J. 2017. Inverse problems in radiative transfer. Pages 1–51. Springer International Publishing.\n\n\nDoktor, D., A. Lausch, D. Spengler, and M. Thurner. 2014. Extraction of plant physiological status from hyperspectral signatures using machine learning methods. Remote Sensing 6:12247–12274.\n\n\nFéret, J.-B., K. Berger, F. De Boissieu, and Z. Malenovskỳ. 2021. PROSPECT-PRO for estimating content of nitrogen-containing leaf proteins and other carbon-based constituents. Remote Sensing of Environment 252:112173.\n\n\nFéret, J.-B., and F. de Boissieu. 2022b. Prosail: PROSAIL leaf and canopy radiative transfer model and inversion routines.\n\n\nFéret, J.-B., and F. de Boissieu. 2022a. Prospect: PROSPECT leaf radiative transfer model and inversion routines.\n\n\nFéret, J.-B., C. François, G. P. Asner, A. A. Gitelson, R. E. Martin, L. P. Bidel, S. L. Ustin, G. Le Maire, and S. Jacquemoud. 2008. PROSPECT-4 and 5: Advances in the leaf optical properties model separating photosynthetic pigments. Remote Sensing of Environment 112:3030–3043.\n\n\nFourty, T., and F. Baret. 1998. On spectral estimates of fresh leaf biochemistry. International Journal of Remote Sensing 19:1283–1297.\n\n\nFourty, T., F. Baret, S. Jacquemoud, G. Schmuck, and J. Verdebout. 1996. Leaf optical properties with explicit description of its biochemical composition: Direct and inverse problems. Remote Sensing of Environment 56:104–117.\n\n\nFresnel, A. 1821. Note sur le calcul des teintes que la polarisation développe dans leslames cristallisées. Annales de Chimie et de Physique 17:102–111.\n\n\nGoulet, V. 2016. Expint: Exponential integral and incomplete gamma function.\n\n\nHosgood, B., S. Jacquemoud, G. Andreoli, J. Verdebout, G. Pedrini, and G. Schmuck. 1995. Leaf optical properties experiment 93 (LOPEX93). Report EUR 16095.\n\n\nJacquemoud, S. 1992. Utilisation de la haute resolution spectrale pour l’etude des couverts vegetaux: Developpement d’un modele de reflectance spectrale. PhD thesis, Université Paris Diderot-Paris 7.\n\n\nJacquemoud, S., C. Bacour, H. Poilve, and J.-P. Frangi. 2000. Comparison of four radiative transfer models to simulate plant canopies reflectance: Direct and inverse mode. Remote Sensing of Environment 74:471–481.\n\n\nJacquemoud, S., and F. Baret. 1990. PROSPECT: A model of leaf optical properties spectra. Remote Sensing of Environment 34:75–91.\n\n\nJacquemoud, S., S. Ustin, J. Verdebout, G. Schmuck, G. Andreoli, and B. Hosgood. 1996. Estimating leaf biochemistry using the PROSPECT leaf optical properties model. Remote Sensing of Environment 56:194–202.\n\n\nJacquemoud, S., W. Verhoef, F. Baret, C. Bacour, P. Zarco-Tejada, G. Asner, C. François, and S. Ustin. 2009. PROSPECT + SAIL models: A review of use for vegetation characterization. Remote Sensing of Environment 113:S56–S66.\n\n\nJianbo, Q. 2022. LESS user’s manual. 2.0 edition.\n\n\nJin, X., Z. Li, H. Feng, X. Xu, and G. Yang. 2014. Newly combined spectral indices to improve estimation of total leaf chlorophyll content in cotton. IEEE Journal of Selected Topics in Applied Earth Observations and Remote Sensing 7:4589–4600.\n\n\nKimes, D., Y. Knyazikhin, J. Privette, A. Abuelgasim, and F. Gao. 2000. Inversion methods for physically-based models. Remote Sensing Reviews 18:381–439.\n\n\nLambert, J. H. 1760. Photometria sive de mensura et gradibus luminis, colorum et umbrae. Sumptibus vidvae E. Klett, typis CP Detleffsen.\n\n\nLin, D., M. Kettunen, B. Bitterli, J. Pantaleoni, C. Yuksel, and C. Wyman. 2022. Generalized resampled importance sampling: Foundations of ReSTIR. ACM Transactions on Graphics (TOG) 41:1–23.\n\n\nMalenovskỳ, Z., L. Homolová, R. Zurita-Milla, P. Lukeš, V. Kaplan, J. Hanuš, J.-P. Gastellu-Etchegorry, and M. E. Schaepman. 2013. Retrieval of spruce leaf chlorophyll content from airborne image data using continuum removal and radiative transfer. Remote Sensing of Environment 131:85–102.\n\n\nPeddie, J. 2019. Ray tracing: A tool for all. Springer.\n\n\nQi, J., J. Jiang, K. Zhou, D. Xie, and H. Huang. 2023. Fast and accurate simulation of canopy reflectance under wavelength-dependent optical properties using a semi-empirical 3D radiative transfer model. Journal of Remote Sensing 3:0017.\n\n\nQi, J., D. Xie, D. Guo, and G. Yan. 2017. A large-scale emulation system for realistic three-dimensional (3-d) forest simulation. IEEE Journal of Selected Topics in Applied Earth Observations and Remote Sensing 10:4834–4843.\n\n\nQi, J., D. Xie, J. Jiang, and H. Huang. 2022. 3D radiative transfer modeling of structurally complex forest canopies through a lightweight boundary-based description of leaf clusters. Remote Sensing of Environment 283:113301.\n\n\nQi, J., D. Xie, T. Yin, G. Yan, J.-P. Gastellu-Etchegorry, L. Li, W. Zhang, X. Mu, and L. K. Norford. 2019. LESS: LargE-scale remote sensing data and image simulation framework over heterogeneous 3D scenes. Remote Sensing of Environment 221:695–706.\n\n\nSelan, J. 2005. Using lookup tables to accelerate color transformations. GPU Gems 2:381–392.\n\n\nShiklomanov, A. N., M. C. Dietze, I. Fer, T. Viskari, and S. P. Serbin. 2021. Cutting out the middleman: Calibrating and validating a dynamic vegetation model (ED2-PROSPECT5) using remotely sensed surface reflectance. Geoscientific Model Development 14:2603–2633.\n\n\nStern, F. 1964. Transmission of isotropic radiation across an interface between two dielectrics. Applied Optics 3:111–113.\n\n\nVerger, A., F. Baret, and F. Camacho. 2011. Optimal modalities for radiative transfer-neural network estimation of canopy biophysical characteristics: Evaluation over an agricultural area with CHRIS/PROBA observations. Remote Sensing of Environment 115:415–426.\n\n\nVerhoef, W. 1984. Light scattering by leaf layers with application to canopy reflectance modeling: The SAIL model. Remote Sensing of Environment 16:125–141.\n\n\nVerhoef, W. 1985. Earth observation modeling based on layer scattering matrices. Remote Sensing of Environment 17:165–178.\n\n\nVerhoef, W., L. Jia, Q. Xiao, and Z. Su. 2007. Unified optical-thermal four-stream radiative transfer theory for homogeneous vegetation canopies. IEEE Transactions on geoscience and remote sensing 45:1808–1822.\n\n\nVerrelst, J., S. Dethier, J. P. Rivera, J. Munoz-Mari, G. Camps-Valls, and J. Moreno. 2016. Active learning methods for efficient hybrid biophysical variable retrieval. IEEE Geoscience and Remote Sensing Letters 13:1012–1016.\n\n\nVerrelst, J., and J. Rivera. 2017. A global sensitivity analysis toolbox to quantify drivers of vegetation radiative transfer models. Pages 319–339 Sensitivity analysis in earth observation modelling. Elsevier.\n\n\nVerrelst, J., J. P. Rivera, J. Gómez-Dans, G. Camps-Valls, and J. Moreno. 2015. Replacing radiative transfer models by surrogate approximations through machine learning. Pages 633–636 2015 IEEE international geoscience and remote sensing symposium (IGARSS). IEEE.\n\n\nWheeler, R. 2011. Diagram of the internal structure of a leaf. Webpage.\n\n\nWyman, C., and A. Panteleev. 2021. Rearchitecting spatiotemporal resampling for production. Pages 23–41 Proceedings of the conference on high-performance graphics.\n\n\nYang, P., C. van der Tol, T. Yin, and W. Verhoef. 2020. The SPART model: A soil-plant-atmosphere radiative transfer model for satellite measurements in the solar spectrum. Remote Sensing of Environment 247:111870.\n\n\nZhang, Q., X. Xiao, B. Braswell, E. Linder, F. Baret, and B. Moore III. 2005. Estimating light absorption by chlorophyll, leaf and canopy in a deciduous broadleaf forest using MODIS data and a radiative transfer model. Remote Sensing of Environment 99:357–371."
  },
  {
    "objectID": "describing-processing-and-inspecting-the-data.html#description-of-the-data-set",
    "href": "describing-processing-and-inspecting-the-data.html#description-of-the-data-set",
    "title": "5  Describing, processing and inspecting the data",
    "section": "5.1 Description of the data set",
    "text": "5.1 Description of the data set\nWithin the Westwind orchard, 125 trees were identified as target trees of interest. From each of these trees, Momtanu Chakraborty collected five to six leaves, which were subsequently weighed, photographed, dried, and weighed once more. The leaf area was calculated from the photographs. Both leaf area and leaf dry mass are crucial measurements for converting mass-based nitrogen (N%) to area-based nitrogen (Narea) via the leaf mass per area (LMA, Equation 1.3). Subsequently, the dry leaves from each target tree were combined and ground using a Mixer Mill MM 400 laboratory grinder manufactured by Retsch (Haan, North Rhine-Westphalia, Germany). The pulverized samples were sent to the A&L Western Laboratories (Modesto, CA 95351, USA) for nitrogen concentration analysis. In order to determine the nitrogen concentration of the samples, the laboratory employed Kjeldahl digestion.\nRegarding the leaf level data, the Digital Agriculture Laboratory team measured the reflectance and transmittance of all 741 collected leaves utilizing a HR-1024i spectroradiometer manufactured by Spectra Vista Corporation (Poughkeepsie, NY 12603, USA). Consequently, spectroradiometric data was accessible for the five to six individual leaves per tree, while the nitrogen concentration was only available for the combined set of leaves.\nThe hyperspectral images were captured on the 12th of July 2022 by Momtanu Chakraborty and Hamid Jafarbiglu. They utilized the hyperspectral camera Pika L, manufactured by Resonon Inc. (Bozeman, MT 59715, USA), which was mounted on a Matrice 600 drone produced by DJI Technology Co. (Nanshan, Shenzhen, China). The hyperspectral camera gathers data via line-scanning, whereby hyperspectral images are recorded one line of pixels at a time using a two-dimensional dispersing element and a two-dimensional detector array (El Masry and Sun 2010). Although line-scanning makes it more challenging to obtain a stable image, it helps avoid the hot spot effect, which may arise in multispectral images captured around noon (Jafarbiglu and Pourreza 2023). The line-scanning sensor circumvents the hot-spot effect when the scanned line is perpendicular to the angle of solar incidence, i.e., in the east-west direction. Consequently, the hyperspectral images were captured in a north-south orientation.\n\n\nTable 5.1: Overview of the two datasets utilized. It is worth noting that the leaf-level data encompasses both reflectance and transmittance, with 1024 bands available for each.\n\n\n\n\n\n\n\n\n\nLevel\nObservations\nBands\nRange\nSensor\n\n\n\n\nLeaf\n124\n1024\n338 - 2512 nm\nHR-1024i\n\n\nCanopy\n107\n151\n385 - 900 nm\nPika L\n\n\n\n\nAn overview of both the leaf-level and canopy-level data is presented in table 5.1. Initially, there were 125 target trees; however, one collection of leaves was lost, and the drone carrying the hyperspectral camera experienced a crash, leading to differing numbers of observations for the canopy-level data."
  },
  {
    "objectID": "describing-processing-and-inspecting-the-data.html#sec-SRMprocessing",
    "href": "describing-processing-and-inspecting-the-data.html#sec-SRMprocessing",
    "title": "5  Describing, processing and inspecting the data",
    "section": "5.2 Pre-processing the spectroradiometric data",
    "text": "5.2 Pre-processing the spectroradiometric data\nThe leaf-level data acquired from the spectroradiometer required only minimal pre-processing. Any recorded values below zero were adjusted to zero in order to rectify discrepancies. Further processing included removing noisy and overlapping regions to enhance data clarity (as to be seen in figure 5.2). To align the reflectance and transmittance as closely as possible with the nitrogen labels, the weighted mean for every band was computed within each group of leaves from a single tree, whereby the measured leaf weights appropriately served as the statistical weights. The rationale behind this procedure is that heavier leaves have a more significant impact on the nitrogen label of their group, and thus should also exert a more substantial influence on the reflectance and transmittance data.\nTo conform to the requirements of the Prospect-Pro model, the data was interpolated to specific wavelengths between 400 and 2500 nm. This interpolation was performed using local polynomial regression, utilizing the function loess from the R package stats with the parameter span = 0.025 (R Core Team 2022).\n\n\n\nFigure 5.2: This example illustrates the interpolation process using local polynomial regression (A). The smoothing spline was fitted through the data captured by the spectroradiometer, which is unstable at certain points and overlapping at others. The bottom figures display the distribution of the interpolated data for reflectance (B) and transmittance (C), respectively — the red areas display the center 50%, 75%, 95%, and 99% of the data."
  },
  {
    "objectID": "describing-processing-and-inspecting-the-data.html#sec-HSIprocessing",
    "href": "describing-processing-and-inspecting-the-data.html#sec-HSIprocessing",
    "title": "5  Describing, processing and inspecting the data",
    "section": "5.3 Pre-processing of the hyperspectral images",
    "text": "5.3 Pre-processing of the hyperspectral images\nThe acquired hyperspectral images were saved as batches of ENVI-files (.bip, band inter-leaved by line). Each of these files is essentially a three-dimensional array containing up to 2000 × 900 × 200 values: there are 200 bands, 900 pixels per line, and (at most) 2000 lines scanned. Subsequent batches of lines scanned were written to another ENVI-file. Additionally, a single file of irradiance measurements was generated for each batch of ENVI-files captured. The raw data recorded by the sensors were unitless. To convert them to radiance and irradiance, the shutter speeds and the sensor’s sensitivity at each wavelength must be considered. Reflectance can then be calculated from irradiance and radiance as shown in equation 1.2. All these calculations were performed using the Spectronon Pro software by Resonon Inc. (Bozeman, MT 59715, USA). The resulting hyperspectral images contained reflectance data and thus were standardized between 0 and 1.\nThe following step involved the georeferencing the data. Georeferencing is to the process of manipulating geographic data such that it aligns with a known coordinate system, enabling analysis and comparison with other geographic data (Wade et al. 2006). Consequently, each observational unit, in this case the hyperspectral data of every pixel, must be assigned a specific coordinate point. Orthorectification is particularly crucial in this context: aerial images must be processed to ensure they are geometrically accurate, akin to a geographic map. Orthorectification corrects for lens distortion, camera tilt, perspective, and topographic relief. This entire process was also conducted using Spectronon Pro. However, the results were often unsatisfactory, as entire batches appeared distorted. The scanning line of the hyperspectral camera seemed to have varied its scanning angle relative to the flight direction during the drone flight, causing local image tilting. This tilting of the data was not something the georeferencing functions of Spectronon Pro could address. To rectify the tilt, I opted to adjust the cropping polygons during the tree-cropping stage rather than improve the georeferencing, as this was a more straightforward technical solution.\nThe objective of tree cropping is to generate a separate hyperspectral image for each tree in the orchard. This step is essential for computational reasons, as it is impractical to work with the entire dataset simultaneously.2 Dividing the hyperspectral data into multiple files allows subsequent processes to be applied to individual images of cropped trees. For this cropping procedure, polygons defining the precise cut-out area for each tree needed to be established. However, as the hyperspectral images were not always accurately georeferenced, they had to be manually compared with the orthomosaic shown in figure 5.1, and the polygons had to be adjusted manually to align with the expected tree coordinates. Once all polygons were defined, the cropping was carried out using Python scripts originally authored by Ali Mohigimi and Yuto Kamiya, in addition to the QGIS software (QGIS Development Team 2022).2 The combined hyperspectral images had an approximate file size of 150 GB, which is far too large for programs to handle all at once.\nOnce all images were cropped, the quality of the cropping was assessed. By employing a simple linear model on a transformation of the image data, it was possible to estimate whether the vegetation (determined by the NDVI) was centred in the cropped image. The fourth column in figure 5.3 displays an instance where the tree is not centred, resulting in a linear model slope that is opposite in direction compared to the others. Consequently, the slope of this straightforward model could serve as an indicator of the centricity of the images, enabling to make necessary readjustments during the cropping stage.\nThe average cropped image had dimensions of 56 × 38 × 200, which translates to over 400,000 values per hyperspectral image. With only 124 observations, such a number of predictors is rather excessive. To address this, the dimensions of the hyperspectral images were reduced by eliminating all spatial dimensions, retaining only the spectral dimension. However, calculating the mean reflectance of the entire image for each spectral band would have diluted the signal due to interference from shadows and soil. Consequently, the cropped images were semantically segmented into bright leaves, obscure areas, and soil, with only the bright leaf areas contributing to the retrieved mean spectral reflectance. Semantic segmentation refers to the task of assigning a class to each pixel in an image, rather than to the image as a whole (Guo et al. 2018). The semantic segmentation was performed using an extreme gradient boosting model with the R package xgboost (Chen et al. 2022). To facilitate learning, various vegetation indices were calculated for each pixel and used as features alongside the greyscale values, as opposed to using the original features.\nA training dataset comprising 690 observations from 23 cropped images was manually created for the machine learning model. The extreme gradient boosting model demonstrated an overall test accuracy of 0.94, with most of the error source stemming from confusion between soil and shadow. The bright leaf area exhibited a test precision of 0.99 and a test recall of 0.97, indicating that almost no non-leaf area was mislabelled as leaf, and very few leaf areas were labelled as non-leaf areas. Examples of the semantically segmented images can be viewed in figure 5.3.\nThe reflectance signal beyond 900 nm wavelength becomes highly unstable due to water vapour interference, as illustrated in figure 1.3, and does not align with the canopy’s expected magnitude of reflectance. Consequently, the data was further reduced by discarding any bands beyond 900 nm wavelength. This reduction meant that the reflectance of each tree was effectively condensed to a vector containing only 161 values.\n\n\n\n\nFigure 5.3: Here, four examples of cropped trees are presented. From the original hyperspectral data, the NDVI, along with several other vegetation indices, was calculated (A). Using this information, an XGBoost model semantically segmented the cropped image (B). The slope of a linear regression model, fitted on the mean vertical NDVI values, indicated how well the cropped image was centred around the tree (C). From only the pixels classified as bright leaf area, the mean reflectance was calculated for further use (D)."
  },
  {
    "objectID": "describing-processing-and-inspecting-the-data.html#sec-normalization",
    "href": "describing-processing-and-inspecting-the-data.html#sec-normalization",
    "title": "5  Describing, processing and inspecting the data",
    "section": "5.4 Z-score normalization",
    "text": "5.4 Z-score normalization\nIn multiple instances so far, one could observe that the spectral signature of plants follows a specific pattern, consistently showing different magnitudes of reflectance for the same wavelengths (e.g., figure 5.3 at the bottom). Light absorption is typically higher in the red and blue band areas, while it is lower in the green, red edge, and near-infrared areas. The variance of the collected data at each wavelength is not absolute but rather proportional to the reflectance’s magnitude. Importantly, the differing magnitudes of the variables do not correspond to their relative importance for predicting crop nitrogen. However, if left untreated, variables with larger magnitudes and variances may unjustly dominate certain models. A common strategy employed in machine learning to address this issue is z-score normalization. With respect to a single vector \\(\\mathbf x\\), z-score normalization can be expressed as follows.\n\\[\\mathbf z = \\frac{\\mathbf x - \\mu_x}{\\sigma_x} \\tag{5.1}\\]\nHere, \\(\\mu_x\\) represents the mean of \\(\\mathbf x\\), \\(\\sigma_x\\) denotes the standard deviation of \\(\\mathbf x\\), and \\(\\mathbf z\\) is the z-score normalized vector. This procedure creates a vector \\(\\mathbf z\\) which has a mean of \\(\\mu_z = 0\\) and a variance of \\(\\sigma_z^2 = 1\\), as illustrated graphically in figure 5.4. Z-score normalization of each column of the input data matrix \\(\\mathbf X\\) offers multiple benefits. It results in a homogeneous treatment of the error and enables iterative optimization algorithms to converge more quickly in finding the parameters of machine learning models (Geladi and Kowalski 1986, Ioffe and Szegedy 2015). Therefore, it streamlines the training process of machine learning models — particularly when gradient descent is employed in the training process (Nawi et al. 2013).\nIn addition to addressing the issue of equal variable importance, z-score normalization enhances the interpretability of many models, as coefficients are no longer relative to the variable magnitude. For these reasons, z-score normalization was applied to both leaf-level and canopy-level data before proceeding to the modelling phase.\n\n\n\nFigure 5.4: Visual explanation of z-score normalization of a dataset: The variables in the original data might exhibit significantly varying means and variances (A). Therefore, we can scale the variables with respect to their mean (B), their variance (C), or both (D). Adapted from Geladi and Kowalski (1986)."
  },
  {
    "objectID": "describing-processing-and-inspecting-the-data.html#sec-exploratory",
    "href": "describing-processing-and-inspecting-the-data.html#sec-exploratory",
    "title": "5  Describing, processing and inspecting the data",
    "section": "5.5 Exploratory data analysis",
    "text": "5.5 Exploratory data analysis\nIn this section, a superficial exploration of the data sets, including both the predictor data listed in table 5.1 as well as the response, will be conducted.\nAll predictor data sets containing reflectance and transmittance data show extremely high multicollinearity. This becomes evident when examining the correlation matrices (Figure 5.5 A), where bright areas indicate highly collinear variables. The collinearity is further emphasized by a principal component analysis, in which the variance explained by additional principal components rapidly diminishes and falls below 1% after only the third or fourth principal component, depending on the data set (Figure 5.5 D).\nAn inspection of the correlations of single wavelength reflectance or transmittance to the nitrogen concentration in figure 5.5 C reveals that the strongest direct link occurs in the red light area at precisely 700 nm wavelength (\\(r = -0.48\\)) for the leaf-level reflectance data. The correlation to nitrogen of the canopy-level reflectance data roughly matches the leaf-level reflectance data, although it is considerably less pronounced (\\(r = -0.32\\)). The correlation in the red light area can be attributed to the absorption of red light by chlorophyll and its connection to nitrogen.\nInterestingly, the near-infrared and particularly the short-wave-infrared areas (where the absorption spectra of protein reside) appear to be less informative about the foliar nitrogen concentration (Figure 5.5 C). Nevertheless, the information in these areas is independent of the information in the visible light area, as displayed by the correlation matrices for the leaf-level data (Figure 5.5 A).\n\n\n\nFigure 5.5: These plots present the correlation matrix (A), band-wise correlation with foliar nitrogen concentration (B), the z-score normalized data (C) and variance explained by the first few principal components (D) for the three data sets. The correlation matrices were generated using the absolute value of Pearson’s correlation coefficient \\(r\\) to enhance readability. Black areas indicate no correlation, while white areas represent perfect correlation between bands — hence, the diagonal is always white.\n\n\nOverall, the transmittance data exhibits a weaker correlation with nitrogen than the reflectance data. However, there are spikes of negative correlations in the areas where protein reflects minimally — consequently, the correlation is negative in these parts. A similar pattern can be observed for the reflectance data, albeit less pronounced.\nUpon examining the pairs panel in figure 5.6, the measurements reveal notable and positive correlations among wet weight, dry weight, and leaf area. Specifically, the correlation between the wet weight of the leaves and their corresponding leaf area is particularly solid (\\(r=0.91\\)). This finding should hardly come as a surprise.\n\n\n\nFigure 5.6: Pairs panel of the ground truth data, which includes measured leaf traits. The diagonal displays histograms for each variable, while the lower triangle presents pairwise scatterplots. The upper triangle showcases Pearson’s correlation coefficient \\(r\\) and the corresponding p-values. Non-significant correlation coefficients and their p-values are printed in grey.\n\n\nAdditionally, it becomes evident that mass-based nitrogen (N%) and area-based nitrogen (Narea) display a very low correlation (\\(r = 0.093\\)). This observation is particularly surprising, given that the two traits can be converted into each other through leaf mass per area (LMA), as described by equation 1.3. Leaf mass per area, calculated from dry mass and leaf area, can be loosely interpreted as leaf thickness. It is strongly and positively correlated with Narea (\\(r = -0.85\\)), but exhibits a slight negative correlation with N% (\\(r = -0.43\\)). This relationship can be attributed to a dilution effect caused by carbohydrates on nitrogen concentration (N%): higher carbohydrate concentrations result in a measured lower concentration of nitrogen, even if the absolute nitrogen content remains unchanged.\nConsequently, Baret et al. (2007) suggested that Narea should be the preferred metric. Nonetheless, the mass-based nitrogen N% remains the chief determinant in fertilization management decisions, as it is the most important part of equation 1.1. Therefore, I will primarily focus on the estimation of nitrogen concentration in leaves and canopy rather than the area-based nitrogen.\n\n\n\n\nBaret, F., V. Houlès, and M. Guerif. 2007. Quantification of plant stress using remote sensing observations and crop models: The case of nitrogen management. Journal of experimental botany 58:869–880.\n\n\nChen, T., T. He, M. Benesty, V. Khotilovich, Y. Tang, H. Cho, K. Chen, R. Mitchell, I. Cano, T. Zhou, M. Li, J. Xie, M. Lin, Y. Geng, Y. Li, and J. Yuan. 2022. Xgboost: Extreme gradient boosting.\n\n\nEl Masry, G., and D.-W. Sun. 2010. Principles of hyperspectral imaging technology. Pages 3–43 Hyperspectral imaging for food quality analysis and control. Elsevier.\n\n\nGeladi, P., and B. R. Kowalski. 1986. Partial least-squares regression: A tutorial. Analytica chimica acta 185:1–17.\n\n\nGuo, Y., Y. Liu, T. Georgiou, and M. S. Lew. 2018. A review of semantic segmentation using deep neural networks. International journal of multimedia information retrieval 7:87–93.\n\n\nIoffe, S., and C. Szegedy. 2015. Batch normalization: Accelerating deep network training by reducing internal covariate shift. Pages 448–456 International conference on machine learning. pmlr.\n\n\nJafarbiglu, H., and A. Pourreza. 2023. Impact of sun-view geometry on canopy spectral reflectance variability. ISPRS Journal of Photogrammetry and Remote Sensing 196:270–286.\n\n\nNawi, N. M., W. H. Atomi, and M. Z. Rehman. 2013. The effect of data pre-processing on optimized training of artificial neural networks. Procedia Technology 11:32–39.\n\n\nQGIS Development Team. 2022. QGIS geographic information system. QGIS Association.\n\n\nR Core Team. 2022. R: A language and environment for statistical computing. R Foundation for Statistical Computing, Vienna, Austria.\n\n\nWade, T., S. Sommer, and others. 2006. A to z GIS, an illustrated dictionary of geographic information systems. Esri Press."
  },
  {
    "objectID": "technical-description-of-the-modelling.html#modelling-with-hand-crafted-features",
    "href": "technical-description-of-the-modelling.html#modelling-with-hand-crafted-features",
    "title": "6  Technical description of the modelling",
    "section": "6.1 Modelling with hand-crafted features",
    "text": "6.1 Modelling with hand-crafted features\nThis section presents the approaches taken to model crop nitrogen by employing vegetation indices. Ten relevant vegetation indices were computed according to the equations specified in table 2.1. While a myriad of vegetation indices exist to model various plant traits, the focus in this thesis was placed on indices that have been utilized for modelling crop nitrogen in scientific literature, as documented by Herrmann et al. (2010) and Tian et al. (2011). Upon calculating the vegetation indices, a simple linear regression model was fitted using ordinary least squares regression. Consequently, every model within the single vegetation indices group in table 6.1 has only two parameters: an intercept (\\(\\beta_0\\)) and a slope (\\(\\beta_1\\)).\nMoreover, multiple linear regression models were evaluated, with all of the vegetation indices initially available. To prevent overfitting, stepwise selection was employed to choose a suitable subset from all the vegetation indices. Utilizing the Bayesian information criterion (Equation 3.3 with \\(k = \\ln n\\)) resulted in superior model performance compared to using the Akaike information criterion. The stepwise regression was executed with the step function from the R package stats (R Core Team 2022), where sequential replacement was the specific strategy of choice (direction = \"both\").\nStepwise selection was also employed as a strategy to identify a suitable subset of bands for a multiple linear model. However, this approach was only used after implementing other algorithms that initially chose a smaller subset of bands from the original data. This was due to the declining performance of stepwise selection as the number of variables added to the model increases (Hastie et al. 2017). Consequently, two algorithms that generate a prior subset of bands were examined in the context of this thesis: the recursive feature selection algorithm and the square feature selection algorithm. Both aim to identify bands that exhibit minimal correlation with one another, and both rely on the covariance matrix (\\(\\boldsymbol \\Sigma\\)) of the z-score normalized data for this purpose.\nThe recursive feature selection algorithm is a straightforward method that iteratively selects bands with the highest pairwise covariance from \\(\\boldsymbol \\Sigma\\), eliminating the one with a higher shared covariance among all other bands. This process is repeated until the dataset is reduced to the desired \\(d\\) dimensions. To refine this approach, \\(d\\) was treated as a hyperparameter and chosen using cross-validation (Table 6.2).\n\n\n\nFigure 6.1: The square feature selection algorithm selects bands based on the covariance matrix (\\(\\boldsymbol \\Sigma\\)). It attempts to fit a square within the area of \\(\\boldsymbol \\Sigma\\) that is larger than a predetermined threshold. In this instance, the square feature selection algorithm was applied to the canopy-level reflectance (A), leaf-level reflectance (B), and leaf-level transmittance (C), respectively. The threshold employed for this illustration was \\(s = 0.95\\), corresponding to the white areas on the matrix diagonals. The numbering of the squares refers to their ordered size. All axes on these plots indicate the wavelength in nanometres.\n\n\nOn the other hand, the square feature selection algorithm seeks to identify a square subset centred on the diagonal of \\(\\boldsymbol \\Sigma\\), with the constraint that the square may only contain covariance values larger than a specific threshold \\(s\\) (Figure 6.1). The centre of the largest possible square corresponds to the selected band. All bands within that square are then removed from \\(\\mathbf X\\), and the procedure is repeated \\(d\\) times to find \\(d\\) uncorrelated bands. As a result, in this implementation, both \\(s\\) and \\(d\\) were treated as hyperparameters that required fine-tuning. The optimal combinations of parameters derived from this fine-tuning process are presented in table 6.2."
  },
  {
    "objectID": "technical-description-of-the-modelling.html#sec-hypertuning",
    "href": "technical-description-of-the-modelling.html#sec-hypertuning",
    "title": "6  Technical description of the modelling",
    "section": "6.2 Training the machine learning models",
    "text": "6.2 Training the machine learning models\nIn general, numerous machine learning models possess the flexibility to fit any given data perfectly. However, the ultimate objective is not a perfect fit but to accurately approximate the true data generating function. To prevent overfitting, these models typically employ parameters that regulate their complexity or the scale of estimated parameters. These parameters, referred to as hyperparameters, are distinct from the model’s internal parameters, as they must be explicitly defined. The optimization of hyperparameters plays a crucial role in ensuring the effective performance of machine learning models. To circumvent overfitting, data is typically divided randomly into training and validation sets. Models are calibrated using the training set, while performance metrics are assessed on the validation set. This approach can lead to noisy performance estimates, particularly in smaller datasets, depending on the arbitrary data split. Consequently, cross-validation has become a widely adopted technique, wherein the dataset \\(\\mathcal D\\) is partitioned into \\(K\\) folds. For each fold \\(k \\in \\{1,2,\\dots,K\\}\\), a model \\(f\\) is trained based on \\(\\mathcal D_{\\lnot k}\\) and validated on \\(\\mathcal D_{k}\\). To further increase the stability of the results, this process may be repeated \\(r\\) times (Stone 1974). Ultimately, the average performance across all folds and repetitions can be employed to assess the model’s effectiveness.\nThe optimized hyperparameters for the machine learning models can be found in table 6.2. These models were developed utilizing the statistical software and programming language R, in conjunction with a variety of packages such as stats, caret, pls, randomForest, xgboost, and Cubist (Liaw and Wiener 2002, Chen et al. 2022, Kuhn 2022, Liland et al. 2022, R Core Team 2022, Kuhn and Quinlan 2023).\n\n\nTable 6.2: List of hyperparameters for the feature selection and machine learning algorithms. The optimized hyperparameters are individually provided for the leaf-level data (LL) both for area- and mass-based nitrogen, and for the canopy-level data (CL).\n\n\n\n\n\n\n\n\n\nMethod\nParameter range\nLL (Narea)\nLL (N%)\nCL\n\n\n\n\nRecursive feature selection\n\\(d \\in [2,10]\\)\n\n9\n8\n4\n\n\nSquare feature selection\n\\(d \\in [2,10]\\)\n\\(s \\in [0.8,1]\\)\n\n7\n0.86\n\n7\n0.92\n\n6\n0.91\n\n\nLasso\n\\(\\lambda \\in [10^{-5},1]\\)\n\n10-5\n10-5\n0.0063\n\n\nRidge\n\\(\\lambda \\in [10^{-5},1]\\)\n\n0.0141\n10-5\n0.0063\n\n\nElastic-net\n\\(\\lambda \\in [10^{-5},1]\\)\n\\(\\alpha \\in [0,1]\\)\n\n10-5\n0.94\n0.001\n1\n0.0398\n0.1\n\n\nPrincipal components\n\\(l \\in [1,50]\\)\n\n19\n19\n5\n\n\nPartial least squares\n\\(l \\in [1,50]\\)\n\n13\n16\n4\n\n\nRandom forest\nntree \\(\\in [50,5000]\\)\nnodesize \\(\\in [1,5]\\)\n\n500\n3\n\n500\n3\n\n500\n5\n\n\n\nExtreme gradient boosting\n\\(\\eta \\in [0.01,1]\\)\nmax_depth \\(\\in [1,10]\\)\n\n0.3\n2\n\n0.1\n2\n\n0.1\n1\n\n\n\nCubist\nrules \\(\\in [2,5]\\)\ncommittees \\(\\in [1,20]\\)\n2\n10\n2\n20\n2\n20"
  },
  {
    "objectID": "technical-description-of-the-modelling.html#running-the-radiative-transfer-models",
    "href": "technical-description-of-the-modelling.html#running-the-radiative-transfer-models",
    "title": "6  Technical description of the modelling",
    "section": "6.3 Running the radiative transfer models",
    "text": "6.3 Running the radiative transfer models\nEstablishing the radiative transfer models proved to be the most labour-intensive task among all modelling approaches. This can be attributed to the highly specialized nature of these models, coupled with the scarcity of guidance available for their application, particularly at the canopy level.\n\nLeaf level radiative modelling\nAt the leaf level, radiative transfer modelling was conducted utilizing Prospect-Pro, which is available as one of the functions incorporated within the R package prospect (Féret and de Boissieu 2022). Generally, the most favourable results were obtained by employing the inversion technique of optimal spectral subdomains, as proposed by Spafford et al. (2021). This method enhances model inversion by concentrating on spectral subdomains for each constituent and maximizing the fit within that range, rather than over the entire spectrum.\n\n\nTable 6.3: Parameter search range for both a conservative parameter estimation and a relaxed parameter estimation with wider lower- and upper bounds.\n\n\n\n\n\n\n\nParameter\nConservative\nRelaxed\n\n\n\n\nLeaf structure parameter\n\\(N\\in[1.5,2.5]\\)\n\\(N\\in[1,3]\\)\n\n\nChlorophyll content\nCarotenoid content\nAnthocyanin content\nTannin content\nEquivalent water thickness\nProtein content\nCarbon-based constituents\nCHL \\(\\in[0,60]\\)\nCAR \\(\\in[0,15]\\)\nANT \\(\\in[0,7.5]\\)\nBROWN \\(= 0\\)\nEWT \\(\\in[0.004,0.012]\\)\nPROT \\(\\in[0.0004,0.005]\\)\nCBC \\(\\in[0.001,0.002]\\)\nCHL \\(\\in[0,80]\\)\nCAR \\(\\in[0,20]\\)\nANT \\(\\in[0,10]\\)\nBROWN \\(= 0\\)\nEWT \\(\\in[0,0.03]\\)\nPROT \\(\\in[0,0.02]\\)\nCBC \\(\\in[0,0.02]\\)\n\n\nMaximum incident angle\n\\(\\alpha = 40\\)\n\\(\\alpha = 40\\)\n\n\n\n\nDuring the initial modelling phase, relatively restrictive box constraints were imposed on the parameters, meaning that no parameter was permitted to exceed the range specified in table 6.3. Possible correlations among parameters were disregarded for constraining the search space. The conservative parameter range was derived from Camino et al. (2021), who retrieved the same parameters from almonds for detecting Xylella fastidiosa.\nNonetheless, as many parameters retrieved by Prospect-Pro in this phase resided at the lower or upper bounds, the parameter restrictions were relaxed in a subsequent phase. Parameters obtained under relaxed constraints generally resulted in a better alignment between simulated and observed data, as well as improved leaf-level predictions of foliar nitrogen concentration. Interestingly, reduced discrepancies between simulated and observed data did not consistently lead to enhanced nitrogen predictions. For instance, increasing the maximum incident angle \\(\\alpha\\) in Prospect-Pro to \\(\\alpha = 80^\\circ\\) decreased the difference between simulated and observed data, but worsened predictions of the foliar nitrogen concentration based on the retrieved parameters. Consequently, the maximum incident angle was set to \\(\\alpha = 40^\\circ\\) as proposed by Féret et al. (2008).\nAfter successfully retrieving the plant parameters, they needed to be associated with the measured nitrogen labels. This was accomplished by employing stepwise selection to a multiple linear model, which allowed for the inclusion of all plant parameters as input variables. The fundamental assumption here is that the foliar nitrogen concentration can be modelled as a linear response to the concentrations of chlorophyll and protein.\n\n\nCanopy level radiative modelling\nTo model radiative transfer at the canopy level, the ray tracing model Less was adapted. This three-dimensional forest scene simulator offers a freely accessible graphical user interface (GUI) and can be downloaded via the model’s website (https://lessrt.org). Unfortunately, Less does not provide an application programming interface (API), limiting customization possibilities for the simulations.\nA virtual scene of an almond tree, where reflectance may interact with neighbouring trees and the soil, was created using a single three-dimensional model of an almond tree. This model was obtained from the cgtrader platform, where it was sold by the anonymous artist XFrog. Less enables users to upload any .obj file and arrange the objects as desired. Thus, a typical orchard scene could be recreated in Less, with a central focus tree surrounded by 24 other trees in a 5 × 5 grid design. The trees were aligned similarly to the average trees in the Westwind orchard, with an inter-row distance of 6.73 m and a distance of 4.56 m between trees along the rows. The generated data cubes had dimensions of 56 × 38 × 200 = 425’600 values, closely corresponding to the average dimensions of the cropped hyperspectral images. The simulated image was specified to be orthographic, akin to the georectified real image (Figure 6.2).\n\n\n\nFigure 6.2: Illustration of the three-dimensional object of an almond tree used in the simulation (A) and the model’s alignment to replicate the orchard scene (B). To generate predictions with Less, observed hyperspectral images (C) must be compared with simulated hyperspectral images (D). It is important to note that the two images shown here are RGB reconstructions derived from hyperspectral data.\n\n\nLess requires defining camera settings that closely approximate the actual settings on the day of data capture. In order to recreate the conditions of the data capture, the camera distance to the ground was set at 100 m above ground level. Simulated spectral bands were configured to align with those from the hyperspectral data. The view zenith angle and view azimuth angle were set to 0° and 180°, respectively. The solar zenith angle was set to 20°, while the solar azimuth angle was set to 240°. Sky cloudiness was not considered.\nThe hyperspectral signatures of leaves in the scene were based on the simulated spectral reflectance and transmittance of Prospect-D. Given that the hyperspectral data did not encompass the short-wave-infrared spectrum, there was no need for Prospect-Pro and its ability to simulate absorption caused by protein. The soil in the simulated scene was assigned the same reflectance as the bare soil in the hyperspectral images of the orchard.\nLess generates output files of simulated radiance in the .bsq format, which closely resembles the data captured by the hyperspectral camera. Consequently, the output of Less had to undergo similar processing steps as real observations to obtain comparable results: calculating reflectance from radiance and irradiance, semantically segmenting the hyperspectral image, and ultimately computing the mean reflectance of the bright canopy. As a result, a single simulated hyperspectral image from Less could be reduced to a vector of reflectance data — represented as one row in the generated look-up table.\nThe look-up table was constructed by running Less for numerous parameter combinations (Table 6.4), with the parameter ranges informed by the retrieved leaf-level ranges. The leaf area index (LAI) was the sole parameter not retrieved by Prospect-D. This parameter was controlled exclusively by the size of the trees in the scene, resulting in a reduced leaf area over the same ground. All generated hyperspectral images were subsequently condensed to their reflectance vectors and stored as rows in a large matrix. This matrix effectively functions as the look-up table, as the exact parameters generating each reflectance entry are known and stored in a separate parameter matrix.\n\n\nTable 6.4: The selected parameters for the look-up table generated using Less. Each possible combination of these parameters was simulated once.\n\n\n\n\n\n\nParameter\nParameter range\n\n\n\n\nChlorophyll\nCHL \\(\\in \\{20, 22.5, 25, 27.5, 30, 32.5, 35, 37.5, 40, 42.5, 45\\}\\)\n\n\nAnthocyanin\nANT \\(\\in \\{2.75, 3.00, 3.25, 3.5, 3.75\\}\\)\n\n\nCarotenoid\nCAR \\(\\in \\{2.0, 3.0, 4.0, 5.0, 6.0\\}\\)\n\n\nCarbon-based constituents\nCBC \\(\\in \\{0.006, 0.007, 0.008, 0.009, 0.010\\}\\)\n\n\nLeaf area index\nLAI \\(\\in \\{1,2,3,4,5,6,7,8,9,10,11,12,13,14,15 \\}\\)\n\n\n\n\nThe look-up table \\(\\mathbf L\\) can be used to make a prediction for a single observation \\(\\mathbf x\\) by identifying the closest match between the observed and simulated reflectance based on a specific cost function \\(J\\). The most direct approach to this involves minimizing the Euclidean norm of the error between the \\(i\\)th simulation in the look-up table \\(\\mathbf L_{(i)}\\) and the observation \\(\\mathbf x\\).\n\\[J(i) = \\| \\mathbf L_{(i)} - \\mathbf x \\|_2^2\n\\qquad\ni^* = \\arg \\min_{i \\in \\{1 .. d\\}} J(i) \\tag{6.1}\\]\nIn this context, \\(i\\) represents the index of the simulated reflectance, and \\(d\\) denotes the total number of simulations in the look-up table. To ensure a consistent treatment of the error, it is crucial that both the look-up table and the observed reflectance undergo z-score normalization prior to determining \\(i^*\\).\nA straightforward method for performing regression using the look-up table \\(\\mathbf L\\) involves calculating the cost \\(J\\) with respect to a single observation for each row in \\(\\mathbf L\\), and then selecting \\(i^*\\) associated with the lowest cost \\(J(i)\\) as written in equation 6.1. Given that the parameter matrix is \\(\\mathbf P\\), the retrieved parameters are \\(\\mathbf P_{(i^*)}\\), or the parameters in the \\(i^*\\)th row of \\(\\mathbf P\\). This implies that the retrieved parameters may only be any combination of those listed in table 6.4, resulting in discrete predictions.\nTo enable the retrieval of continuous parameters, a hyper-dimensional interpolation must be applied to the look-up table. This involves modelling the cost \\(J\\) with respect to a single observation as a function of the parameters, an approach known as surrogate modelling (Gramacy 2020). Gaussian processes would be the most mathematically elegant surrogate model; however, due to their computational inefficiency, a multicubic polynomial surrogate model was chosen instead.1 To facilitate surrogate modelling, a subset of the parameter matrix \\(\\mathbf P\\) was created after computing \\(J\\), which includes only the closest neighbours of the found parameters \\(\\mathbf P_{(i^*)}\\). The multicubic polynomial was fitted to this subset to model \\(J\\) as a response to the parameters, allowing for easy minimization and therefore the retrieval of smooth parameters.1 Bear in mind that the surrogate model must be re-trained once for each observation, making computational efficiency an important aspect of this step.\n\n\n\n\nCamino, C., R. Calderón, S. Parnell, H. Dierkes, Y. Chemin, M. Román-Écija, M. Montes-Borrego, B. B. Landa, J. A. Navas-Cortes, P. J. Zarco-Tejada, and others. 2021. Detection of xylella fastidiosa in almond orchards by synergic use of an epidemic spread model and remotely sensed plant traits. Remote Sensing of Environment 260:112420.\n\n\nChen, T., T. He, M. Benesty, V. Khotilovich, Y. Tang, H. Cho, K. Chen, R. Mitchell, I. Cano, T. Zhou, M. Li, J. Xie, M. Lin, Y. Geng, Y. Li, and J. Yuan. 2022. Xgboost: Extreme gradient boosting.\n\n\nFéret, J.-B., and F. de Boissieu. 2022. Prospect: PROSPECT leaf radiative transfer model and inversion routines.\n\n\nFéret, J.-B., C. François, G. P. Asner, A. A. Gitelson, R. E. Martin, L. P. Bidel, S. L. Ustin, G. Le Maire, and S. Jacquemoud. 2008. PROSPECT-4 and 5: Advances in the leaf optical properties model separating photosynthetic pigments. Remote Sensing of Environment 112:3030–3043.\n\n\nGramacy, R. B. 2020. Surrogates: Gaussian process modeling, design and  optimization for the applied sciences. Chapman Hall/CRC, Boca Raton, Florida.\n\n\nHastie, T., R. Tibshirani, and R. J. Tibshirani. 2017. Extended comparisons of best subset selection, forward stepwise selection, and the lasso. arXiv preprint arXiv:1707.08692.\n\n\nHerrmann, I., A. Karnieli, D. Bonfil, Y. Cohen, and V. Alchanatis. 2010. SWIR-based spectral indices for assessing nitrogen content in potato fields. International Journal of Remote Sensing 31:5127–5143.\n\n\nKuhn, M. 2022. Caret: Classification and regression training.\n\n\nKuhn, M., and R. Quinlan. 2023. Cubist: Rule- and instance-based regression modeling.\n\n\nLiaw, A., and M. Wiener. 2002. Classification and regression by randomForest. R News 2:18–22.\n\n\nLiland, K. H., B.-H. Mevik, and R. Wehrens. 2022. Pls: Partial least squares and principal component regression.\n\n\nR Core Team. 2022. R: A language and environment for statistical computing. R Foundation for Statistical Computing, Vienna, Austria.\n\n\nSpafford, L., G. Le Maire, A. MacDougall, F. De Boissieu, and J.-B. Feret. 2021. Spectral subdomains and prior estimation of leaf structure improves PROSPECT inversion on reflectance or transmittance alone. Remote Sensing of Environment 252:112176.\n\n\nStone, M. 1974. Cross-validatory choice and assessment of statistical predictions. Journal of the royal statistical society: Series B (Methodological) 36:111–133.\n\n\nTian, Y., X. Yao, J. Yang, W. Cao, D. Hannaway, and Y. Zhu. 2011. Assessing newly developed and published vegetation indices for estimating rice leaf nitrogen concentration with ground-and space-based hyperspectral reflectance. Field Crops Research 120:299–310."
  },
  {
    "objectID": "results-of-the-model-performances.html#performance-on-the-leaf-level",
    "href": "results-of-the-model-performances.html#performance-on-the-leaf-level",
    "title": "7  Results of the model performances",
    "section": "7.1 Performance on the leaf level",
    "text": "7.1 Performance on the leaf level\nAt the leaf level, two related prediction problems were examined: area-based nitrogen (Narea) and mass-based nitrogen (N%). As demonstrated in table 4.1, the leaf-level radiative transfer model Prospect-Pro retrieves plant pigments in per-area units, i.e., independently of leaf thickness.\n\nArea-based nitrogen\nIndeed, Prospect-Pro achieves the best results in predicting area-based nitrogen content with a significant margin (R2 = 0.684). The next best model, the partial least squares regression model, trails Prospect-Pro by 5.8 percentage points (R2 = 0.626). Most of the implemented machine learning algorithms exceed an R2 of 0.5, with the exception of cubist trees (Figure 7.1).\n\n\n\nFigure 7.1: Performance of the different modelling methods in predicting the area-based nitrogen (Narea) on a leaf-level. The value of the performance metric R2 was calculated based on a 50 times repeated 20-fold cross-validation, of which the mean (\\(\\mu\\)) and the standard deviation (\\(\\sigma\\)) are reported. The compact letter display (CLD) next to every bar is derived from a pairwise Wilcoxon rank sum tests. Exact numerical values of the results can be found in the appendix in table 2.\n\n\nInterestingly, the square feature selection algorithm, which is relatively simple to implement, almost keeps pace with the best-performing machine learning methods (R2 = 0.610). Single vegetation indices, on the other hand, do not correlate as well with area-based nitrogen. A single exception is the R434 which is the only vegetation index that utilizes information from blue bands (R2 = 0.255). When combined, vegetation indices perform better, but this approach still falls short compared to most of the machine learning algorithms.\n\n\nMass-based nitrogen\nShifting from area-based nitrogen to mass-based nitrogen, the predictive capability of previously leading models generally declines (Figure 7.2). Prospect-Pro still achieves relatively good results (R2 = 0.453), but is outperformed by one of the machine learning models: the partial least squares regression model (R2 = 0.493). Regrettably, estimating leaf mass per area from Prospect-Pro and using this estimation to convert units yielded worse results than directly applying a multiple linear regression model to the estimated (area-based) retrieved parameters. Meanwhile, directly using leaf mass per area to convert the retrieved parameters would have given the Prospect-Pro an unjust advantage over the machine learning models. However, the promising results of partial least squares regression suggest some potential for improvement in Prospect-Pro (or any related physics-based model) to predict the pigment concentrations.\n\n\n\nFigure 7.2: Performance of the different modelling methods in predicting the mass-based nitrogen (N%) on a leaf-level. The value of the performance metric R2 was calculated based on a 50 times repeated 20-fold cross-validation, of which the mean (\\(\\mu\\)) and the standard deviation (\\(\\sigma\\)) are reported. The compact letter display (CLD) next to every bar is derived from a pairwise Wilcoxon rank sum tests. Exact numerical values of the results can be found in the appendix in table 3.\n\n\nInterestingly, the performance of ridge regression for mass-based nitrogen concentration drops much more than that of lasso regression, although ridge performed slightly worse than lasso on area-based nitrogen as well. Unlike ridge regression, which only shrinks linear model coefficients but never sets them to zero, lasso regression does precisely that: it sets the least important coefficients to zero, effectively leading to variable selection (James et al. 2013). Hence, if lasso regression outperforms ridge regression, this hints to the existence of a small number of relevant bands, while others can be disregarded.\nThe R434 vegetation index, which performed best for area-based nitrogen, fares the worst for mass-based nitrogen. Conversely, all vegetation indices that performed worse than the baseline model \\(f(\\mathbf x) = \\bar y\\) for area-based nitrogen significantly improved in the case of mass-based nitrogen. It is worth noting that vegetation indices, compared to other methods, exclusively utilize reflectance data. A possible explanation for their shortcomings in predicting area-based nitrogen is the correlation between transmittance and leaf mass per area, and subsequently any area-based trait.\nLastly, examining the standard deviation of cross-validated results reveals that the machine learning models in particular have very unstable outcomes (for both area-based and mass-based nitrogen), while Prospect-Pro prediction results appear to be comparatively stable. This can be attributed to the effective degrees of freedom of the models, which is much lower for physics-based models than for any machine-learning model, since there are only a few parameters to be estimated from the data."
  },
  {
    "objectID": "results-of-the-model-performances.html#performance-on-the-canopy-level",
    "href": "results-of-the-model-performances.html#performance-on-the-canopy-level",
    "title": "7  Results of the model performances",
    "section": "7.2 Performance on the canopy level",
    "text": "7.2 Performance on the canopy level\nFocusing on the model performance results at the canopy level, the overall performance significantly declines compared to the leaf level (Figure 7.3). At best, the models appear to explain only 26% of the variance in the measured foliar nitrogen concentration. In this context, dimensionality reduction techniques slightly underperform compared to both lasso regression and elastic-net (R2 = 0.249 and R2 = 0.250, respectively). The gap between the elastic-net and ridge regression (R2 = 0.206) is especially intriguing, considering the mixing parameter (\\(\\alpha = 0.1\\)): the elastic-net coefficient penalization is a blend of 90% \\(\\ell^2\\)-norm and only 10% \\(\\ell^1\\)-norm (Table 6.2). Therefore, it leans heavily towards the penalization applied in ridge regression. However, the ability to completely eliminate coefficients appears to be highly beneficial. This outcome serves as an excellent illustration of the sensitivity of many machine learning models to minor alterations in their hyperparameters.\n\n\n\nFigure 7.3: Performance of the different modelling methods in predicting the mass-based nitrogen (N%) on a canopy-level. The value of the performance metric R2 was calculated based on a 50 times repeated 20-fold cross-validation, of which the mean (\\(\\mu\\)) and the standard deviation (\\(\\sigma\\)) are reported. The compact letter display (CLD) next to every bar is derived from a pairwise Wilcoxon rank sum tests. Exact numerical values of the results can be found in the appendix in table 4.\n\n\nOne of the most striking outcomes is the substantial difference the hyper-dimensional interpolation has on the Less look-up table predictions. When the look-up table is used directly for predictions, the results are underwhelming (R2 = 0.116). However, applying a surrogate model to achieve hyper-dimensional interpolation more than doubles the model performance (R2 = 0.235). Consequently, by implementing the interpolation, the results produced by Less become comparable to machine-learning methods, despite the relatively low resolution of certain parameters in the look-up table.\nIronically, the best-performing model at the canopy level is not the widely praised partial least squares regression model, but rather the combination of square feature selection and the widely criticized stepwise selection (R2 = 0.256).\nIn contrast to most other tested methods, vegetation indices perform rather poorly when applied to canopy-level data. Out of ten assessed vegetation indices, only two (TCARI and R434) manage outperform the baseline model \\(f(\\mathbf x) = \\bar y\\). Notably, the R434 vegetation index, introduced by Tian et al. (2011), is almost on par with the other more complex methods (R2 = 0.198). It is the only vegetation index that utilizes information from blue bands (as to be seen in table 2.1).\n\n\n\n\nChicco, D., M. J. Warrens, and G. Jurman. 2021. The coefficient of determination r-squared is more informative than SMAPE, MAE, MAPE, MSE and RMSE in regression analysis evaluation. Computer Science 7:e623.\n\n\nJames, G., D. Witten, T. Hastie, and R. Tibshirani. 2013. An introduction to statistical learning. Springer.\n\n\nTian, Y., X. Yao, J. Yang, W. Cao, D. Hannaway, and Y. Zhu. 2011. Assessing newly developed and published vegetation indices for estimating rice leaf nitrogen concentration with ground-and space-based hyperspectral reflectance. Field Crops Research 120:299–310.\n\n\nWillett, J. B., and J. D. Singer. 1988. Another cautionary note about r\\(^{2}\\): Its use in weighted least-squares regression analysis. The American Statistician 42:236–238.\n\n\nWright, S. 1921. Correlation and causation. Journal of Agricultural Research 20:557–585."
  },
  {
    "objectID": "discussion.html#different-modelling-approaches",
    "href": "discussion.html#different-modelling-approaches",
    "title": "8  Discussion",
    "section": "8.1 Different modelling approaches",
    "text": "8.1 Different modelling approaches\nIn this thesis, I compared various approaches to modelling foliar nitrogen concentration in Californian almonds, including vegetation indices and other hand-crafted features, diverse machine learning algorithms, and physics-based radiative transfer models. This model intercomparison highlighted the remarkable capability of machine learning models to identify patterns in the data and generate impressive predictions compared to other methods. Linear models, in particular, performed exceptionally well when combined with linear dimensionality reduction, regularization, or prior feature selection. The underwhelming performance of decision-tree-based models, capable of capturing non-linear relationships, likely stems from the absence of strong non-linear relationships in the data, combined with a low signal-to-noise ratio — a situation where decision-tree-based models easily overfit the data.\nHowever, these data characteristics are highly dependent on the specific dataset, such as the collection time, nitrogen measurement range, and almond cultivar. As a result, the performance of machine learning algorithms can be highly inconsistent. One dataset may favour lasso regularization, while another may be better suited for partial least squares or extreme gradient boosting. This issue underscores the primary challenge of machine learning models in this context: the lack of generalizability. A model trained in one setting often loses predictive power in another (Verrelst et al. 2019). Ideally, the training dataset should encompass all necessary variance, and the test set should reflect real-world deviations. However, acquiring such a dataset for agricultural practice would be extremely difficult.\nIn contrast, physics-based models promise to address this generalizability problem (Verrelst et al. 2019, Berger et al. 2020). Identifying the correct functional form of a relationship enables models to reflect non-linear relationships without the need of giving the model more general flexibility. In this thesis, retrieved plant parameters, such as chlorophyll or carotenoid content, were linked to measured nitrogen concentrations. This connection only necessitates a handful of coefficients, contributing to the generalizability of physics-based models.\nThe radiative transfer model Prospect-Pro can be viewed as a dimensionality reduction technique not completely unlike principal component analysis. However, compared to principal components, the latent variables identified by Prospect-Pro have a physical meaning, mostly relating to the content of specific plant pigments responsible for observed reflectance (and transmittance). As a dimensionality reduction technique, Prospect-Pro (and Less by extension) simplifies modelling any plant trait of interest, not just crop nitrogen, representing the highest level of generalizability where the orchard, crop, and response of interest can all vary.\nHowever, discovering the true physical relationship between variables is extremely labour-intensive and stands in a stark contrast to machine learning models, where data gathering is the most time-consuming aspect. However, once a functional form capturing the true relationship is found, physics-based models can enable even better predictions than machine learning models, as presented in section 7.1.1. Moreover, the physics-based modelling process enhances the understanding of nature, a benefit not offered by machine learning models. In particular, complex machine learning models, such as neural networks, are often referred to as black box models (Zhu et al. 2017, Rudin 2019). While they may deliver impressive results, understanding the relationships they have learned can be extremely challenging.\nThe fact that machine learning models do not require prior knowledge and rely solely on data for making predictions makes them highly useful when combined with radiative transfer models. Machine learning models excel at detecting patterns and correlations in high-dimensional spaces, serving as valuable indicators for potential flaws or shortcomings in physics-based models. For instance, the superior performance of some machine learning models in predicting mass-based nitrogen on a leaf-level suggests a knowledge gap. Without machine learning models, determining what model accuracy can realistically be expected would be much more challenging.\nThe limitations of machine learning models can also be applied to vegetation indices. However, this vegetation indices generally performed poorly, especially when only using single vegetation indices. A primary advantage of vegetation indices is their computational efficiency and ease of implementation. However, this stems from a time when computational efficiency was a greater concern than it is today, meaning it is no longer a significant limitation. The results of this thesis suggest that single vegetation indices can hardly compete with either machine learning models or physics-based models. Nevertheless, new vegetation indices continue to be constructed using heuristics such as genetic algorithms (Costa et al. 2020). In this approach, the authors essentially frame the problem in the same manner as a supervised machine learning problem, but they solve it in a computationally inefficient way. Similar to machine learning models, this solution may rely on fortuitous correlations and generally represents an inelegant approach given the widespread availability of machine learning algorithms.\nIt is crucial to repeatedly acknowledge that the distinction between manual feature selection, machine learning, and physics-based models is somewhat arbitrary and exhibits considerable overlap. For example, both vegetation indices and the parameters retrieved by radiative transfer models are still connected to nitrogen measurements via linear regression, which can be considered a machine learning model. This link function could also be any other model, as Verrelst et al. (2019) speaks of model hybridization — machine learning and radiative transfer models are fused. Consequently, machine learning is undoubtedly an invaluable tool for physics-based modelling."
  },
  {
    "objectID": "discussion.html#how-radiative-transfer-models-might-be-improved",
    "href": "discussion.html#how-radiative-transfer-models-might-be-improved",
    "title": "8  Discussion",
    "section": "8.2 How radiative transfer models might be improved",
    "text": "8.2 How radiative transfer models might be improved\nThe machine learning models demonstrated slightly better performance than the radiative transfer models in predicting foliar nitrogen concentration, both at the canopy and leaf levels. This indicates a knowledge gap in the radiative transfer models.\nTo enhance the radiative transfer models employed, several adjustments could be contemplated. For the Prospect model family, the chlorophyll parameter could be divided into two separate estimates for chlorophyll a and b concentrations. This distinction is crucial not only for more accurate chlorophyll content estimation but also for a better explanation of the observed spectral signature. Li et al. (2018) demonstrated significant differences in chlorophyll a to b ratios among deciduous trees, shrubs, herbs, and grasses. The chlorophyll a to b ratio is also time-dependent, suggesting that dynamic models providing prior information could be incorporated. Dynamic crop models could be implemented to account for the change of the chlorophyll a to b ratio over time. Additionally, such models could also account for the accumulation of carbon-based content over time, which dilutes leaf nitrogen and thus reduces its measured concentration, even though the absolute nitrogen content may remain constant.\nIn addition, prior information about leaf parameter distributions (instead of only box constraints) could be utilized for the inversion of the radiative transfer model, for instance, by adopting a Bayesian optimization method instead of a maximum likelihood estimation. While these approaches are considerably more computationally intensive, they offer the added benefit of uncertainty estimates for all parameters.\nThe implementation of a ray tracing model like Less, as presented in this thesis, primarily serves as a proof-of-concept and offers numerous opportunities for improvement. For instance, trees could be generated rather than hand-crafted by utilizing models such as Helios (Bailey 2019). This approach would enable the more precise integration of plant parameters, such as leaf area index, tree size and geometry, and leaf inclination distribution function, all of which influence the spectral signature of trees (Guyot et al. 1989, Bailey and Mahaffee 2017). Some of these parameters can be quickly measured using terrestrial LiDAR scanning to support modelling, as proposed by Bailey and Mahaffee (2017). Less simulates leaves as Lambertian planes, which reflect light equally in all directions — which constitutes a certain departure from reality. In fact, reflectance depends on the solar incidence angle and viewing angle, together referred to as the bidirectional reflectance distribution function. Therefore, a more realistic ray tracing model simulating canopy reflectance should incorporate this process as well. However, measuring the bidirectional reflectance distribution function presents challenges due to the need to evaluate every possible combination of viewing and incidence angles for each material modelled.\nFinally, such comprehensive models would necessitate a large-scale sensitivity analysis to better understand the impact of parameters on the reflectance."
  },
  {
    "objectID": "discussion.html#general-possibilities-for-improvement",
    "href": "discussion.html#general-possibilities-for-improvement",
    "title": "8  Discussion",
    "section": "8.3 General possibilities for improvement",
    "text": "8.3 General possibilities for improvement\nThere are several avenues for improvement which could benefit both machine learning and radiative transfer modelling: the spectral range covered by the sensors could be expanded, spatial and temporal dimensions in the data could considered, and the pre-processing of the data could be improved.\nExtending the spectral range of the hyperspectral camera may prove advantageous. The performance results of various models at the canopy level appear to be limited to a maximum of 25%. The canopy level data only spans from 400 to 900 nm in its spectral dimension. Consequently, models trained on data from the hyperspectral camera are confined to the direct relationship between nitrogen and chlorophyll, and any additional correlation with plant pigments absorbing in the visible light spectrum. Incorporating information from the short-wave-infrared region — which covers protein absorption bands — may significantly improve predictions (Camino et al. 2018). While the correlation matrix in figure 5.5 indicates a weaker correlation between short-wave-infrared region reflectance and nitrogen compared to the visible light spectrum, it also reveals that the short-wave-infrared regions are almost entirely uncorrelated with visible light regions. Therefore, crop nitrogen can likely be better modelled when utilizing data from both relevant regions.\nIt is worth noting that although the spectral range covered seems important — particularly with respect to short-wave-infrared — a higher spectral resolution is likely unnecessary. The efficacy of many models requiring information from only a few bands suggests that a small fraction of the number of bands would be sufficient to adequately model crop nitrogen. For example, the best-performing model at the canopy level using the prior square feature selection algorithm only requires six bands for optimal performance (Table 6.2). Thus, adding only a few bands in the short-wave-infrared region may significantly enhance model performance.\nIncorporating spatial information could further improve predictions. One possible approach involves learning the relationship between the shape and size of almond trees and their nitrogen foliar concentration, and using this knowledge to generate a synthetic labelled dataset. This dataset could enable the training of a convolutional neural network to learn the inverse function from spatial data. For example, similar research conducted by Jin et al. (2021) demonstrated the successful training of a convolutional neural network to estimate forest canopy cover from satellite images. The convolutional neural network was initially trained on data generated using the three-dimensional radiative transfer model Rapid and subsequently transferred to real data. This approach was found to enhance accuracy in comparison to a similar model solely trained on real data.\nIn addition to enhancing spectral and spatial information, temporal information could be included. Satellite imagery might be particularly useful for this purpose, as it captures orchards at regular intervals and provides standardized data formats — especially in the context of future imaging spectroscopy satellite missions (Berger et al. 2020).\nSome final improvements could result from refining the data pre-processing steps applied to the hyperspectral images as described in section 5.3. For instance, using seam-carving for tree-cropping in a non-grid manner could result in more precise tree cropping and subsequently improve the prediction accuracy."
  },
  {
    "objectID": "discussion.html#addressing-the-quality-and-properties-of-the-data",
    "href": "discussion.html#addressing-the-quality-and-properties-of-the-data",
    "title": "8  Discussion",
    "section": "8.4 Addressing the quality and properties of the data",
    "text": "8.4 Addressing the quality and properties of the data\nThus far, the attention has been solely directed towards potential enhancements in modelling or expanding the spectral, spatial, or temporal range or resolution of the data. In contrast, the ground-truth data utilized throughout this thesis was — as its name suggests — assumed to be fixed and entirely accurate. This assumption does not truly represent the real-world situation, as the ground-truth data is likely to contain considerable noise. As a result, fitting models to such noisy data can be challenging and give a wrong impression of the model’s predictive power. After all, the notion that feeding low-quality data into a computational system leads to unfavourable outcomes has been recognized even before the emergence of modern computers.\n\n“On two occasions I have been asked [by members of Parliament], ‘Pray, Mr. Babbage, if you put into the machine wrong figures, will the right answers come out?’ … I am not able rightly to apprehend the kind of confusion of ideas that could provoke such a question.”\nCharles Babbage\n\nBurke et al. (2021) examined the implications of employing unreliable ground-truth data in remote sensing applications. Utilizing noisy data for calibrating models is not inherently problematic, provided that the data is unbiased. Nevertheless, a discrepancy between the measured nitrogen concentration and the actual tree-wide foliar nitrogen concentration can result in a substantial underestimation of model performance. But where could such noise in the labels come from?\nFirst, the nitrogen measurements might contain substantial noise arising from the sample preparation, equipment failures, and also human error (Sáez-Plaza et al. 2013). Thus, the nitrogen measurements themselves are not an absolute ground truth, even with respect to the leaves.\nSecond, there exists a considerable disconnect between the nitrogen concentration of the sampled leaves and that of the entire tree. Previous research has shown that there is a high within-tree variance of the foliar nitrogen concentration (Khalsa and Brown 2018). Moreover, the tree crown typically contains more nitrogen than the bottom leaves due to its higher photosynthetic activity. Leaves sampled from a different area than that observed by the drones can also contribute to the noise.\nThe inadequate representation of the true tree-wide nitrogen content is further emphasized by the band-wise correlation with the nitrogen measurements (Figure 5.5): although the band-wise correlation appears similar between the canopy and leaf-level data, the magnitude of the correlation is much greater at the leaf level (\\(r = -0.48\\) and \\(r = -0.32\\), respectively). This strongly indicates a mismatch between leaf-level nitrogen measurements and the true tree-level foliar nitrogen concentration.\nIn summary, canopy-level reflectance data exhibits a weaker correlation with nitrogen concentration compared to leaf-level reflectance data, possibly due to the sampled leaves not accurately representing the true tree-wide nitrogen content. Consequently, the performance of canopy level models may be underestimated, with their actual performance likely being considerably better."
  },
  {
    "objectID": "discussion.html#range-of-the-nitrogen-measurements",
    "href": "discussion.html#range-of-the-nitrogen-measurements",
    "title": "8  Discussion",
    "section": "8.5 Range of the nitrogen measurements",
    "text": "8.5 Range of the nitrogen measurements\nThe data utilized in this thesis was derived from a commercial almond orchard, which applied high nitrogen rates in line with recommendations by the Almond Board of California (Brown et al. 2020). As a result, the measured foliar nitrogen concentrations almost all fell within a healthy range, between 1.96 and 3.17%, suggesting adequate nitrogen supply for most trees (Figure 5.6). According to Micke (1996), the optimal foliar nitrogen concentration would range between 2.2 and 2.5%, meaning that only a few almond trees would benefit from additional fertilization, while many could be considered slightly over-fertilized.\nIt is essential to note that almonds are alternate bearing crops. In 2022, the Westfield almond orchard experienced a weak bearing year, resulting in higher foliar nitrogen concentrations compared to a strong yielding year due to less foliar nitrogen being mobilized for fruit production. Conversely, the Westwind 2021 orchard had lower nitrogen levels, leading to a higher number of nitrogen-deficient trees. This factor significantly contributes to the varying predictive power of the same model from year to year.\nTwo critical implications arise from these observations concerning model evaluation. Firstly, the R2 metric, the most intuitive measure of model performance, is influenced by the response variable’s range, as this range is part of its mathematical definition (Equation 7.1). This implies that a broader range of measured nitrogen concentration generally results in increased R2 values and result in a heightened sense of accuracy. Secondly, crop nitrogen status becomes more predictable when leaf nitrogen concentration is low, and plants exhibit nitrogen deficiency. This is attributed to the visual cues of nitrogen deficiency, manifesting as reduced chlorophyll content and visible leaf yellowing (Hawkesford et al. 2012). In contrast, nitrogen over-abundance leads to chlorophyll saturation without clear visual cues, making remote sensing detection more challenging (Muñoz-Huerta et al. 2013).\nSeveral remote sensing studies investigating nitrogen concentrations have been conducted in tandem with nitrogen trials, where the experimental design specifically foresees certain blocks to be fertilized much less than others, or even not to be fertilized at all. This approach generally creates a wider range of foliar nitrogen, particularly at the lower end, which does not accurately represent real farming conditions. Due to the previously stated reasons, this increase range of the nitrogen labels result in a heightened sense of model accuracy. For instance, Wang et al. (2017) predicted foliar nitrogen concentration in pear leaves from an experiment with application rates ranging between 0 and 990 kg N ha-1 using spectrophotometric measurements. The authors achieved excellent predictions on their test data (R2 = 0.85) and concluded that their method would enable relatively inexpensive nitrogen monitoring in pear orchards. Similar conclusions based on modelling results using data from fertilization trials can be found throughout the scientific literature and for various crops (Zha et al. 2020, Pancorbo et al. 2021, Perich et al. 2021).\nTo ensure the development of remote sensing technologies applicable in commercial agriculture, it is important to test these technologies in settings that accurately reflect commercial farming conditions — especially when the conducted research promises to address the environmental problem of nitrogen leaching, rather than to detect plant stress from nitrogen deficiency. Consequently, further research focusing on remote sensing of crop nitrogen should focus on experimental settings that represent the reality of commercial farms.\n\n\n\n\nBailey, B. N. 2019. Helios: A scalable 3D plant and environmental biophysical modeling framework. Frontiers in Plant Science 10:1185.\n\n\nBailey, B. N., and W. F. Mahaffee. 2017. Rapid measurement of the three-dimensional distribution of leaf orientation and the leaf angle probability density function using terrestrial LiDAR scanning. Remote Sensing of Environment 194:63–76.\n\n\nBerger, K., J. Verrelst, J.-B. Feret, Z. Wang, M. Wocher, M. Strathmann, M. Danner, W. Mauser, and T. Hank. 2020. Crop nitrogen monitoring: Recent progress and principal developments in the context of imaging spectroscopy missions. Remote Sensing of Environment 242:111758.\n\n\nBrown, P. H., S. Saa, S. Muhammad, and S. D. Khalsa. 2020. Nitrogen best management practices. Almond Board of California, 1150 Ninth Street, Suite 1500, Modesto, CA 95354.\n\n\nBurke, M., A. Driscoll, D. B. Lobell, and S. Ermon. 2021. Using satellite imagery to understand and promote sustainable development. Science 371:eabe8628.\n\n\nCamino, C., V. González-Dugo, P. Hernández, J. Sillero, and P. J. Zarco-Tejada. 2018. Improved nitrogen retrievals with airborne-derived fluorescence and plant traits quantified from VNIR-SWIR hyperspectral imagery in the context of precision agriculture. International journal of applied earth observation and geoinformation 70:105–117.\n\n\nCosta, L., L. Nunes, and Y. Ampatzidis. 2020. A new visible band index (vNDVI) for estimating NDVI values on RGB images utilizing genetic algorithms. Computers and Electronics in Agriculture 172:105334.\n\n\nGuyot, G., D. Guyon, and J. Riom. 1989. Factors affecting the spectral response of forest canopies: A review. Geocarto International 4:3–18.\n\n\nHawkesford, M., W. Horst, T. Kichey, H. Lambers, J. Schjoerring, I. S. Møller, and P. White. 2012. Functions of macronutrients. Pages 135–189 Marschner’s mineral nutrition of higher plants. Elsevier.\n\n\nJin, D., J. Qi, H. Huang, and L. Li. 2021. Combining 3D radiative transfer model and convolutional neural network to accurately estimate forest canopy cover from very high-resolution satellite images. IEEE Journal of Selected Topics in Applied Earth Observations and Remote Sensing 14:10953–10963.\n\n\nKhalsa, S. D. S., and P. H. Brown. 2018. Understanding nitrogen cycling in an irrigated deciduous permanent crop. Pages 207–212 XXX international horticultural congress IHC2018: International symposium on water and nutrient relations and management of 1253.\n\n\nLi, Y., N. He, J. Hou, L. Xu, C. Liu, J. Zhang, Q. Wang, X. Zhang, and X. Wu. 2018. Factors influencing leaf chlorophyll content in natural forests at the biome scale. Frontiers in Ecology and Evolution 6:64.\n\n\nMicke, W. 1996. Almond production manual. Regents of the University of California.\n\n\nMuñoz-Huerta, R. F., R. G. Guevara-Gonzalez, L. M. Contreras-Medina, I. Torres-Pacheco, J. Prado-Olivarez, and R. V. Ocampo-Velazquez. 2013. A review of methods for sensing the nitrogen status in plants: Advantages, disadvantages and recent advances. sensors 13:10823–10843.\n\n\nPancorbo, J., C. Camino, M. Alonso-Ayuso, M. Raya-Sereno, I. Gonzalez-Fernandez, J. L. Gabriel, P. J. Zarco-Tejada, and M. Quemada. 2021. Simultaneous assessment of nitrogen and water status in winter wheat using hyperspectral and thermal sensors. European Journal of Agronomy 127:126287.\n\n\nPerich, G., P. Meyer, A. Wieser, and F. Liebisch. 2021. Proximal and drone based hyperspectral sensing for crop nitrogen status detection in historic field trials. Pages 1–5 2021 11th workshop on hyperspectral imaging and signal processing: Evolution in remote sensing (WHISPERS). IEEE.\n\n\nRudin, C. 2019. Stop explaining black box machine learning models for high stakes decisions and use interpretable models instead. Nature machine intelligence 1:206–215.\n\n\nSáez-Plaza, P., M. J. Navas, S. Wybraniec, T. Michałowski, and A. G. Asuero. 2013. An overview of the kjeldahl method of nitrogen determination. Part II. Sample preparation, working scale, instrumental finish, and quality control. Critical Reviews in Analytical Chemistry 43:224–272.\n\n\nVerrelst, J., Z. Malenovskỳ, C. Van der Tol, G. Camps-Valls, J.-P. Gastellu-Etchegorry, P. Lewis, P. North, and J. Moreno. 2019. Quantifying vegetation biophysical variables from imaging spectroscopy data: A review on retrieval methods. Surveys in Geophysics 40:589–629.\n\n\nWang, J., C. Shen, N. Liu, X. Jin, X. Fan, C. Dong, and Y. Xu. 2017. Non-destructive evaluation of the leaf nitrogen concentration by in-field visible/near-infrared spectroscopy in pear orchards. Sensors 17:538.\n\n\nZha, H., Y. Miao, T. Wang, Y. Li, J. Zhang, W. Sun, Z. Feng, and K. Kusnierek. 2020. Improving unmanned aerial vehicle remote sensing-based rice nitrogen nutrition index prediction with machine learning. Remote Sensing 12:215.\n\n\nZhu, X. X., D. Tuia, L. Mou, G.-S. Xia, L. Zhang, F. Xu, and F. Fraundorfer. 2017. Deep learning in remote sensing: A comprehensive review and list of resources. IEEE Geoscience and Remote Sensing Magazine 5:8–36."
  },
  {
    "objectID": "conclusion.html",
    "href": "conclusion.html",
    "title": "9  Conclusion",
    "section": "",
    "text": "In this thesis, I delved into the remote sensing of foliar nitrogen concentration in Californian almond trees. The various methodologies explored can be broadly categorized into three groups: hand-crafted features, machine learning, and radiative transfer models Historically, hand-crafted features, especially single vegetation indices, have been the most prevalently employed approach for modelling crop nitrogen based on reflectance data.\nNonetheless, the findings of this thesis reveal that vegetation indices fall short in comparison to the other examined techniques. Machine learning algorithms on the other hand typically perform well on datasets they have been trained on; however, they often lack generalizability due to their excessive adaptability and absence of prior domain knowledge utilization. Radiative transfer models offer a promising solution to these limitations. They provide a generalizable method for estimating plant characteristics through remote sensing, which can subsequently facilitate the prediction of crop nitrogen.\nRadiative transfer models typically present the challenge model inversion. Solving the model inversion can be accomplished through mathematical optimization, utilization of look-up tables, or the application of machine learning techniques. In this thesis, I have demonstrated that employing a multicubic polynomial surrogate model for the cost function can dramatically enhance the predictions derived from a look-up table almost to the level of the best-performing machine learning models.\nThe slightly superior predictions generated by machine learning models suggest that there is some room for improvement regarding the radiative transfer models. Possible enhancements include examining chlorophyll a and b independently at the leaf-level or improving the representation of the three-dimensional structure of crops at the canopy-level.\nRegarding spectral data, the span of the covered range proves to be more crucial than the spectral resolution. Specifically, the short-wave-infrared region appear to be particularly vital for improving the precision of crop nitrogen estimation.\nA considerable body of research on remote sensing of crop nitrogen has been conducted in conjunction with nitrogen fertilization trials. The artificially heightened range of the measured nitrogen concentrations may inadvertently result in overestimating the accuracy of various models, particularly when numerous observations with low foliar nitrogen concentration are present in the dataset. Consequently, further research aimed at addressing the issue of nitrogen leaching through remote sensing ought to focus on experimental settings that more closely resemble standard practices in commercial agriculture."
  },
  {
    "objectID": "appendix.html",
    "href": "appendix.html",
    "title": "Appendix",
    "section": "",
    "text": "This appendix features a list of abbreviations and symbols used throughout this thesis (Table 1) as well as the numerical values of the performance results of the models tested (Table 2, 3, and 4).\n\n\nTable 1: List of abbreviations. The abbreviations used are informed by the closest literature.\n\n\n\n\n\n\nAbbreviation\nMeaning\n\n\n\n\n\\(\\lambda\\)\nWavelength\n\n\n\\(\\boldsymbol \\rho\\)\nReflectance vector\n\n\n\\(\\rho_\\lambda\\)\nSpectral reflectance at wavelength \\(\\lambda\\).\n\n\n\\(\\boldsymbol \\tau\\)\nTransmittance vector\n\n\n\\(\\tau_\\lambda\\)\nSpectral transmittance at wavelength \\(\\lambda\\).\n\n\n\\(\\text{N}_{\\%}\\)\nMass-based nitrogen, i.e., (foliar) nitrogen concentration.\n\n\n\\(\\text{N}_{\\text {area}}\\)\nArea-based nitrogen.\n\n\nLMA\nLeaf mass per area.\n\n\nLAI\nLeaf area index.\n\n\n\\(\\mathbf X\\)\nDesign matrix, matrix of input variables to a model.\n\n\n\\(\\mathbf x_{(i)}\\)\nThe \\(i\\)th row of the design matrix \\(\\mathbf X\\), i.e., one single observation.\n\n\n\\(\\mathbf y\\)\nResponse vector, vector of output variables from a model.\n\n\n\\(\\mathbf {\\hat y}\\)\nEstimated values of \\(\\mathbf y\\).\n\n\n\\({\\bar y}\\)\nArithmetic mean of all values in \\(\\mathbf y\\).\n\n\n\\(\\mathcal D\\)\nThe entire data set of \\(\\mathbf X\\) and \\(\\mathbf y\\).\n\n\n\\(n\\)\nNumber of observations in \\(\\mathcal D\\).\n\n\n\\(d\\)\nNumber of predictor variables, i.e., number of columns in \\(\\mathbf X\\).\n\n\n\\(p\\)\nNumber of parameters in a model.\n\n\n\\(\\boldsymbol \\Sigma\\)\nCovariance matrix of \\(\\mathbf X\\).\n\n\n\\(\\boldsymbol \\beta\\)\nCoefficient vector (vector of parameters of a linear model).\n\n\n\\(\\boldsymbol \\theta\\)\nParameter vector (vector of parameters of any model).\n\n\n\\(\\mu_\\mathbf{x}\\)\nArithmetic mean of \\(\\mathbf{x}\\).\n\n\n\\(\\sigma_\\mathbf{x}\\)\nStandard deviation of \\(\\mathbf{x}\\).\n\n\n\\(J\\)\nCost function.\n\n\nProspect\nLeaf-level radiative transfer model.\n\n\nLess\nCanopy-level radiative transfer model.\n\n\n\n\n\n\nTable 2: Performances of different modelling methods trying to predict nitrogen per area-based on spectroradiometric data on a leaf level. The root mean squared error (RMSE) and coefficient of determination (R2) were computed based on a 20-fold 50 times repeated cross validation, where the mean and the standard deviation are reported (\\(\\mu ± \\sigma\\)). The compact letter display (CLD) is based on a pairwise Wilcoxon rank sum tests.\n\n\n\n\n\n\n\n\nMethod\nR2\nRMSE [g mm-2]\nCLD\n\n\n\n\nNDVI\n-0.016 ± 0.024\n0.316 ± 0.0037\na\n\n\nNDRE\n0.123 ± 0.007\n0.293 ± 0.0011\nb\n\n\nEVI\n0.115 ± 0.006\n0.295 ± 0.001\nc\n\n\nGCI\n-0.055 ± 0.015\n0.322 ± 0.0023\nd\n\n\nGNDVI\n-0.048 ± 0.013\n0.321 ± 0.002\nd\n\n\nMCARI\n0.01 ± 0.014\n0.312 ± 0.0021\ne\n\n\nRECI\n0.128 ± 0.004\n0.292 ± 8e-04\nf\n\n\nTCARI\n-0.016 ± 0.005\n0.316 ± 7e-04\na\n\n\nWDRVI\n0.011 ± 0.016\n0.312 ± 0.0025\ne\n\n\nR434\n0.255 ± 0.008\n0.27 ± 0.0014\ng\n\n\nCombined vegetation indices\n0.464 ± 0.019\n0.229 ± 0.004\nh\n\n\nRecursive feature selection\n0.544 ± 0.01\n0.211 ± 0.0024\ni\n\n\nSquare feature selection\n0.61 ± 0.007\n0.195 ± 0.0019\nj\n\n\nLasso\n0.542 ± 0.04\n0.212 ± 0.0089\ni\n\n\nRidge\n0.496 ± 0.007\n0.222 ± 0.0015\nk\n\n\nElastic-net\n0.537 ± 0.049\n0.213 ± 0.0106\ni\n\n\nPrincipal components\n0.614 ± 0.021\n0.195 ± 0.0052\njl\n\n\nPartial least squares\n0.626 ± 0.02\n0.192 ± 0.0052\nl\n\n\nRandom forest\n0.492 ± 0.01\n0.223 ± 0.0021\nk\n\n\nExtreme gradient boosting\n0.548 ± 0.03\n0.21 ± 0.007\ni\n\n\nCubist\n0.276 ± 0.046\n0.266 ± 0.0083\ng\n\n\nProspect-Pro\n0.684 ± 0.004\n0.176 ± 0.0012\nm\n\n\n\n\n\n\nTable 3: Performances of different modelling methods trying to predict foliar nitrogen concentration based on spectroradiometric data on a leaf level. The root mean squared error (RMSE) and coefficient of determination (R2) were computed based on a 20-fold 50 times repeated cross validation, where the mean and the standard deviation are reported (\\(\\mu ± \\sigma\\)). The compact letter display (CLD) is based on a pairwise Wilcoxon rank sum tests.\n\n\n\n\n\n\n\n\nMethod\nR2\nRMSE [%]\nCLD\n\n\n\n\nNDVI\n0.184 ± 0.005\n0.22 ± 7e-04\na\n\n\nNDRE\n0.177 ± 0.005\n0.221 ± 7e-04\nbc\n\n\nEVI\n0.177 ± 0.006\n0.221 ± 7e-04\nbc\n\n\nGCI\n0.089 ± 0.006\n0.233 ± 8e-04\nd\n\n\nGNDVI\n0.093 ± 0.007\n0.232 ± 8e-04\nd\n\n\nMCARI\n0.151 ± 0.005\n0.225 ± 7e-04\ne\n\n\nRECI\n0.174 ± 0.007\n0.222 ± 9e-04\nb\n\n\nTCARI\n0.148 ± 0.006\n0.225 ± 8e-04\ne\n\n\nWDRVI\n0.177 ± 0.005\n0.221 ± 6e-04\nbc\n\n\nR434\n0.065 ± 0.007\n0.236 ± 9e-04\nf\n\n\nCombined vegetation indices\n0.14 ± 0.02\n0.226 ± 0.0026\ne\n\n\nRecursive feature selection\n0.235 ± 0.006\n0.213 ± 9e-04\ng\n\n\nSquare feature selection\n0.22 ± 0.015\n0.215 ± 0.0021\nh\n\n\nLasso\n0.407 ± 0.012\n0.188 ± 0.002\nij\n\n\nRidge\n0.182 ± 0.009\n0.221 ± 0.0012\nac\n\n\nElastic-net\n0.407 ± 0.01\n0.188 ± 0.0016\ni\n\n\nPrincipal components\n0.417 ± 0.017\n0.186 ± 0.0028\nj\n\n\nPartial least squares\n0.493 ± 0.022\n0.174 ± 0.0037\nk\n\n\nRandom forest\n0.27 ± 0.02\n0.208 ± 0.0028\nl\n\n\nExtreme gradient boosting\n0.288 ± 0.05\n0.206 ± 0.0072\nl\n\n\nCubist\n0.384 ± 0.034\n0.191 ± 0.0053\ni\n\n\nProspect-Pro\n0.453 ± 0.005\n0.18 ± 8e-04\nm\n\n\n\n\n\n\nTable 4: Performances of different modelling methods trying to predict foliar nitrogen concentration based on hyperspectral images. The root mean squared error (RMSE) and coefficient of determination (R2) were computed based on a 20-fold 50 times repeated cross validation, where the mean and the standard deviation are reported (\\(\\mu ± \\sigma\\)). The compact letter display (CLD) is based on a pairwise Wilcoxon rank sum tests.\n\n\n\n\n\n\n\n\nMethod\nR2\nRMSE [%]\nCLD\n\n\n\n\nNDVI\n-0.026 ± 0.027\n0.257 ± 0.0034\na\n\n\nNDRE\n-0.003 ± 0.026\n0.254 ± 0.0033\nbc\n\n\nEVI\n-0.082 ± 0.011\n0.264 ± 0.0013\nd\n\n\nGCI\n-0.01 ± 0.026\n0.255 ± 0.0032\nabc\n\n\nGNDVI\n-0.012 ± 0.027\n0.255 ± 0.0034\nabc\n\n\nMCARI\n-0.001 ± 0.019\n0.254 ± 0.0024\nb\n\n\nRECI\n-0.007 ± 0.023\n0.254 ± 0.0029\nabc\n\n\nTCARI\n0.068 ± 0.006\n0.245 ± 8e-04\ne\n\n\nWDRVI\n-0.021 ± 0.023\n0.256 ± 0.0029\nac\n\n\nR434\n0.198 ± 0.007\n0.227 ± 9e-04\nf\n\n\nCombined vegetation indices\n0.237 ± 0.011\n0.221 ± 0.0015\ng\n\n\nRecursive feature selection\n0.142 ± 0.022\n0.235 ± 0.003\nh\n\n\nSquare feature selection\n0.256 ± 0.014\n0.218 ± 0.0021\ni\n\n\nLasso\n0.249 ± 0.012\n0.22 ± 0.0018\ni\n\n\nRidge\n0.206 ± 0.008\n0.226 ± 0.0012\nj\n\n\nElastic-net\n0.25 ± 0.012\n0.219 ± 0.0017\ni\n\n\nPrincipal components\n0.236 ± 0.013\n0.221 ± 0.0019\ng\n\n\nPartial least squares\n0.228 ± 0.013\n0.223 ± 0.0019\ng\n\n\nRandom forest\n0.102 ± 0.032\n0.24 ± 0.0042\nk\n\n\nExtreme gradient boosting\n0.127 ± 0.018\n0.237 ± 0.0024\nhl\n\n\nCubist\n0.175 ± 0.013\n0.23 ± 0.0018\nm\n\n\nLess\n0.116 ± 0.011\n0.237 ± 0.0015\nkl\n\n\nLess + interpolation\n0.235 ± 0.009\n0.22 ± 0.0013\ng"
  },
  {
    "objectID": "references.html",
    "href": "references.html",
    "title": "References",
    "section": "",
    "text": "ABC. 2020. Growing\ngood – almond sustainability. Almond Board of California, 1150 Ninth\nStreet, Suite 1500, Modesto, CA95354.\n\n\nAkaike, H. 1998. Information theory\nand an extension of the maximum likelihood principle. Selected\npapers of Hirotugu Akaike:199–213.\n\n\nAllen, W. A. 1973. Transmission of isotropic\nlight across a dielectric surface in two and three dimensions. JOSA\n63:664–666.\n\n\nAllen, W. A., H. W. Gausman, A. J. Richardson, and J. R. Thomas. 1969.\nInteraction of\nisotropic light with a compact plant leaf. JOSA 59:1376–1379.\n\n\nAllen, W. A., H. Gausman, and A. Richardson. 1973. Willstätter-stoll\ntheory of leaf reflectance evaluated by ray tracing. Applied Optics\n12:2448–2453.\n\n\nAsner, G. P., and R. E. Martin. 2009. Airborne spectranomics: Mapping\ncanopy chemical and taxonomic diversity in tropical forests.\nFrontiers in Ecology and the Environment 7:269–276.\n\n\nAtzberger, C., K. Richter, F. Vuolo, R. Darvishzadeh, and M. Schlerf.\n2011. Why confining to\nvegetation indices? Exploiting the potential of improved spectral\nobservations using radiative transfer models. Pages 263–278 Remote\nsensing for agriculture, ecosystems, and hydrology XIII. SPIE.\n\n\nBailey, B. N. 2019. Helios: A scalable 3D\nplant and environmental biophysical modeling framework. Frontiers in\nPlant Science 10:1185.\n\n\nBailey, B. N., and W. F. Mahaffee. 2017. Rapid measurement of\nthe three-dimensional distribution of leaf orientation and the leaf\nangle probability density function using terrestrial LiDAR scanning.\nRemote Sensing of Environment 194:63–76.\n\n\nBailey, B. N., M. A. Ponce de León, and E. S. Krayenhoff. 2020. One-dimensional models\nof radiation transfer in heterogeneous canopies: A review,\nre-evaluation, and improved model. Geoscientific Model Development\n13:4789–4808.\n\n\nBaret, F., and T. Fourty. 1997. Estimation of leaf water\ncontent and specific leaf weight from reflectance and transmittance\nmeasurements. Agronomie 17:455–464.\n\n\nBaret, F., V. Houlès, and M. Guerif. 2007. Quantification of plant stress\nusing remote sensing observations and crop models: The case of nitrogen\nmanagement. Journal of experimental botany 58:869–880.\n\n\nBaret, F., S. Jacquemoud, G. Guyot, and C. Leprieur. 1992. Modeled analysis of\nthe biophysical nature of spectral shifts and comparison with\ninformation content of broad bands. Remote Sensing of Environment\n41:133–142.\n\n\nBaret, F., S. Jacquemoud, and J. Hanocq. 1993. The soil line concept\nin remote sensing. Remote Sensing Reviews 7:65–82.\n\n\nBarnes, E., T. Clarke, S. Richards, P. Colaizzi, J. Haberland, M.\nKostrzewski, P. Waller, C. Choi, E. Riley, T. Thompson, and others.\n2000. Coincident detection of crop water stress, nitrogen status and\ncanopy density using ground based multispectral data. Page 6 Proceedings\nof the fifth international conference on precision agriculture,\nbloomington, MN, USA.\n\n\nBeer, A. 1852. Bestimmung der absorption des rothen\nlichts in farbigen flussigkeiten. Ann. Physik 162:78–88.\n\n\nBennett, K., and M. Embrechts. 2003. An optimization perspective on\nkernel partial least squares regression. Nato Science Series sub series\nIII computer and systems sciences 190:227–250.\n\n\nBerger, K., C. Atzberger, M. Danner, G. D’Urso, W. Mauser, F. Vuolo, and\nT. Hank. 2018. Evaluation\nof the PROSAIL model capabilities for future hyperspectral model\nenvironments: A review study. Remote Sensing 10:85.\n\n\nBerger, K., J. Verrelst, J.-B. Feret, Z. Wang, M. Wocher, M. Strathmann,\nM. Danner, W. Mauser, and T. Hank. 2020. Crop nitrogen\nmonitoring: Recent progress and principal developments in the context of\nimaging spectroscopy missions. Remote Sensing of Environment\n242:111758.\n\n\nBioucas-Dias, J. M., A. Plaza, G. Camps-Valls, P. Scheunders, N.\nNasrabadi, and J. Chanussot. 2013. Hyperspectral remote\nsensing data analysis and future challenges. IEEE Geoscience and\nremote sensing magazine 1:6–36.\n\n\nBjerga, A., D. Cohen, and C. Hoffman. 2018. California almonds are back\nafter four years of brutal drought. Bloomberg.\n\n\nBloem, E., S. Haneklaus, and E. Schnug. 2005. Influence of nitrogen and\nsulfur fertilization on the alliin content of onions and garlic.\nJournal of Plant Nutrition 27:1827–1839.\n\n\nBlumthaler, M., W. Ambach, and R. Ellinger. 1997. Increase in solar\nUV radiation with altitude. Journal of photochemistry and\nPhotobiology B: Biology 39:130–134.\n\n\nBolster, K. L., M. E. Martin, and J. D. Aber. 1996. Determination of carbon fraction\nand nitrogen concentration in tree foliage by near infrared\nreflectances: A comparison of statistical methods. Canadian journal\nof forest research 26:590–600.\n\n\nBorchers, H. W. 2022. Pracma: Practical\nnumerical math functions.\n\n\nBreiman, L. 2001. Random forests.\nMachine Learning 45:5–32.\n\n\nBrown, P. H., S. Saa, S. Muhammad, and S. D. Khalsa. 2020. Nitrogen best\nmanagement practices. Almond Board of California, 1150 Ninth Street,\nSuite 1500, Modesto, CA 95354.\n\n\nBruno, E. M., B. Goodrich, and R. J. Sexton. 2021. The outlook for\ncalifornia’s almond market. Calif. Almond Acreage Rep 24:9–11.\n\n\nBruno, T. J., and P. D. Svoronos. 2005. CRC handbook of fundamental\nspectroscopic correlation charts. CRC Press.\n\n\nBubeck, S., V. Chandrasekaran, R. Eldan, J. Gehrke, E. Horvitz, E.\nKamar, P. Lee, Y. T. Lee, Y. Li, S. Lundberg, and others. 2023. Sparks of artificial\ngeneral intelligence: Early experiments with gpt-4. arXiv preprint\narXiv:2303.12712.\n\n\nBurke, M., A. Driscoll, D. B. Lobell, and S. Ermon. 2021. Using satellite imagery\nto understand and promote sustainable development. Science\n371:eabe8628.\n\n\nByrnes, J. 2009. Unexploded ordnance\ndetection and mitigation. Springer Science & Business Media.\n\n\nCamino, C., R. Calderón, S. Parnell, H. Dierkes, Y. Chemin, M.\nRomán-Écija, M. Montes-Borrego, B. B. Landa, J. A. Navas-Cortes, P. J.\nZarco-Tejada, and others. 2021. Detection of xylella\nfastidiosa in almond orchards by synergic use of an epidemic spread\nmodel and remotely sensed plant traits. Remote Sensing of\nEnvironment 260:112420.\n\n\nCamino, C., V. González-Dugo, P. Hernández, J. Sillero, and P. J.\nZarco-Tejada. 2018. Improved nitrogen\nretrievals with airborne-derived fluorescence and plant traits\nquantified from VNIR-SWIR hyperspectral imagery in the context of\nprecision agriculture. International journal of applied earth\nobservation and geoinformation 70:105–117.\n\n\nCamps-Valls, G., D. Tuia, L. Gómez-Chova, S. Jiménez, and J. Malo. 2011.\nRemote sensing\nimage processing. Synthesis Lectures on Image, Video, and Multimedia\nProcessing 5:1–192.\n\n\nCastaldi, F., A. Castrignanò, and R. Casa. 2016. A data fusion and\nspatial data analysis approach for the estimation of wheat grain\nnitrogen uptake from satellite data. International Journal of Remote\nSensing 37:4317–4336.\n\n\nCDFA. 2020. California agriculture exports 2019-2020. California\nDepartment of Food and Argiculture, 1220 N Street, Sacramento, CA\n95812.\n\n\nCeres Imaging. 2022. Water stress\nindex. Webpage.\n\n\nChapin, F. S., A. J. Bloom, C. B. Field, and R. H. Waring. 1987. Plant responses to multiple\nenvironmental factors. Bioscience 37:49–57.\n\n\nChen, T., and C. Guestrin. 2016. XGBoost: A scalable tree boosting\nsystem. Pages 785–794 Proceedings of the 22nd acm sigkdd international\nconference on knowledge discovery and data mining.\n\n\nChen, T., T. He, M. Benesty, V. Khotilovich, Y. Tang, H. Cho, K. Chen,\nR. Mitchell, I. Cano, T. Zhou, M. Li, J. Xie, M. Lin, Y. Geng, Y. Li,\nand J. Yuan. 2022. Xgboost: Extreme\ngradient boosting.\n\n\nCheng, X., G. Yang, X. Xu, T. Chen, Z. Li, H. Feng, D. Wang, and others.\n2014. Estimating\ncanopy water content in wheat based on new vegetation water index.\nSpectroscopy and Spectral Analysis 34:3391–3396.\n\n\nChicco, D., M. J. Warrens, and G. Jurman. 2021. The coefficient of\ndetermination r-squared is more informative than SMAPE,\nMAE, MAPE, MSE and\nRMSE in regression analysis evaluation. Computer\nScience 7:e623.\n\n\nChlingaryan, A., S. Sukkarieh, and B. Whelan. 2018. Machine learning\napproaches for crop yield prediction and nitrogen status estimation in\nprecision agriculture: A review. Computers and Electronics in\nAgriculture 151:61–69.\n\n\nCiani, A. J., C. H. Grein, W. L. Sarney, S. P. Svensson, D. V. Donetski,\nand G. L. Belenky. 2020. A\ncomparison of indium arsenide antimonide and mercury cadmium telluride\nas long wavelength infrared detector materials. Journal of Applied\nPhysics 128:075704.\n\n\nCosta, L., L. Nunes, and Y. Ampatzidis. 2020. A new visible band\nindex (vNDVI) for estimating NDVI values on RGB images utilizing genetic\nalgorithms. Computers and Electronics in Agriculture 172:105334.\n\n\nCui, S., and K. Zhou. 2017. A comparison of the\npredictive potential of various vegetation indices for leaf chlorophyll\ncontent. Earth Science Informatics 10:169–181.\n\n\nDaughtry, C. S., C. Walthall, M. Kim, E. B. De Colstoun, and J.\nMcMurtrey Iii. 2000. Estimating corn\nleaf chlorophyll concentration from leaf and canopy reflectance.\nRemote Sensing of Environment 74:229–239.\n\n\nDaun, K. J. 2017. Inverse problems\nin radiative transfer. Pages 1–51. Springer International\nPublishing.\n\n\nde la Riva, E. G., M. Olmo, H. Poorter, J. L. Ubera, and R. Villar.\n2016. Leaf mass\nper area (LMA) and its relationship with leaf structure and anatomy in\n34 mediterranean woody species along a water availability gradient.\nPloS one 11:e0148788.\n\n\nDegrave, J., F. Felici, J. Buchli, M. Neunert, B. Tracey, F. Carpanese,\nT. Ewalds, R. Hafner, A. Abdolmaleki, D. de Las Casas, and others. 2022.\nMagnetic control of\ntokamak plasmas through deep reinforcement learning. Nature\n602:414–419.\n\n\nDoktor, D., A. Lausch, D. Spengler, and M. Thurner. 2014. Extraction of plant\nphysiological status from hyperspectral signatures using machine\nlearning methods. Remote Sensing 6:12247–12274.\n\n\nDWR. 2015. California climate science and data for water resources\nmanagement. California Department of Water Resources, 715 P Street\nSacramento, CA 95814.\n\n\nDWR. 2022. California’s water supply strategy – adapting to a hotter,\ndrier future. California Department of Water Resources, 715 P Street,\nSacramento, CA 95814.\n\n\nDyson, M. 2021. Competing\nshort-wavelength infra-red sensing technologies. Blog post.\n\n\nEl Masry, G., and D.-W. Sun. 2010. Principles of\nhyperspectral imaging technology. Pages 3–43 Hyperspectral imaging\nfor food quality analysis and control. Elsevier.\n\n\nEvans, J. R. 1989. Photosynthesis and nitrogen\nrelationships in leaves of C3 plants. Oecologia 78:9–19.\n\n\nFéret, J.-B., K. Berger, F. De Boissieu, and Z. Malenovskỳ. 2021. PROSPECT-PRO for\nestimating content of nitrogen-containing leaf proteins and other\ncarbon-based constituents. Remote Sensing of Environment 252:112173.\n\n\nFéret, J.-B., and F. de Boissieu. 2022b. Prosail: PROSAIL leaf and\ncanopy radiative transfer model and inversion routines.\n\n\nFéret, J.-B., and F. de Boissieu. 2022a. Prospect: PROSPECT leaf\nradiative transfer model and inversion routines.\n\n\nFéret, J.-B., C. François, G. P. Asner, A. A. Gitelson, R. E. Martin, L.\nP. Bidel, S. L. Ustin, G. Le Maire, and S. Jacquemoud. 2008. PROSPECT-4 and 5:\nAdvances in the leaf optical properties model separating photosynthetic\npigments. Remote Sensing of Environment 112:3030–3043.\n\n\nFourty, T., and F. Baret. 1998. On spectral estimates of\nfresh leaf biochemistry. International Journal of Remote Sensing\n19:1283–1297.\n\n\nFourty, T., F. Baret, S. Jacquemoud, G. Schmuck, and J. Verdebout. 1996.\nLeaf optical\nproperties with explicit description of its biochemical composition:\nDirect and inverse problems. Remote Sensing of Environment\n56:104–117.\n\n\nFresnel, A. 1821. Note sur le calcul des teintes que la polarisation\ndéveloppe dans leslames cristallisées. Annales\nde Chimie et de Physique 17:102–111.\n\n\nFridman, L. 2019. Deep\nlearning basics. Lecture.\n\n\nFu, Y., G. Yang, Z. Li, X. Song, Z. Li, X. Xu, P. Wang, and C. Zhao.\n2020. Winter wheat nitrogen\nstatus estimation using UAV-based RGB imagery and gaussian processes\nregression. Remote Sensing 12:3778.\n\n\nGao, B.-C., M. J. Montes, C. O. Davis, and A. F. Goetz. 2009. Atmospheric correction\nalgorithms for hyperspectral remote sensing data of land and ocean.\nRemote Sensing of Environment 113:S17–S24.\n\n\nGauss, C. F. 1809. Theoria motus corporum coelestium in sectionibus\nconicis solem ambientium auctore carolo friderico gauss. Sumtibus Frid.\nPerthes et IH Besser.\n\n\nGeladi, P., and B. R. Kowalski. 1986. Partial\nleast-squares regression: A tutorial. Analytica chimica acta\n185:1–17.\n\n\nGewali, U. B., S. T. Monteiro, and E. Saber. 2018. Machine learning based\nhyperspectral image analysis: A survey. arXiv.\n\n\nGitelson, A. A. 2004. Wide dynamic range\nvegetation index for remote quantification of biophysical\ncharacteristics of vegetation. Journal of Plant Physiology\n161:165–173.\n\n\nGitelson, A. A., Y. Gritz, and M. N. Merzlyak. 2003. Relationships between\nleaf chlorophyll content and spectral reflectance and algorithms for\nnon-destructive chlorophyll assessment in higher plant leaves.\nJournal of Plant Physiology 160:271–282.\n\n\nGitelson, A. A., Y. J. Kaufman, and M. N. Merzlyak. 1996. Use of a green\nchannel in remote sensing of global vegetation from EOS-MODIS.\nRemote Sensing of Environment 58:289–298.\n\n\nGoulet, V. 2016. Expint: Exponential\nintegral and incomplete gamma function.\n\n\nGramacy, R. B. 2020. Surrogates: Gaussian process modeling,\ndesign and  optimization for the applied sciences. Chapman Hall/CRC,\nBoca Raton, Florida.\n\n\nGrossman, Y., S. Ustin, S. Jacquemoud, E. Sanderson, G. Schmuck, and J.\nVerdebout. 1996. Critique of stepwise\nmultiple linear regression for the extraction of leaf biochemistry\ninformation from leaf reflectance data. Remote Sensing of\nEnvironment 56:182–193.\n\n\nGuerrero, A., S. De Neve, and A. M. Mouazen. 2021. Current sensor\ntechnologies for in situ and on-line measurement of soil nitrogen for\nvariable rate fertilization: A review. Advances in Agronomy\n168:1–38.\n\n\nGuo, Y., Y. Liu, T. Georgiou, and M. S. Lew. 2018. A review of semantic\nsegmentation using deep neural networks. International journal of\nmultimedia information retrieval 7:87–93.\n\n\nGuyot, G., D. Guyon, and J. Riom. 1989. Factors affecting the\nspectral response of forest canopies: A review. Geocarto\nInternational 4:3–18.\n\n\nHaboudane, D., J. R. Miller, N. Tremblay, P. J. Zarco-Tejada, and L.\nDextraze. 2002. Integrated\nnarrow-band vegetation indices for prediction of crop chlorophyll\ncontent for application to precision agriculture. Remote Sensing of\nEnvironment 81:416–426.\n\n\nHagen, N. A., and M. W. Kudenov. 2013. Review of snapshot\nspectral imaging technologies. Optical Engineering 52:090901.\n\n\nHank, T. B., K. Berger, H. Bach, J. G. Clevers, A. Gitelson, P.\nZarco-Tejada, and W. Mauser. 2019. Spaceborne imaging\nspectroscopy for sustainable agriculture: Contributions and\nchallenges. Surveys in Geophysics 40:515–551.\n\n\nHansen, P., and J. Schjoerring. 2003. Reflectance\nmeasurement of canopy biomass and nitrogen status in wheat crops using\nnormalized difference vegetation indices and partial least squares\nregression. Remote Sensing of Environment 86:542–553.\n\n\nHastie, T., R. Tibshirani, and R. J. Tibshirani. 2017. Extended comparisons of\nbest subset selection, forward stepwise selection, and the lasso.\narXiv preprint arXiv:1707.08692.\n\n\nHawkesford, M., W. Horst, T. Kichey, H. Lambers, J. Schjoerring, I. S.\nMøller, and P. White. 2012. Functions of\nmacronutrients. Pages 135–189 Marschner’s mineral nutrition of\nhigher plants. Elsevier.\n\n\nHerrmann, I., A. Karnieli, D. Bonfil, Y. Cohen, and V. Alchanatis. 2010.\nSWIR-based spectral\nindices for assessing nitrogen content in potato fields.\nInternational Journal of Remote Sensing 31:5127–5143.\n\n\nHolthaus, E. 2015. 10 percent of california’s water goes to almond\nfarming. That’s nuts.’. Slate Magazine.\n\n\nHomolová, L., Z. Malenovskỳ, J. G. Clevers, G. Garcı́a-Santos, and M. E.\nSchaepman. 2013. Review of\noptical-based remote sensing for plant trait mapping. Ecological\nComplexity 15:1–16.\n\n\nHosgood, B., S. Jacquemoud, G. Andreoli, J. Verdebout, G. Pedrini, and\nG. Schmuck. 1995. Leaf optical properties experiment 93 (LOPEX93).\nReport EUR 16095.\n\n\nHuete, A. R. 1988. A soil-adjusted\nvegetation index (SAVI). Remote Sensing of Environment 25:295–309.\n\n\nHuete, A., K. Didan, T. Miura, E. P. Rodriguez, X. Gao, and L. G.\nFerreira. 2002. Overview of the\nradiometric and biophysical performance of the MODIS vegetation\nindices. Remote Sensing of Environment 83:195–213.\n\n\nHunt Jr, E. R., P. C. Doraiswamy, J. E. McMurtrey, C. S. Daughtry, E. M.\nPerry, and B. Akhmedov. 2013. A visible band index\nfor remote sensing leaf chlorophyll content at the canopy scale.\nInternational journal of applied earth observation and geoinformation\n21:103–112.\n\n\nIhuoma, S. O., and C. A. Madramootoo. 2017. Recent advances in\ncrop water stress detection. Computers and Electronics in\nAgriculture 141:267–275.\n\n\nInoue, Y., E. Sakaiya, Y. Zhu, and W. Takahashi. 2012. Diagnostic mapping of\ncanopy nitrogen content in rice based on hyperspectral measurements.\nRemote Sensing of Environment 126:210–221.\n\n\nIoffe, S., and C. Szegedy. 2015. Batch normalization: Accelerating deep\nnetwork training by reducing internal covariate shift. Pages 448–456\nInternational conference on machine learning. pmlr.\n\n\nISO. 2022. Thermal insulation — heat transfer by radiation — vocabulary.\nStandard, International Organization for Standardization, Geneva, CH.\n\n\nJackson, R. D., S. Idso, R. Reginato, and P. Pinter Jr. 1981. Canopy temperature as a\ncrop water stress indicator. Water resources research 17:1133–1138.\n\n\nJacquemoud, S. 1992. Utilisation de la haute resolution spectrale pour\nl’etude des couverts vegetaux: Developpement d’un modele de reflectance\nspectrale. PhD thesis, Université Paris Diderot-Paris 7.\n\n\nJacquemoud, S., C. Bacour, H. Poilve, and J.-P. Frangi. 2000. Comparison of four\nradiative transfer models to simulate plant canopies reflectance: Direct\nand inverse mode. Remote Sensing of Environment 74:471–481.\n\n\nJacquemoud, S., and F. Baret. 1990. PROSPECT: A model of\nleaf optical properties spectra. Remote Sensing of Environment\n34:75–91.\n\n\nJacquemoud, S., S. Ustin, J. Verdebout, G. Schmuck, G. Andreoli, and B.\nHosgood. 1996. Estimating leaf\nbiochemistry using the PROSPECT leaf optical properties model.\nRemote Sensing of Environment 56:194–202.\n\n\nJacquemoud, S., W. Verhoef, F. Baret, C. Bacour, P. Zarco-Tejada, G.\nAsner, C. François, and S. Ustin. 2009. PROSPECT + SAIL models:\nA review of use for vegetation characterization. Remote Sensing of\nEnvironment 113:S56–S66.\n\n\nJafarbiglu, H., and A. Pourreza. 2022. A comprehensive\nreview of remote sensing platforms, sensors, and applications in nut\ncrops. Computers and Electronics in Agriculture 197:106844.\n\n\nJafarbiglu, H., and A. Pourreza. 2023. Impact of\nsun-view geometry on canopy spectral reflectance variability. ISPRS\nJournal of Photogrammetry and Remote Sensing 196:270–286.\n\n\nJames, G., D. Witten, T. Hastie, and R. Tibshirani. 2013. An introduction to\nstatistical learning. Springer.\n\n\nJianbo, Q. 2022. LESS user’s manual. 2.0 edition.\n\n\nJin, D., J. Qi, H. Huang, and L. Li. 2021. Combining 3D\nradiative transfer model and convolutional neural network to accurately\nestimate forest canopy cover from very high-resolution satellite\nimages. IEEE Journal of Selected Topics in Applied Earth\nObservations and Remote Sensing 14:10953–10963.\n\n\nJin, X., Z. Li, H. Feng, X. Xu, and G. Yang. 2014. Newly combined\nspectral indices to improve estimation of total leaf chlorophyll content\nin cotton. IEEE Journal of Selected Topics in Applied Earth\nObservations and Remote Sensing 7:4589–4600.\n\n\nJin, Y., B. Chen, B. D. Lampinen, and P. H. Brown. 2020. Advancing agricultural\nproduction with machine learning analytics: Yield determinants for\ncalifornia’s almond orchards. Frontiers in Plant Science 11:290.\n\n\nJohnson, M. D., W. W. Hsieh, A. J. Cannon, A. Davidson, and F. Bédard.\n2016. Crop yield forecasting on the canadian prairies by remotely sensed\nvegetation indices and machine learning methods. Agricultural and forest\nmeteorology 218:74–84.\n\n\nJordan, C. F. 1969. Derivation\nof leaf-area index from quality of light on the forest floor.\nEcology 50:663–666.\n\n\nJordan, M. I., and T. M. Mitchell. 2015. Machine learning: Trends,\nperspectives, and prospects. Science 349:255–260.\n\n\nJumper, J., R. Evans, A. Pritzel, T. Green, M. Figurnov, O. Ronneberger,\nK. Tunyasuvunakool, R. Bates, A. Žı́dek, A. Potapenko, and others. 2021.\nHighly accurate\nprotein structure prediction with AlphaFold. Nature 596:583–589.\n\n\nJustes, E., B. Mary, J.-M. Meynard, J.-M. Machet, and L. Thelier-Huché.\n1994. Determination of\na critical nitrogen dilution curve for winter wheat crops. Annals of\nbotany 74:397–407.\n\n\nKapoor, A., and T. Viraraghavan. 1997. Nitrate\nremoval from drinking water. Journal of environmental engineering\n123:371–380.\n\n\nKaufman, Y. J., and D. Tanre. 1992. Atmospherically resistant\nvegetation index (ARVI) for EOS-MODIS. IEEE Transactions on\nGeoscience and Remote Sensing 30:261–270.\n\n\nKhalsa, S. D. S., and P. H. Brown. 2018. Understanding\nnitrogen cycling in an irrigated deciduous permanent crop. Pages\n207–212 XXX international horticultural congress IHC2018: International\nsymposium on water and nutrient relations and management of 1253.\n\n\nKimes, D., Y. Knyazikhin, J. Privette, A. Abuelgasim, and F. Gao. 2000.\nInversion methods\nfor physically-based models. Remote Sensing Reviews 18:381–439.\n\n\nKokaly, R. F., G. P. Asner, S. V. Ollinger, M. E. Martin, and C. A.\nWessman. 2009. Characterizing canopy\nbiochemistry from imaging spectroscopy and its application to ecosystem\nstudies. Remote Sensing of Environment 113:S78–S91.\n\n\nKuhn, M. 2022. Caret:\nClassification and regression training.\n\n\nKuhn, M., and R. Quinlan. 2023. Cubist: Rule- and\ninstance-based regression modeling.\n\n\nLambert, J. H. 1760. Photometria sive de mensura et gradibus luminis,\ncolorum et umbrae. Sumptibus vidvae E. Klett, typis CP Detleffsen.\n\n\nLegendre, A. M. 1806. Nouvelles méthodes pour la\ndétermination des orbites des comètes; par AM\nlegendre... chez Firmin Didot, libraire pour lew mathematiques, la\nmarine, l ….\n\n\nLi, Y., N. He, J. Hou, L. Xu, C. Liu, J. Zhang, Q. Wang, X. Zhang, and\nX. Wu. 2018. Factors\ninfluencing leaf chlorophyll content in natural forests at the biome\nscale. Frontiers in Ecology and Evolution 6:64.\n\n\nLiaw, A., and M. Wiener. 2002. Classification and\nregression by randomForest. R News 2:18–22.\n\n\nLiland, K. H., B.-H. Mevik, and R. Wehrens. 2022. Pls: Partial least squares\nand principal component regression.\n\n\nLin, D., M. Kettunen, B. Bitterli, J. Pantaleoni, C. Yuksel, and C.\nWyman. 2022. Generalized\nresampled importance sampling: Foundations of ReSTIR. ACM\nTransactions on Graphics (TOG) 41:1–23.\n\n\nLiu, C., X. Zhang, T. T. Nguyen, J. Liu, T. Wu, E. Lee, and X. M. Tu.\n2022. Partial least\nsquares regression and principal component analysis: Similarity and\ndifferences between two popular variable reduction approaches.\nGeneral Psychiatry 35.\n\n\nMalenovskỳ, Z., L. Homolová, R. Zurita-Milla, P. Lukeš, V. Kaplan, J.\nHanuš, J.-P. Gastellu-Etchegorry, and M. E. Schaepman. 2013. Retrieval of spruce\nleaf chlorophyll content from airborne image data using continuum\nremoval and radiative transfer. Remote Sensing of Environment\n131:85–102.\n\n\nMarkov, A. A. 1912. Wahrscheinlichkeitsrechnung. BG Teubner.\n\n\nMcCulloch, W. S., and W. Pitts. 1943. A logical calculus of the ideas\nimmanent in nervous activity. The bulletin of mathematical biophysics\n5:115–133.\n\n\nMehmood, T., and B. Ahmed. 2016. The diversity in the\napplications of partial least squares: An overview. Journal of\nChemometrics 30:4–17.\n\n\nMicke, W. 1996. Almond production manual. Regents of the University of\nCalifornia.\n\n\nMoghimi, A., A. Pourreza, G. Zuniga-Ramirez, L. E. Williams, and M. W.\nFidelibus. 2020. A novel\nmachine learning approach to estimate grapevine leaf nitrogen\nconcentration using aerial multispectral imagery. Remote Sensing\n12:3515.\n\n\nMount, J., and E. Hanak. 2016. Water use in california. Public Policy\nInstitute of California, San Francisco, California 2.\n\n\nMuñoz-Huerta, R. F., R. G. Guevara-Gonzalez, L. M. Contreras-Medina, I.\nTorres-Pacheco, J. Prado-Olivarez, and R. V. Ocampo-Velazquez. 2013. A review of methods for\nsensing the nitrogen status in plants: Advantages, disadvantages and\nrecent advances. sensors 13:10823–10843.\n\n\nNational Renewable Energy Laboratory. 2022. 2000\nASTM standard extraterrestrial spectrum reference e-490-00. Webpage.\n\n\nNawi, N. M., W. H. Atomi, and M. Z. Rehman. 2013. The effect of data\npre-processing on optimized training of artificial neural networks.\nProcedia Technology 11:32–39.\n\n\nNoda, T. R. A. M. C. A. J. K. A. G. L. A. Y. N. A. M. I. A. H. 2023.\nStockfish. https://github.com/official-stockfish/Stockfish; GitHub.\n\n\nOhyama, T. 2010. Nitrogen as a major essential element of plants.\nNitrogen assimilation in plants 37:2–17.\n\n\nOmidi, R., A. Moghimi, A. Pourreza, M. El-Hadedy, and A. S. Eddin. 2020.\nEnsemble\nhyperspectral band selection for detecting nitrogen status in grape\nleaves. IEEE.\n\n\nOpenAI. 2023. GPT-4\ntechnical report. OpenAI.\n\n\nPadilla, F. M., R. de Souza, M. T. Peña-Fleitas, M. Gallardo, C.\nGimenez, and R. B. Thompson. 2018. Different responses of\nvarious chlorophyll meters to increasing nitrogen supply in sweet\npepper. Frontiers in plant science 9:1752.\n\n\nPancorbo, J., C. Camino, M. Alonso-Ayuso, M. Raya-Sereno, I.\nGonzalez-Fernandez, J. L. Gabriel, P. J. Zarco-Tejada, and M. Quemada.\n2021. Simultaneous\nassessment of nitrogen and water status in winter wheat using\nhyperspectral and thermal sensors. European Journal of Agronomy\n127:126287.\n\n\nPathak, T. B., M. L. Maskey, J. A. Dahlberg, F. Kearns, K. M. Bali, and\nD. Zaccaria. 2018. Climate change trends and\nimpacts on california agriculture: A detailed review. Agronomy 8:25.\n\n\nPeddie, J. 2019. Ray\ntracing: A tool for all. Springer.\n\n\nPeñuelas, J., J. Gamon, A. Fredeen, J. Merino, and C. Field. 1994. Reflectance indices\nassociated with physiological changes in nitrogen-and water-limited\nsunflower leaves. Remote Sensing of Environment 48:135–146.\n\n\nPerich, G., P. Meyer, A. Wieser, and F. Liebisch. 2021. Proximal and\ndrone based hyperspectral sensing for crop nitrogen status detection in\nhistoric field trials. Pages 1–5 2021 11th workshop on hyperspectral\nimaging and signal processing: Evolution in remote sensing (WHISPERS).\nIEEE.\n\n\nPierce, F. J., and P. Nowak. 1999. Aspects of\nprecision agriculture. Advances in Agronomy 67:1–85.\n\n\nPlackett, R. L. 1949. A\nhistorical note on the method of least squares. Biometrika\n36:458–460.\n\n\nQGIS Development Team. 2022. QGIS\ngeographic information system. QGIS Association.\n\n\nQi, J., A. Chehbouni, A. R. Huete, Y. H. Kerr, and S. Sorooshian. 1994.\nA modified soil\nadjusted vegetation index. Remote Sensing of Environment 48:119–126.\n\n\nQi, J., J. Jiang, K. Zhou, D. Xie, and H. Huang. 2023. Fast and accurate\nsimulation of canopy reflectance under wavelength-dependent optical\nproperties using a semi-empirical 3D radiative transfer model.\nJournal of Remote Sensing 3:0017.\n\n\nQi, J., D. Xie, D. Guo, and G. Yan. 2017. A large-scale\nemulation system for realistic three-dimensional (3-d) forest\nsimulation. IEEE Journal of Selected Topics in Applied Earth\nObservations and Remote Sensing 10:4834–4843.\n\n\nQi, J., D. Xie, J. Jiang, and H. Huang. 2022. 3D radiative transfer\nmodeling of structurally complex forest canopies through a lightweight\nboundary-based description of leaf clusters. Remote Sensing of\nEnvironment 283:113301.\n\n\nQi, J., D. Xie, T. Yin, G. Yan, J.-P. Gastellu-Etchegorry, L. Li, W.\nZhang, X. Mu, and L. K. Norford. 2019. LESS: LargE-scale\nremote sensing data and image simulation framework over heterogeneous 3D\nscenes. Remote Sensing of Environment 221:695–706.\n\n\nR Core Team. 2022. R: A language\nand environment for statistical computing. R Foundation for\nStatistical Computing, Vienna, Austria.\n\n\nRaun, W. R., G. Johnson, and R. Westerman. 1999. Fertilizer\nnitrogen recovery in long-term continuous winter wheat. Soil Science\nSociety of America Journal 63:645–650.\n\n\nRavikanth, L., D. S. Jayas, N. D. White, P. G. Fields, and D.-W. Sun.\n2017. Extraction of\nspectral information from hyperspectral data and application of\nhyperspectral imaging for food and agricultural products. Food and\nbioprocess technology 10:1–33.\n\n\nRen-hua, Z., N. Rao, and K. Liao. 1996. Approach for a vegetation index\nresistant to atmospheric effect. Journal of Integrative Plant Biology\n38.\n\n\nRichardson, A. J., and C. Wiegand. 1977. Distinguishing vegetation from\nsoil background information. Photogrammetric engineering and remote\nsensing 43:1541–1552.\n\n\nRohde, R. A. 2013. Spectrum\nof solar radiation. Webpage.\n\n\nRombach, R., A. Blattmann, D. Lorenz, P. Esser, and B. Ommer. 2021. High-resolution image synthesis\nwith latent diffusion models.\n\n\nRosenblatt, F. 1958. The\nperceptron: A probabilistic model for information storage and\norganization in the brain. Psychological review 65:386.\n\n\nRosipal, R., and N. Krämer. 2006. Overview and recent advances\nin partial least squares. Pages 34–51 Subspace, latent structure and\nfeature selection: Statistical and optimization perspectives workshop,\nSLSFS 2005, bohinj, slovenia, february 23-25, 2005, revised selected\npapers. Springer.\n\n\nRouse Jr, J. W., R. H. Haas, J. Schell, and D. Deering. 1973. Monitoring the vernal\nadvancement and retrogradation (green wave effect) of natural\nvegetation. Texas A&M University Remote Sensing Center.\n\n\nRudin, C. 2019. Stop\nexplaining black box machine learning models for high stakes decisions\nand use interpretable models instead. Nature machine intelligence\n1:206–215.\n\n\nSáez-Plaza, P., M. J. Navas, S. Wybraniec, T. Michałowski, and A. G.\nAsuero. 2013. An\noverview of the kjeldahl method of nitrogen determination. Part II.\nSample preparation, working scale, instrumental finish, and quality\ncontrol. Critical Reviews in Analytical Chemistry 43:224–272.\n\n\nSamuel, A. L. 1959. Machine learning. The Technology Review 62:42–45.\n\n\nSchirrmann, M., A. Giebel, F. Gleiniger, M. Pflanz, J. Lentschke, and\nK.-H. Dammer. 2016. Monitoring agronomic parameters\nof winter wheat crops with low-cost UAV imagery. Remote Sensing\n8:706.\n\n\nSchowengerdt, R. A. 2006. Remote sensing: Models and methods for image\nprocessing. Elsevier.\n\n\nSelan, J. 2005. Using lookup tables to accelerate color transformations.\nGPU Gems 2:381–392.\n\n\nSerrano, L., J. Penuelas, and S. L. Ustin. 2002. Remote sensing of\nnitrogen and lignin in mediterranean vegetation from AVIRIS data:\nDecomposing biochemical from structural signals. Remote sensing of\nEnvironment 81:355–364.\n\n\nShiklomanov, A. N., M. C. Dietze, I. Fer, T. Viskari, and S. P. Serbin.\n2021. Cutting out the\nmiddleman: Calibrating and validating a dynamic vegetation model\n(ED2-PROSPECT5) using remotely sensed surface reflectance.\nGeoscientific Model Development 14:2603–2633.\n\n\nSilver, D., J. Schrittwieser, K. Simonyan, I. Antonoglou, A. Huang, A.\nGuez, T. Hubert, L. Baker, M. Lai, A. Bolton, and others. 2017. Mastering the game of go\nwithout human knowledge. Nature 550:354–359.\n\n\nSishodia, R. P., R. L. Ray, and S. K. Singh. 2020. Applications of remote sensing\nin precision agriculture: A review. Remote Sensing 12:3136.\n\n\nSmart, D., D. Schellenberg, S. Saa Silva, S. Muhammad, B. Sanden, and P.\nBrown. 2014. Nitrogen use efficiency of california almond orchards using\nadvanced farming practices. Page 487 EGU general assembly conference\nabstracts.\n\n\nSonobe, R., Y. Yamaya, H. Tani, X. Wang, N. Kobayashi, and K. Mochizuki.\n2018. Crop\nclassification from sentinel-2-derived vegetation indices using ensemble\nlearning. Journal of Applied Remote Sensing 12:026019–026019.\n\n\nSpafford, L., G. Le Maire, A. MacDougall, F. De Boissieu, and J.-B.\nFeret. 2021. Spectral subdomains and\nprior estimation of leaf structure improves PROSPECT inversion on\nreflectance or transmittance alone. Remote Sensing of Environment\n252:112176.\n\n\nStark, C. H., and K. G. Richards. 2008. The continuing challenge of\nagricultural nitrogen loss to the environment in the context of global\nchange and advancing research. Dynamic Soil, Dynamic Plant 2:1–12.\n\n\nStern, F. 1964. Transmission of isotropic\nradiation across an interface between two dielectrics. Applied\nOptics 3:111–113.\n\n\nStickler, G., and L. Kyle. 2016. Educational brief – solar radiation and\nthe earth system. National Aeronautics and Space Administration.\n\n\nStone, M. 1974. Cross-validatory\nchoice and assessment of statistical predictions. Journal of the\nroyal statistical society: Series B (Methodological) 36:111–133.\n\n\nTakayama, T., and A. Iwasaki. 2016. Optimal\nwavelength selection on hyperspectral data with fused lasso for biomass\nestimation of tropical rainforests. ISPRS Annals of Photogrammetry,\nRemote Sensing & Spatial Information Sciences 3.\n\n\nThenkabail, P. S., I. Mariotto, M. K. Gumma, E. M. Middleton, D. R.\nLandis, and K. F. Huemmrich. 2013. Selection of\nhyperspectral narrowbands (HNBs) and composition of hyperspectral\ntwoband vegetation indices (HVIs) for biophysical characterization and\ndiscrimination of crop types using field reflectance and hyperion/EO-1\ndata. IEEE Journal of Selected Topics in Applied Earth Observations\nand Remote Sensing 6:427–439.\n\n\nThomas, J. R., and G. F. Oerther. 1972. Estimating\nnitrogen content of sweet pepper leaves by reflectance measurements.\nAgronomy journal 64:11–13.\n\n\nTian, Y., X. Yao, J. Yang, W. Cao, D. Hannaway, and Y. Zhu. 2011. Assessing newly\ndeveloped and published vegetation indices for estimating rice leaf\nnitrogen concentration with ground-and space-based hyperspectral\nreflectance. Field Crops Research 120:299–310.\n\n\nTibshirani, R. 1996. Regression\nshrinkage and selection via the lasso. Journal of the Royal\nStatistical Society. Series B (Methodological) 58:267–288.\n\n\nUSDA. 2021. California almond acreage report. United States Department\nof Agriculture, Pacific Region, P.O. Box 1258, Sacramento, CA 95812.\n\n\nVan den Berg, H. 2018. Occam’s razor:\nFrom ockham’s via moderna to modern data science. Science progress\n101:261–272.\n\n\nVerger, A., F. Baret, and F. Camacho. 2011. Optimal modalities for\nradiative transfer-neural network estimation of canopy biophysical\ncharacteristics: Evaluation over an agricultural area with CHRIS/PROBA\nobservations. Remote Sensing of Environment 115:415–426.\n\n\nVerhoef, W. 1984. Light scattering by\nleaf layers with application to canopy reflectance modeling: The SAIL\nmodel. Remote Sensing of Environment 16:125–141.\n\n\nVerhoef, W. 1985. Earth observation\nmodeling based on layer scattering matrices. Remote Sensing of\nEnvironment 17:165–178.\n\n\nVerhoef, W., L. Jia, Q. Xiao, and Z. Su. 2007. Unified optical-thermal\nfour-stream radiative transfer theory for homogeneous vegetation\ncanopies. IEEE Transactions on geoscience and remote sensing\n45:1808–1822.\n\n\nVerrelst, J., S. Dethier, J. P. Rivera, J. Munoz-Mari, G. Camps-Valls,\nand J. Moreno. 2016. Active learning methods\nfor efficient hybrid biophysical variable retrieval. IEEE Geoscience\nand Remote Sensing Letters 13:1012–1016.\n\n\nVerrelst, J., Z. Malenovskỳ, C. Van der Tol, G. Camps-Valls, J.-P.\nGastellu-Etchegorry, P. Lewis, P. North, and J. Moreno. 2019. Quantifying vegetation\nbiophysical variables from imaging spectroscopy data: A review on\nretrieval methods. Surveys in Geophysics 40:589–629.\n\n\nVerrelst, J., and J. Rivera. 2017. A global\nsensitivity analysis toolbox to quantify drivers of vegetation radiative\ntransfer models. Pages 319–339 Sensitivity analysis in earth\nobservation modelling. Elsevier.\n\n\nVerrelst, J., J. P. Rivera, J. Gómez-Dans, G. Camps-Valls, and J.\nMoreno. 2015. Replacing radiative\ntransfer models by surrogate approximations through machine\nlearning. Pages 633–636 2015 IEEE international geoscience and\nremote sensing symposium (IGARSS). IEEE.\n\n\nViers, J. H., D. Liptzin, T. S. Rosenstock, V. B. Jensen, A. D.\nHollander, A. McNally, A. M. King, G. Kourakos, E. M. Lopez, N. D. L.\nMora, A. FryjoffHung, H. C. Kristin N. Dzurella, S. Laybourne, C.\nMcKenney, J. Darby, J. F. Quinn, and T. Harter. 2012. Assessing nitrate\nin california’s drinking water with a focus on tulare lake basin and\nsalinas valley groundwater. Center for Watershed Sciences,\nUniversity of California, Davis.\n\n\nVineView. 2022. Water index.\nWebpage.\n\n\nVinyals, O., I. Babuschkin, W. M. Czarnecki, M. Mathieu, A. Dudzik, J.\nChung, D. H. Choi, R. Powell, T. Ewalds, P. Georgiev, and others. 2019.\nGrandmaster level in\nStarCraft II using multi-agent reinforcement learning. Nature\n575:350–354.\n\n\nVitousek, P. M., J. D. Aber, R. W. Howarth, G. E. Likens, P. A. Matson,\nD. W. Schindler, W. H. Schlesinger, and D. G. Tilman. 1997. Human\nalteration of the global nitrogen cycle: Sources and consequences.\nEcological applications 7:737–750.\n\n\nWade, T., S. Sommer, and others. 2006. A to z GIS, an illustrated\ndictionary of geographic information systems. Esri Press.\n\n\nWalter, A., R. Finger, R. Huber, and N. Buchmann. 2017. Smart farming is key to\ndeveloping sustainable agriculture. Proceedings of the National\nAcademy of Sciences 114:6148–6150.\n\n\nWang, J., C. Shen, N. Liu, X. Jin, X. Fan, C. Dong, and Y. Xu. 2017. Non-destructive evaluation of\nthe leaf nitrogen concentration by in-field visible/near-infrared\nspectroscopy in pear orchards. Sensors 17:538.\n\n\nWebb, J., P. Sørensen, G. Velthof, B. Amon, M. Pinto, L. Rodhe, E.\nSalomon, N. Hutchings, P. Burczyk, and J. Reid. 2013. An assessment\nof the variation of manure nitrogen efficiency throughout europe and an\nappraisal of means to increase manure-n efficiency. Advances in\nAgronomy 119:371–442.\n\n\nWeber, A., M. Benecke, J. Wendler, A. Sieck, D. Hübner, H. Figgemeier,\nand R. Breiter. 2016. Extended SWIR imaging sensors\nfor hyperspectral imaging applications. Pages 42–56 Image sensing\ntechnologies: Materials, devices, systems, and applications III. SPIE.\n\n\nWheeler, R. 2011. Diagram\nof the internal structure of a leaf. Webpage.\n\n\nWIFSS. 2016. Almonds.\nWestern Institute for Food Safety and Security, 1477 Drew\nAve, Davis, CA 95618.\n\n\nWillett, J. B., and J. D. Singer. 1988. Another cautionary\nnote about r2: Its use in\nweighted least-squares regression analysis. The American\nStatistician 42:236–238.\n\n\nWold, S., A. Ruhe, H. Wold, and W. Dunn Iii. 1984. The collinearity problem in\nlinear regression. The partial least squares (PLS) approach to\ngeneralized inverses. SIAM Journal on Scientific and Statistical\nComputing 5:735–743.\n\n\nWolfert, S., L. Ge, C. Verdouw, and M.-J. Bogaardt. 2017. Big data in smart\nfarming–a review. Agricultural Systems 153:69–80.\n\n\nWright, I. J., P. B. Reich, M. Westoby, D. D. Ackerly, Z. Baruch, F.\nBongers, J. Cavender-Bares, T. Chapin, J. H. Cornelissen, M. Diemer, and\nothers. 2004. The\nworldwide leaf economics spectrum. Nature 428:821–827.\n\n\nWright, S. 1921. Correlation and causation. Journal of Agricultural\nResearch 20:557–585.\n\n\nWyman, C., and A. Panteleev. 2021. Rearchitecting spatiotemporal\nresampling for production. Pages 23–41 Proceedings of the conference on\nhigh-performance graphics.\n\n\nXue, J., and B. Su. 2017. Significant remote sensing\nvegetation indices: A review of developments and applications.\nJournal of sensors 2017:1–17.\n\n\nYan, X., and X. Su. 2009. Linear\nregression analysis: Theory and computing. world scientific.\n\n\nYang, P., C. van der Tol, T. Yin, and W. Verhoef. 2020. The SPART model: A\nsoil-plant-atmosphere radiative transfer model for satellite\nmeasurements in the solar spectrum. Remote Sensing of Environment\n247:111870.\n\n\nYang, X., X. Wu, H. Hao, and Z. He. 2008. Mechanisms and assessment\nof water eutrophication. Journal of zhejiang university Science B\n9:197–209.\n\n\nYokoya, N., and A. Iwasaki. 2013. Hyperspectral and multispectral data\nfusion mission on hyperspectral imager suite (HISUI). Pages 4086–4089\n2013 IEEE international geoscience and remote sensing symposium-IGARSS.\nIEEE.\n\n\nZha, H., Y. Miao, T. Wang, Y. Li, J. Zhang, W. Sun, Z. Feng, and K.\nKusnierek. 2020. Improving\nunmanned aerial vehicle remote sensing-based rice nitrogen nutrition\nindex prediction with machine learning. Remote Sensing 12:215.\n\n\nZhang, N., M. Wang, and N. Wang. 2002. Precision\nagriculture—a worldwide overview. Computers and electronics in\nagriculture 36:113–132.\n\n\nZhang, Q., X. Xiao, B. Braswell, E. Linder, F. Baret, and B. Moore III.\n2005. Estimating\nlight absorption by chlorophyll, leaf and canopy in a deciduous\nbroadleaf forest using MODIS data and a radiative transfer model.\nRemote Sensing of Environment 99:357–371.\n\n\nZhang, Z., Y. Jin, B. Chen, and P. Brown. 2019. California almond yield\nprediction at the orchard level with a machine learning approach.\nFrontiers in plant science 10:809.\n\n\nZheng, G., and M. Moskal. 2009. Retrieving leaf area index\n(LAI) using remote sensing: Theories, methods and sensors. Sensors\n9:2719–2745.\n\n\nZheng, H., T. Cheng, D. Li, X. Zhou, X. Yao, Y. Tian, W. Cao, and Y.\nZhu. 2018. Evaluation of\nRGB, color-infrared and multispectral images acquired from unmanned\naerial systems for the estimation of nitrogen accumulation in rice.\nRemote Sensing 10:824.\n\n\nZhu, X. X., D. Tuia, L. Mou, G.-S. Xia, L. Zhang, F. Xu, and F.\nFraundorfer. 2017. Deep learning in remote\nsensing: A comprehensive review and list of resources. IEEE\nGeoscience and Remote Sensing Magazine 5:8–36.\n\n\nZou, H., and T. Hastie. 2005. Regularization\nand variable selection via the elastic net. Journal of the royal\nstatistical society: series B (statistical methodology) 67:301–320."
  }
]